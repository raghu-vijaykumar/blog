<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PostgreSQL | Raghu Vijaykumar</title>
<meta name=keywords content="postgresql,database"><meta name=description content="Data Types in PostgreSQL Data type defines what values can be stored in a column in PostgreSQL. Features:
Data Types are not immutable. Can be changed or reassigned. Can be converted to other data types in query executions. Numeric Types Integer Types: Whole numbers, positive or negative, without decimals.
smallint: 2-byte integer. Example: CREATE TABLE example_smallint (value SMALLINT); INSERT INTO example_smallint (value) VALUES (123); integer: 4-byte integer. Example: CREATE TABLE example_integer (value INTEGER); INSERT INTO example_integer (value) VALUES (123456); bigint: 8-byte integer."><meta name=author content="Me"><link rel=canonical href=https://raghu-vijaykumar.github.io/blog/docs/postgresql/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.822fdf31f1a1d84e83043e3faecf43e6dbfa4ac397aa562252d0d5418304799a.css integrity="sha256-gi/fMfGh2E6DBD4/rs9D5tv6SsOXqlYiUtDVQYMEeZo=" rel="preload stylesheet" as=style><link rel=icon href=https://raghu-vijaykumar.github.io/blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://raghu-vijaykumar.github.io/blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://raghu-vijaykumar.github.io/blog/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://raghu-vijaykumar.github.io/blog/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://raghu-vijaykumar.github.io/blog/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://raghu-vijaykumar.github.io/blog/docs/postgresql/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PostgreSQL"><meta property="og:description" content="Data Types in PostgreSQL Data type defines what values can be stored in a column in PostgreSQL. Features:
Data Types are not immutable. Can be changed or reassigned. Can be converted to other data types in query executions. Numeric Types Integer Types: Whole numbers, positive or negative, without decimals.
smallint: 2-byte integer. Example: CREATE TABLE example_smallint (value SMALLINT); INSERT INTO example_smallint (value) VALUES (123); integer: 4-byte integer. Example: CREATE TABLE example_integer (value INTEGER); INSERT INTO example_integer (value) VALUES (123456); bigint: 8-byte integer."><meta property="og:type" content="article"><meta property="og:url" content="https://raghu-vijaykumar.github.io/blog/docs/postgresql/"><meta property="og:image" content="https://raghu-vijaykumar.github.io/blog/postgresql_logo.png"><meta property="article:section" content="docs"><meta property="og:site_name" content="Raghu Vijaykumar"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://raghu-vijaykumar.github.io/blog/postgresql_logo.png"><meta name=twitter:title content="PostgreSQL"><meta name=twitter:description content="Data Types in PostgreSQL Data type defines what values can be stored in a column in PostgreSQL. Features:
Data Types are not immutable. Can be changed or reassigned. Can be converted to other data types in query executions. Numeric Types Integer Types: Whole numbers, positive or negative, without decimals.
smallint: 2-byte integer. Example: CREATE TABLE example_smallint (value SMALLINT); INSERT INTO example_smallint (value) VALUES (123); integer: 4-byte integer. Example: CREATE TABLE example_integer (value INTEGER); INSERT INTO example_integer (value) VALUES (123456); bigint: 8-byte integer."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Docs","item":"https://raghu-vijaykumar.github.io/blog/docs/"},{"@type":"ListItem","position":2,"name":"PostgreSQL","item":"https://raghu-vijaykumar.github.io/blog/docs/postgresql/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PostgreSQL","name":"PostgreSQL","description":"Data Types in PostgreSQL Data type defines what values can be stored in a column in PostgreSQL. Features:\nData Types are not immutable. Can be changed or reassigned. Can be converted to other data types in query executions. Numeric Types Integer Types: Whole numbers, positive or negative, without decimals.\nsmallint: 2-byte integer. Example: CREATE TABLE example_smallint (value SMALLINT); INSERT INTO example_smallint (value) VALUES (123); integer: 4-byte integer. Example: CREATE TABLE example_integer (value INTEGER); INSERT INTO example_integer (value) VALUES (123456); bigint: 8-byte integer.","keywords":["postgresql","database"],"articleBody":" Data Types in PostgreSQL Data type defines what values can be stored in a column in PostgreSQL. Features:\nData Types are not immutable. Can be changed or reassigned. Can be converted to other data types in query executions. Numeric Types Integer Types: Whole numbers, positive or negative, without decimals.\nsmallint: 2-byte integer. Example: CREATE TABLE example_smallint (value SMALLINT); INSERT INTO example_smallint (value) VALUES (123); integer: 4-byte integer. Example: CREATE TABLE example_integer (value INTEGER); INSERT INTO example_integer (value) VALUES (123456); bigint: 8-byte integer. Example: CREATE TABLE example_bigint (value BIGINT); INSERT INTO example_bigint (value) VALUES (123456789012); Floating-Point Types: Numbers with fractional parts.\nreal: 4-byte floating-point number. Example: CREATE TABLE example_real (value REAL); INSERT INTO example_real (value) VALUES (123.45); double precision: 8-byte floating-point number. Example: CREATE TABLE example_double (value DOUBLE PRECISION); INSERT INTO example_double (value) VALUES (123456.789); Fixed-Point Types: Numbers with a specific number of digits after the decimal point.\nnumeric: Variable precision, exact. Example: CREATE TABLE example_numeric (value NUMERIC(10, 2)); INSERT INTO example_numeric (value) VALUES (123456.78); decimal: Equivalent to numeric. Example: CREATE TABLE example_decimal (value DECIMAL(10, 2)); INSERT INTO example_decimal (value) VALUES (123456.78); Serial Types: Auto-incrementing integers.\nserial: 4-byte integer. Example: CREATE TABLE example_serial (id SERIAL); bigserial: 8-byte integer. Example: CREATE TABLE example_bigserial (id BIGSERIAL); Date/Time Types Date/Time Types: For handling dates and times. date: Calendar date (year, month, day). Example: CREATE TABLE example_date (value DATE); INSERT INTO example_date (value) VALUES ('2024-06-14'); time [ (p) ] [ without time zone ]: Time of day (hour, minute, second, optional fractional seconds). Example: CREATE TABLE example_time (value TIME); INSERT INTO example_time (value) VALUES ('14:30:00'); time [ (p) ] with time zone: Time of day with time zone. Example: CREATE TABLE example_time_tz (value TIME WITH TIME ZONE); INSERT INTO example_time_tz (value) VALUES ('14:30:00+02'); timestamp [ (p) ] [ without time zone ]: Date and time (without time zone). Example: CREATE TABLE example_timestamp (value TIMESTAMP); INSERT INTO example_timestamp (value) VALUES ('2024-06-14 14:30:00'); timestamp [ (p) ] with time zone: Date and time with time zone. Example: CREATE TABLE example_timestamp_tz (value TIMESTAMP WITH TIME ZONE); INSERT INTO example_timestamp_tz (value) VALUES ('2024-06-14 14:30:00+02'); interval: Time span (duration). Example: CREATE TABLE example_interval (value INTERVAL); INSERT INTO example_interval (value) VALUES ('1 year 2 months 3 days'); Geometric Types Geometric Types: For representing geometric figures. point: A point in a 2D plane. Example: CREATE TABLE example_point (value POINT); INSERT INTO example_point (value) VALUES ('(2, 3)'); line: Infinite line. Example: CREATE TABLE example_line (value LINE); INSERT INTO example_line (value) VALUES ('{1, -1, 0}'); lseg: Line segment. Example: CREATE TABLE example_lseg (value LSEG); INSERT INTO example_lseg (value) VALUES ('[(2, 3), (4, 5)]'); box: Rectangular box. Example: CREATE TABLE example_box (value BOX); INSERT INTO example_box (value) VALUES ('((2, 3), (4, 5))'); path: Geometric path. Example: CREATE TABLE example_path (value PATH); INSERT INTO example_path (value) VALUES ('[(2, 3), (4, 5), (7, 8)]'); polygon: Closed geometric path (polygon). Example: CREATE TABLE example_polygon (value POLYGON); INSERT INTO example_polygon (value) VALUES ('((2, 3), (4, 5), (7, 8))'); circle: Circle. Example: CREATE TABLE example_circle (value CIRCLE); INSERT INTO example_circle (value) VALUES ('\u003c(2, 3), 5\u003e'); Network Address Types Network Address Types: For storing network addresses. cidr: IPv4 or IPv6 networks. Example: CREATE TABLE example_cidr (value CIDR); INSERT INTO example_cidr (value) VALUES ('192.168.100.128/25'); inet: IPv4 or IPv6 host address. Example: CREATE TABLE example_inet (value INET); INSERT INTO example_inet (value) VALUES ('192.168.100.128'); macaddr: MAC addresses. Example: CREATE TABLE example_macaddr (value MACADDR); INSERT INTO example_macaddr (value) VALUES ('08:00:2b:01:02:03'); macaddr8: EUI-64 MAC addresses. Example: CREATE TABLE example_macaddr8 (value MACADDR8); INSERT INTO example_macaddr8 (value) VALUES ('08:00:2b:01:02:03:04:05'); Character Types Character Types: For storing text. char(n): Fixed-length character string. Example: CREATE TABLE example_char (value CHAR(10)); INSERT INTO example_char (value) VALUES ('hello'); varchar(n): Variable-length character string. Example: CREATE TABLE example_varchar (value VARCHAR(10)); INSERT INTO example_varchar (value) VALUES ('hello'); text: Variable-length character string with unlimited length. Example: CREATE TABLE example_text (value TEXT); INSERT INTO example_text (value) VALUES ('This is a long text field.'); Binary Data Types Binary Data Types: For storing binary data. bytea: Variable-length binary string. Example: CREATE TABLE example_bytea (value BYTEA); INSERT INTO example_bytea (value) VALUES (E'\\\\xDEADBEEF'); Boolean Type Boolean Type: For storing boolean values. boolean: Logical Boolean (true/false). Example: CREATE TABLE example_boolean (value BOOLEAN); INSERT INTO example_boolean (value) VALUES (TRUE); INSERT INTO example_boolean (value) VALUES (FALSE); Enumerated Types Enumerated Types: For defining a custom data type with a set of predefined values. Example: CREATE TYPE mood AS ENUM ('sad', 'ok', 'happy'); CREATE TABLE example_enum (value mood); INSERT INTO example_enum (value) VALUES ('sad'); INSERT INTO example_enum (value) VALUES ('ok'); INSERT INTO example_enum (value) VALUES ('happy'); Composite Types Composite Types: For defining a structured data type that can hold multiple fields. Example: CREATE TYPE complex AS (r DOUBLE PRECISION, i DOUBLE PRECISION); CREATE TABLE example_composite (value complex); INSERT INTO example_composite (value) VALUES (ROW(1.0, 0.0)); Range Types Range Types: For representing a range of values. int4range: Range of integer. Example: CREATE TABLE example_int4range (value INT4RANGE); INSERT INTO example_int4range (value) VALUES ('[1,10)'); numrange: Range of numeric. Example: CREATE TABLE example_numrange (value NUMRANGE); INSERT INTO example_numrange (value) VALUES ('[1.5, 2.5)'); tsrange: Range of timestamp without time zone. Example: CREATE TABLE example_tsrange (value TSRANGE); INSERT INTO example_tsrange (value) VALUES ('[\"2024-06-14 14:30:00\", \"2024-06-14 15:30:00\")'); tstzrange: Range of timestamp with time zone. Example: CREATE TABLE example_tstzrange (value TSTZRANGE); INSERT INTO example_tstzrange (value) VALUES ('[\"2024-06-14 14:30:00+02\", \"2024-06-14 15:30:00+02\")'); daterange: Range of date. Example: CREATE TABLE example_daterange (value DATERANGE); INSERT INTO example_daterange (value) VALUES ('[\"2024-06-14\", \"2024-06-21\")'); UUID Type UUID Type: For storing universally unique identifiers. Example: CREATE TABLE example_uuid (value UUID); INSERT INTO example_uuid (value) VALUES ('a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11'); XML Type XML Type: For storing XML data. Example: CREATE TABLE example_xml (value XML); INSERT INTO example_xml (value) VALUES ('bar'); JSON Types JSON Types: For storing JSON data. json: Textual JSON data. Example: CREATE TABLE example_json (value JSON); INSERT INTO example_json (value) VALUES ('{\"name\": \"John\", \"age\": 30}'); jsonb: Binary JSON data (more efficient for certain operations). Example: CREATE TABLE example_jsonb (value JSONB); INSERT INTO example_jsonb (value) VALUES ('{\"name\": \"John\", \"age\": 30}'); Arrays Array Types: For storing arrays of values. integer[]: Array of integers. Example: CREATE TABLE example_int_array (value INTEGER[]); INSERT INTO example_int_array (value) VALUES ('{1, 2, 3}'); text[]: Array of text. Example: CREATE TABLE example_text_array (value TEXT[]); INSERT INTO example_text_array (value) VALUES ('{hello, world}'); Hstore Hstore Type: For storing sets of key/value pairs. Example: CREATE EXTENSION hstore; CREATE TABLE example_hstore (value HSTORE); INSERT INTO example_hstore (value) VALUES ('key1 =\u003e value1, key2 =\u003e value2'); Database CREATE DATABASE airlines WITH OWNER = postgres ENCODING = 'UTF8' LC_COLLATE = 'English_India.1252' LC_CTYPE = 'English_India.1252' TABLESPACE = pg_default CONNECTION LIMIT = -1; COMMENT ON DATABASE postgres IS 'default administrative connection database'; Tables Show tables definition -- list all relations \\dSEL List of relations Schema | Name | Type | Owner --------+-------------+-------+---------- public | performance | table | postgres public | person | table | postgres (2 rows) -- Table definition \\d person Table \"public.person\" Column | Type | Collation | Nullable | Default ------------+------------------------+-----------+----------+--------- person_id | bigint | | not null | last_name | character varying(255) | | not null | first_name | character varying(255) | | | age | integer | | not null | Indexes: \"person_pkey\" PRIMARY KEY, btree (person_id) -- Extended table definition \\d+ person Table \"public.person\" Column | Type | Collation | Nullable | Default | Storage | Stats target | Description ------------+------------------------+-----------+----------+---------+----------+--------------+------------- person_id | bigint | | not null | | plain | | last_name | character varying(255) | | not null | | extended | | first_name | character varying(255) | | | | extended | | age | integer | | not null | | plain | | Indexes: \"person_pkey\" PRIMARY KEY, btree (person_id) Access method: heap Create table -- create a person table CREATE [UNLOGGED] TABLE person ( person_id BIGINT NOT NULL [PRIMARY KEY], last_name VARCHAR(255)NOT NULL, first_name VARCHAR(255), age INT NOT NULL, PRIMARY KEY(person_id) ); -- An unlogged table skips writing a write ahead log, its not crash safe and cannot be replicated. -- Primary key can also be column property or table property in create statement. -- Create table from select statement CREATE TABLE PEOPLE_OVER_30 AS SELECT * FROM PERSON WHERE AGE \u003e 30; -- Create table referencing other table. -- Agencies table id is referenced by users table. CREATE TABLE AGENCIES ( ID SERIAL PRIMARY KEY, NAME TEXT NOT NULL ); CREATE TABLE USERS ( ID SERIAL PRIMARY KEY, AGENCY_ID INTEGER NOT NULL REFERENCES AGENCIES(ID) DEFERRABLE INITIALLY DEFERRED ); Drop Table Drop Table\nDROP TABLE removes tables from the database. Can drop multiple tables at once. CASCADE keyword is used to drop objects that depend on the table. RESTRICT keyword prevents the table from being dropped if any objects depend on it. -- Drop a single table DROP TABLE person; -- Drop multiple tables DROP TABLE person, people_over_30; -- Drop table with cascade DROP TABLE agencies CASCADE; -- Drop table with restrict DROP TABLE users RESTRICT; Alter Table ALTER TABLE modifies the structure of an existing table.\nCan add, drop, or rename columns and constraints. Can change the data type of a column. -- Add a new column ALTER TABLE person ADD COLUMN email VARCHAR(255); -- Drop a column ALTER TABLE person DROP COLUMN age; -- Rename a column ALTER TABLE person RENAME COLUMN last_name TO surname; -- Add a new constraint ALTER TABLE users ADD CONSTRAINT fk_agency FOREIGN KEY (agency_id) REFERENCES agencies(id); -- Drop a constraint ALTER TABLE users DROP CONSTRAINT fk_agency; -- Change the data type of a column ALTER TABLE person ALTER COLUMN person_id TYPE INT; Querying Data Playground the data in the dir airline is a data dump that can be resorted using the following command.\n\u003e pg_restore.exe --host \"localhost\" --port \"5432\" --username \"postgres\" --no-password --dbname \"airlines\" --format=d --verbose \"C:\\\\Users\\\\raghu\\\\Desktop\\\\COMBIN~1\\\\airlines\\\\\" pg_restore: connecting to database for restore pg_restore: creating TABLE \"public.codes_cancellation\" pg_restore: creating TABLE \"public.codes_carrier\" pg_restore: creating TABLE \"public.perform_feb\" pg_restore: creating TABLE \"public.performance\" pg_restore: processing data for table \"public.codes_cancellation\" pg_restore: processing data for table \"public.codes_carrier\" pg_restore: processing data for table \"public.perform_feb\" pg_restore: processing data for table \"public.performance\" Aliasing -- Aliasing select columns SELECT mkt_carrier AS carrier, mkt_carrier_fl_num AS flight_number, origin FROM performance; carrier | flight_number | origin ---------+---------------+-------- UA | 2429 | EWR UA | 2427 | LAS UA | 2426 | SNA ..... many more rows Limiting -- limiting number of entries SELECT * FROM performance LIMIT 1; fl_date | mkt_carrier | mkt_carrier_fl_num | origin | origin_city_name | origin_state_abr | dest | dest_city_name | dest_state_abr | dep_delay_new | arr_delay_new | cancelled | cancellation_code | diverted | carrier_delay | weather_delay | nas_delay | security_delay | late_aircraft_delay ------------+-------------+--------------------+--------+------------------+------------------+------+----------------+----------------+---------------+---------------+-----------+-------------------+----------+---------------+---------------+-----------+----------------+--------------------- 2018-01-01 | UA | 2429 | EWR | Newark, NJ | NJ | DEN | Denver, CO | CO | 0 | 0 | 0 | | 0 | | | | | (1 row) Distinct -- selecting distinct values of a column SELECT DISTINCT mkt_carrier FROM performance; mkt_carrier ------------- AS NK VX AA F9 B6 G4 HA DL UA WN (11 rows) -- selecting distinct across multiple columns SELECT DISTINCT mkt_carrier, origin as depart_city FROM performance; mkt_carrier | depart_city -------------+------------- UA | PIA NK | OAK AA | RDU UA | ABQ DL | CLE ..... 1176 rows Filtering :exclamation: Note: AND has higher operator precedence than OR. use appropriate parenthesis to reduce confusion. :exclamation:\n-- select all fields with a where condition SELECT * FROM performance WHERE origin = 'EWR'; fl_date | mkt_carrier | mkt_carrier_fl_num | origin | origin_city_name | origin_state_abr | dest | dest_city_name | dest_state_abr | dep_delay_new | arr_delay_new | cancelled | cancellation_code | diverted | carrier_delay | weather_delay | nas_delay | security_delay | late_aircraft_delay ------------+-------------+--------------------+--------+------------------+------------------+------+--------------------------------+----------------+---------------+---------------+-----------+-------------------+----------+---------------+---------------+-----------+----------------+--------------------- 2018-01-01 | UA | 2429 | EWR | Newark, NJ | NJ | DEN | Denver, CO | CO | 0 | 0 | 0 || 0 | | | | | 2018-01-01 | UA | 2415 | EWR | Newark, NJ | NJ | PDX | Portland, OR | OR | 0 | 0 | 0 || 0 | | | | | .... many more rows --select with complex where condition SELECT fl_date, mkt_carrier AS airline, mkt_carrier_fl_num AS flight, origin, dest FROM performance WHERE origin = 'ORD' AND dest = 'BZN'; fl_date | airline | flight | origin | dest ------------+---------+--------+--------+------ 2018-01-01 | UA | 1990 | ORD | BZN 2018-01-01 | UA | 926 | ORD | BZN 2018-01-02 | UA | 1990 | ORD | BZN ... many more rows -- for not equal condition use \u003c\u003e or != and try out OR operator --select where value is in between a range - Lower and upper boundaries are inclusive SELECT fl_date, mkt_carrier, mkt_carrier_fl_num, dep_delay_new, origin, dest FROM performance WHERE dep_delay_new BETWEEN 60 AND 120; fl_date | mkt_carrier | mkt_carrier_fl_num | dep_delay_new | origin | dest ------------+-------------+--------------------+---------------+--------+------ 2018-01-01 | UA | 2413 | 76 | ORD | BTV 2018-01-01 | UA | 2411 | 72 | EWR | SMF 2018-01-01 | UA | 2155 | 94 | IND | ORD ... many more rows -- select in only specific values list SELECT fl_date, mkt_carrier, mkt_carrier_fl_num, dep_delay_new, origin, dest FROM performance WHERE dep_delay_new BETWEEN 60 AND 120 AND origin IN ('MKE', 'AZO'); fl_date | mkt_carrier | mkt_carrier_fl_num | dep_delay_new | origin | dest ------------+-------------+--------------------+---------------+--------+------ 2018-01-01 | UA | 3824 | 107 | MKE | ORD 2018-01-01 | UA | 3817 | 62 | AZO | ORD 2018-01-01 | UA | 3790 | 97 | AZO | ORD ... many more rows --- try out NOT BETWEEN and NOT IN operators Pattern Matching -- select fields that a match a pattern with like -- Matching single character SELECT DISTINCT origin_city_name FROM performance WHERE origin_city_name LIKE '____, KS'; origin_city_name ------------------ Hays, KS (1 row) -- Matching one or more characters SELECT DISTINCT origin_city_name FROM performance WHERE origin_city_name LIKE 'Fort%'; origin_city_name --------------------- Fort Smith, AR Fort Myers, FL Fort Lauderdale, FL Fort Wayne, IN (4 rows) --- These wildcard _ and % can be used anywhere in match string --- Pattern matching with both _ and % SELECT DISTINCT origin_city_name FROM performance WHERE origin_city_name LIKE '__________________, %'; origin_city_name ------------------------ Bloomington/Normal, IL Hattiesburg/Laurel, MS Sarasota/Bradenton, FL (3 rows) --- To not match a pattern using NOT LIKE SELECT DISTINCT origin_city_name FROM performance WHERE origin_city_name NOT LIKE '%Fort%'; origin_city_name ------------------------------------ Colorado Springs, CO Roanoke, VA Christiansted, VI .... many more rows Null Values -- select fields that do not null values SELECT fl_date, mkt_carrier AS airline, mkt_carrier_fl_num AS flight, cancellation_code FROM performance WHERE cancellation_code IS NOT NULL; fl_date | airline | flight | cancellation_code ------------+---------+--------+------------------- 2018-01-01 | UA | 2034 | B 2018-01-01 | UA | 864 | A 2018-01-01 | UA | 488 | B ... many more rows Performing Joins Inner Join -- select all entries from performance table that has an entry in codes carrier table on mkt_carrier and carrier_code. SELECT p.fl_date, p.mkt_carrier,cc.carrier_desc, p.mkt_carrier_fl_num as flight, p.origin, p.dest FROM performance p INNER JOIN codes_carrier cc ON p.mkt_carrier = cc.carrier_code; fl_date | mkt_carrier | carrier_desc | flight | origin | dest ------------+-------------+--------------------+--------+--------+------ 2018-01-01 | UA | United Air Lines | 2429 | EWR | DEN 2018-01-01 | UA | United Air Lines | 2427 | LAS | SFO 2018-01-01 | UA | United Air Lines | 2426 | SNA | DEN 2018-01-01 | UA | United Air Lines | 2425 | RSW | ORD ... many more rows Outer Join Left Join -- fetching only details of the flight that was cancelled SELECT P.FL_DATE, P.MKT_CARRIER, CA.CANCEL_DESC, P.MKT_CARRIER_FL_NUM AS FLIGHT, P.ORIGIN, P.DEST FROM CODES_CANCELLATION CA LEFT JOIN PERFORMANCE P ON P.CANCELLATION_CODE = CA.CANCELLATION_CODE; fl_date | mkt_carrier | cancel_desc | flight | origin | dest ------------+-------------+---------------------+--------+--------+------ 2018-01-01 | UA | Weather | 2034 | IAH | MFE 2018-01-01 | UA | Carrier | 864 | LAS | SFO 2018-01-01 | UA | Weather | 488 | MFE | IAH Right Join :exclamation: Note: Use Left Join as a standard practice, until right join is absolutely necessary. :exclamation:\n--- select all records from table B and joins with table A. Full Join --- Selects all records from both the tables and performs join operation. SELECT P.FL_DATE, P.MKT_CARRIER, CA.CANCEL_DESC, P.MKT_CARRIER_FL_NUM AS FLIGHT, P.ORIGIN, P.DEST FROM CODES_CANCELLATION CA FULL JOIN PERFORMANCE P ON P.CANCELLATION_CODE = CA.CANCELLATION_CODE; fl_date | mkt_carrier | cancel_desc | flight | origin | dest ------------+-------------+---------------------+--------+--------+------ 2018-01-01 | UA | | 2429 | EWR | DEN 2018-01-01 | UA | | 2427 | LAS | SFO 2018-01-01 | UA | | 2426 | SNA | DEN 2018-01-01 | UA | | 2425 | RSW | ORD Ordering Aggregate Functions Count Sum Min Max -- select min and max deplay for an airport pair SELECT ORIGIN, DEST, MAX(ARR_DELAY_NEW), MIN(ARR_DELAY_NEW) FROM PERFORMANCE WHERE ARR_DELAY_NEW IS NOT NULL AND ARR_DELAY_NEW \u003e 0 GROUP BY ORIGIN, DEST ORDER BY DEST; origin | dest | max | min --------+------+------+------ ATL | ABE | 281 | 1 CLT | ABE | 181 | 1 DTW | ABE | 353 | 1 FLL | ABE | 89 | 1 ORD | ABE | 195 | 2 ... many more rows Average -- Calculating AVG delay for flights that have delay \u003e 0 ordering by most departure delay SELECT p.mkt_carrier, cc.carrier_desc as airline, AVG(p.dep_delay_new) AS avg_dep_delay, AVG(p.arr_delay_new) AS avg_arr_delay FROM performance p INNER JOIN codes_carrier cc ON cc.carrier_code = p.mkt_carrier WHERE dep_delay_new \u003e 0 AND arr_delay_new \u003e 0 GROUP BY p.mkt_carrier, cc.carrier_desc ORDER BY avg_dep_delay desc; mkt_carrier | airline | avg_dep_delay | avg_arr_delay -------------+--------------------+---------------------+--------------------- DL | Delta Air Lines | 70.5181465755953480 | 67.1188111500830718 UA | United Air Lines | 66.0501955939880585 | 64.4807082561251802 F9 | Frontier Airlines | 65.9053406998158379 | 61.6850828729281768 B6 | JetBlue Airways | 64.9873220906590121 | 63.2437507475182394 NK | Spirit Air Lines | 55.4537678207739308 | 53.5845213849287169 G4 | Allegiant Air | 52.6692737430167598 | 51.4497206703910615 AA | American Airlines | 49.5509546633142139 | 49.0363793509860926 AS | Alaska Airlines | 40.0871443089430894 | 39.2555894308943089 VX | Virgin America | 39.9071691176470588 | 40.2012867647058824 WN | Southwest Airlines | 32.7705248760471876 | 29.0510172679090443 HA | Hawaiian Airlines | 21.5402704291593180 | 23.5996472663139330 (11 rows) Filtering Aggregates - HAVING -- Calculating AVG delay for flights that have delay \u003e 0 and having more than 60 min avg delay and order by most departure delay SELECT P.MKT_CARRIER, CC.CARRIER_DESC AS AIRLINE, AVG(P.DEP_DELAY_NEW) AS AVG_DEP_DELAY, AVG(P.ARR_DELAY_NEW) AS AVG_ARR_DELAY FROM PERFORMANCE P INNER JOIN CODES_CARRIER CC ON CC.CARRIER_CODE = P.MKT_CARRIER WHERE DEP_DELAY_NEW \u003e 0 AND ARR_DELAY_NEW \u003e 0 GROUP BY P.MKT_CARRIER, CC.CARRIER_DESC HAVING AVG(P.DEP_DELAY_NEW) \u003e 60 OR AVG(P.ARR_DELAY_NEW) \u003e 60 ORDER BY AVG_DEP_DELAY DESC; mkt_carrier | airline | avg_dep_delay | avg_arr_delay -------------+-------------------+---------------------+--------------------- DL | Delta Air Lines | 70.5181465755953480 | 67.1188111500830718 UA | United Air Lines | 66.0501955939880585 | 64.4807082561251802 F9 | Frontier Airlines | 65.9053406998158379 | 61.6850828729281768 B6 | JetBlue Airways | 64.9873220906590121 | 63.2437507475182394 (4 rows) String Functions Concatenation -- Concatenate two string fields SELECT carrier_code || ', ' || carrier_desc AS carrier FROM codes_carrier; carrier ------------------------ AA, American Airlines AS, Alaska Airlines B6, JetBlue Airways DL, Delta Air Lines F9, Frontier Airlines G4, Allegiant Air HA, Hawaiian Airlines NK, Spirit Air Lines UA, United Air Lines VX, Virgin America WN, Southwest Airlines (11 rows) -- Alternative syntax SELECT CONCAT(carrier_code, ', ' , carrier_desc) AS carrier FROM codes_carrier; -- Concatenate multiple strings SELECT CONCAT_WS(', ' ,carrier_code, carrier_desc, 'USA') AS carrier FROM codes_carrier; carrier ----------------------------- AA, American Airlines, USA AS, Alaska Airlines, USA B6, JetBlue Airways, USA DL, Delta Air Lines, USA F9, Frontier Airlines, USA G4, Allegiant Air, USA HA, Hawaiian Airlines, USA NK, Spirit Air Lines, USA UA, United Air Lines, USA VX, Virgin America, USA WN, Southwest Airlines, USA (11 rows) Trim Functions -- trim leading and trailing spaces from a string SELECT TRIM(' radar '); btrim ------- radar (1 row) -- trim leading and trailing characters from a string SELECT TRIM('r' FROM 'radar'); btrim ------- ada (1 row) --trim leading characters from a string postgres=# SELECT TRIM(LEADING 'ra' FROM 'radar'); ltrim ------- dar (1 row) --trim trailing characters from a string SELECT TRIM(TRAILING 'dr' FROM 'radar'); rtrim ------- rada (1 row) -- Note d is not present in the string as trailing character only r is trimmed. String isolation -- select left n characters from a string SELECT LEFT('Pluralsight',6); left -------- Plural (1 row) -- select right n characters from a string SELECT RIGHT('Pluralsight',6); right -------- lsight (1 row) Sub String :exclamation: Note: Array index starts from 1 in PostgreSQL.:exclamation:\n-- split string by a delimiter and return the string n corresponding to the index SELECT SPLIT_PART('USA/DC/202','/',2); split_part ------------ DC (1 row) --- select substring using from index and length SELECT SUBSTRING('USA/DC/202',5,2); substring ----------- DC (1 row) -- Alternative syntax SELECT SUBSTRING('USA/DC/202' FROM 5 FOR 2); substring ----------- DC (1 row) -- select substring using from index to end of string SELECT SUBSTRING('USA/DC/202',5); substring ----------- DC/202 (1 row) Arithmetic Functions \u0026 Operators -- Addition / Subtraction SELECT 2 + 2; 4 -- Division (beaware of data types) SELECT 13 / 2; 6 -- Division with data type fix SELECT 13 / 2::float; 6.5 -- Modulo MOD(a,b) returns the remainder of the division of a by b SELECT 15 % 1; 0 -- Power - POWER(base,exponent) SELECT 12 ^ 2; 144 -- Square Root - SQRT(a) SELECT |/5; 2.23606797749979 -- Absolute value - ABS(a) SELECT @(36-45); 9 Set Fucntions SQL Set theory basics:\nResults of a query can be considered as a set. SQL sets have same number of columns and same data types. -- Union operation -- Return results of two queries. -- Union filters all duplicate records. SELECT column1, column2 FROM table1 UNION SELECT column1, column2 FROM table2; -- Union all returns all records, including duplicates. SELECT column1, column2 FROM table1 UNION ALL SELECT column1, column2 FROM table2; -- Intersect operation -- Return result from two queries that are present in both. -- Intersect filters all duplicate records. SELECT column1, column2 FROM table1 INTERSECT SELECT column1, column2 FROM table2; -- Intersect all returns all records, including duplicates. SELECT column1, column2 FROM table1 INTERSECT ALL SELECT column1, column2 FROM table2; -- Except operation -- Return result from two queries that appears only in left query. -- Except filters all duplicate records. SELECT column1, column2 FROM table1 EXCEPT SELECT column1, column2 FROM table2; -- Except all returns all records, including duplicates. SELECT column1, column2 FROM table1 EXCEPT ALL SELECT column1, column2 FROM table2; SubQuery A nested query where the result of one query can be use in other query.\nTypes:\nCorrelated Subquery Non-Correlated Subquery Features:\nAdvantageous to calculate aggregates on the fly. Membership questions can be used in subqueries. Non-Correlated Subquery -- select flights that were cancelled due to weather SELECT FL_DATE, MKT_CARRIER || ' ' || MKT_CARRIER_FL_NUM AS FLIGHT, ORIGIN, DEST FROM PERFORMANCE WHERE CANCELLED = 1 AND CANCELLATION_CODE IN (SELECT CANCELLATION_CODE FROM CODES_CANCELLATION WHERE CANCEL_DESC = 'Weather'); fl_date | flight | origin | dest ------------+---------+--------+------ 2018-01-01 | UA 2034 | IAH | MFE 2018-01-01 | UA 488 | MFE | IAH 2018-01-01 | UA 4748 | ORD | RAP 2018-01-01 | UA 4640 | DSM | ORD ... many more rows Correlated Subquery A subquery that uses values from the primary query i.e, its evaluated for each row of the primary query.\n-- select flights from ORD to RAP which had delay greater than average delay here subquery depends on A.ORIGIN. SELECT CONCAT_WS(' ',A.MKT_CARRIER,A.MKT_CARRIER_FL_NUM) AS FLIGHT, A.ORIGIN, A.DEST, A.DEP_DELAY_NEW FROM PERFORMANCE A WHERE A.ORIGIN = 'ORD' AND A.DEST = 'RAP' AND A.DEP_DELAY_NEW \u003e (SELECT AVG(DEP_DELAY_NEW) FROM PERFORMANCE WHERE DEP_DELAY_NEW \u003e 0 AND ORIGIN = A.ORIGIN); flight | origin | dest | dep_delay_new ---------+--------+------+--------------- UA 4748 | ORD | RAP | 144 UA 4748 | ORD | RAP | 124 AA 3652 | ORD | RAP | 67 (3 rows) -- Average delay for flights from ORD to RAP is SELECT AVG(DEP_DELAY_NEW) FROM PERFORMANCE WHERE DEP_DELAY_NEW \u003e 0 AND ORIGIN = 'ORD' 47.25 Common Table Expressions Create result sets that can be referenced in subsequest queries\nTypes:\nNon Recursive CTE Recursive CTE Features:\nEasier to read and interpret complex queries. Can be performance optimizations for correlated subqueries. Non Recursive CTE -- list all the flights based with delay greater than average delay grouped by origin. WITH AVG_DELAY_PER_ORIGIN AS (SELECT AVG(DEP_DELAY_NEW) AS DELAY, ORIGIN FROM PERFORMANCE WHERE DEP_DELAY_NEW \u003e 0 GROUP BY ORIGIN) SELECT CONCAT_WS(' ',A.MKT_CARRIER,A.MKT_CARRIER_FL_NUM) AS FLIGHT, A.ORIGIN, A.DEST, A.DEP_DELAY_NEW FROM PERFORMANCE A INNER JOIN AVG_DELAY_PER_ORIGIN B ON A.ORIGIN = B.ORIGIN WHERE A.DEP_DELAY_NEW \u003e B.DELAY; flight | origin | dest | dep_delay_new ---------+--------+------+--------------- UA 4279 | EWR | GSP | 96 UA 4303 | ORD | GRR | 101 UA 4305 | PVD | ORD | 112 ... many more rows Recursive CTE Note: In CTE we can optionally specify a column name which is seful in recursion.\n--- recursively evaluate sum of % with itself till 25 is reached WITH RECURSIVE SERIES(LIST_NUM) AS (SELECT 5 UNION ALL SELECT LIST_NUM + 5 FROM SERIES WHERE LIST_NUM + 5 \u003c= 25 ) SELECT LIST_NUM FROM SERIES; list_num ---------- 5 10 15 20 25 (5 rows) Pivot and Unpivot These are used to transform one table into another\nPivot - Rows into columns Unpivot - Columns into rows Suppose we have a table named sales:\nproduct quarter sales A Q1 100 A Q2 150 A Q3 200 A Q4 250 B Q1 300 B Q2 350 B Q3 400 B Q4 450 We want to pivot this table to have quarters as columns.\nSELECT product, SUM(CASE WHEN quarter = 'Q1' THEN sales ELSE 0 END) AS Q1, SUM(CASE WHEN quarter = 'Q2' THEN sales ELSE 0 END) AS Q2, SUM(CASE WHEN quarter = 'Q3' THEN sales ELSE 0 END) AS Q3, SUM(CASE WHEN quarter = 'Q4' THEN sales ELSE 0 END) AS Q4 FROM sales GROUP BY product; product Q1 Q2 Q3 Q4 A 100 150 200 250 B 300 350 400 450 To unpivot the quarterly_sales result back to original table\nSELECT product, quarter, sales FROM quarterly_sales UNPIVOT ( sales FOR quarter IN (Q1, Q2, Q3, Q4) ) AS unpivoted_sales; Window Functions A window is a set of table rows over which a function is applied.\nFeatures:\nAggregagte functions can also be applied over window functions. Order of Evaluation Evaluated after joins, groupings and having clause. Evaluated same time as select statements. To use others selections in a window functions include selection in a subquery or CTE. apply window function on the outer query. Cannot be used in WHERE or HAVINg clause. Row Number Assigns sequential number to each row, the window is defined by OVER() clause.\n--- list all distinct carriers with ROW_NUMBER assigned to each row WITH DISTINCT_CARRIER AS (SELECT DISTINCT (MKT_CARRIER) AS CARRIER FROM PERFORMANCE) SELECT ROW_NUMBER() OVER() AS SL, CARRIER FROM DISTINCT_CARRIER; sl | carrier ----+--------- 1 | AS 2 | NK 3 | VX 4 | AA 5 | B6 6 | F9 7 | G4 8 | HA 9 | DL 10 | UA 11 | WN (11 rows) -- list all distinct carriers with ROW_NUMBER assigned to each row with ordering WITH DISTINCT_CARRIER AS (SELECT DISTINCT (MKT_CARRIER) AS CARRIER FROM PERFORMANCE) SELECT ROW_NUMBER() OVER(ORDER BY CARRIER) AS SL, CARRIER FROM DISTINCT_CARRIER; sl | carrier ----+--------- 1 | AA 2 | AS 3 | B6 4 | DL 5 | F9 6 | G4 7 | HA 8 | NK 9 | UA 10 | VX 11 | WN (11 rows) Partition -- list count of flights from a origin to dest across all carriers SELECT DISTINCT ORIGIN, DEST, COUNT(*) OVER(PARTITION BY ORIGIN) FROM PERFORMANCE GROUP BY ORIGIN, DEST ORDER BY ORIGIN DESC, DEST; origin | dest | count --------+------+------- YUM | PHX | 1 YNG | PIE | 2 YNG | SFB | 2 YKM | SEA | 1 YAK | CDV | 2 YAK | JNU | 2 ... many more rows Ranking Ranking assigns sequential number to each row, however matching rows are matched the same.\nDense Rank is used to avoid gaps in ranking.\nSELECT mkt_carrier, mkt_carrier_fl_num, origin, dest, arr_delay_new, Row_number() OVER( ORDER BY mkt_carrier_fl_num), Rank() OVER( ORDER BY arr_delay_new DESC) AS DELAY_RANK, Dense_rank() OVER( ORDER BY arr_delay_new DESC) AS DELAY_DENSE_RANK FROM performance WHERE arr_delay_new IS NOT NULL AND arr_delay_new \u003e 0 AND mkt_carrier = 'AA' AND origin = 'MCI' AND fl_date = '2018-01-16' ORDER BY arr_delay_new ASC; mkt_carrier | mkt_carrier_fl_num | origin | dest | arr_delay_new | row_number | delay_rank | delay_dense_rank -------------+--------------------+--------+------+---------------+------------+------------+------------------ AA | 2640 | MCI | DFW | 1 | 3 | 10 | 8 AA | 5121 | MCI | CLT | 1 | 10 | 10 | 8 AA | 4586 | MCI | MIA | 8 | 7 | 8 | 7 AA | 1224 | MCI | DFW | 8 | 1 | 8 | 7 AA | 4604 | MCI | DCA | 9 | 8 | 7 | 6 AA | 248 | MCI | ORD | 12 | 2 | 5 | 5 AA | 2983 | MCI | ORD | 12 | 4 | 5 | 5 AA | 3456 | MCI | ORD | 16 | 6 | 4 | 4 AA | 4659 | MCI | DCA | 25 | 9 | 3 | 3 AA | 601 | MCI | PHX | 32 | 11 | 2 | 2 AA | 3135 | MCI | ORD | 90 | 5 | 1 | 1 (11 rows) Special values FIRST_VALUE() and LAST_VALUE() are used to get the first and last value of a column.\nSELECT DEST, LAST_VALUE(ARR_DELAY_NEW) OVER W, FIRST_VALUE (ARR_DELAY_NEW) OVER W FROM PERFORMANCE WHERE ARR_DELAY_NEW IS NOT NULL AND ARR_DELAY_NEW \u003e 0 WINDOW W AS (PARTITION BY DEST); --- Wierd result Lag and Lead Lagging rows are the rows that occur before the current row. Leading rows are the rows that occur after the current row.\nFeatures:\nThese are used in month to month or year over year analysis. -- get daily count group by day and lag by 5 day in another column and delta over five days. WITH DAILY_FLIGHT_COUNT AS (SELECT FL_DATE, COUNT(*) AS DAILY_COUNT FROM PERFORMANCE GROUP BY FL_DATE) SELECT FL_DATE, DAILY_COUNT, LAG(DAILY_COUNT, 5) OVER (ORDER BY FL_DATE) AS LAG_COUNT, DAILY_COUNT - LAG(DAILY_COUNT, 5) OVER (ORDER BY FL_DATE) AS DELTA_COUNT FROM DAILY_FLIGHT_COUNT ORDER BY FL_DATE; fl_date | daily_count | lag_count | delta_count ------------+-------------+-----------+------------- 2018-01-01 | 19515 | | 2018-01-02 | 21672 | | 2018-01-03 | 20940 | | 2018-01-04 | 20980 | | 2018-01-05 | 21026 | | 2018-01-06 | 17484 | 19515 | -2031 2018-01-07 | 20812 | 21672 | -860 2018-01-08 | 21021 | 20940 | 81 2018-01-09 | 19942 | 20980 | -1038 2018-01-10 | 20487 | 21026 | -539 2018-01-11 | 21151 | 17484 | 3667 2018-01-12 | 21319 | 20812 | 507 2018-01-13 | 16037 | 21021 | -4984 ... Rows till end of month Performance Explain and Analyse Select Query EXPLAIN ANALYSE SELECT * FROM PUBLIC.PERFORMANCE; \"Seq Scan on performance (cost=0.00..14614.61 rows=621461 width=84) (actual time=0.067..126.664 rows=621461 loops=1)\" \"Planning Time: 0.068 ms\" \"Execution Time: 224.380 ms\" 0.00 (Planning/Startup cost). 14614.61 Query plan cost. (Total cost) COST = (disk pages read _ sequential page cost) + (rows scanned _ cpu tuple cost) = (8400 * 1.0) + (621461 * 0.01) = 14614.61 SELECT RELPAGES AS \"Disk Page Read\", RELTUPLES AS \"Rows Scanned\" FROM PG_CLASS WHERE RELNAME = 'performance' 621461 rows is the number of rows returned by the query. (Number of rows returned) 84 Bytes is the size of the returned rows. (Total size of data/number of returned rows) Indexing Indexs are a way to speed up queries. But indexes also add overhead to the database system as a whole, so they should be used sensibly.\nSelect with Where clause EXPLAIN (ANALYSE, VERBOSE) SELECT * FROM PUBLIC.PERFORMANCE WHERE ORIGIN = 'EWR'; \"Gather (cost=1000.00..13890.08 rows=12533 width=84) (actual time=0.206..33.883 rows=12888 loops=1)\" \" Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay\" \" Workers Planned: 2\" \" Workers Launched: 2\" \" -\u003e Parallel Seq Scan on public.performance (cost=0.00..11636.78 rows=5222 width=84) (actual time=0.027..28.880 rows=4296 loops=3)\" \" Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay\" \" Filter: ((performance.origin)::text = 'EWR'::text)\" \" Rows Removed by Filter: 202858\" \" Worker 0: actual time=0.017..29.242 rows=4372 loops=1\" \" Worker 1: actual time=0.021..29.648 rows=4217 loops=1\" \"Planning Time: 0.044 ms\" \"Execution Time: 36.007 ms\" Creating index on origin column is a good idea.\nCREATE INDEX origin_idx ON PERFORMANCE (origin); EXPLAIN (ANALYSE, VERBOSE) SELECT * FROM PUBLIC.PERFORMANCE WHERE ORIGIN = 'EWR'; \"Bitmap Heap Scan on public.performance (cost=141.56..9103.93 rows=12533 width=84) (actual time=0.676..17.586 rows=12888 loops=1)\" \" Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay\" \" Recheck Cond: ((performance.origin)::text = 'EWR'::text)\" \" Heap Blocks: exact=2747\" \" -\u003e Bitmap Index Scan on origin_idx (cost=0.00..138.42 rows=12533 width=0) (actual time=0.453..0.453 rows=12888 loops=1)\" \" Index Cond: ((performance.origin)::text = 'EWR'::text)\" \"Planning Time: 0.161 ms\" \"Execution Time: 19.913 ms\" EXPLAIN (ANALYSE, VERBOSE) SELECT * FROM PUBLIC.PERFORMANCE WHERE ORIGIN = 'EWR' AND DEST = 'PDX'; \"Bitmap Heap Scan on public.performance (cost=138.46..9132.16 rows=132 width=84) (actual time=1.256..5.416 rows=89 loops=1)\" \" Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay\" \" Recheck Cond: ((performance.origin)::text = 'EWR'::text)\" \" Filter: ((performance.dest)::text = 'PDX'::text)\" \" Rows Removed by Filter: 12799\" \" Heap Blocks: exact=2747\" \" -\u003e Bitmap Index Scan on origin_idx (cost=0.00..138.42 rows=12533 width=0) (actual time=0.864..0.865 rows=12888 loops=1)\" \" Index Cond: ((performance.origin)::text = 'EWR'::text)\" \"Planning Time: 0.108 ms\" \"Execution Time: 5.450 ms\" -- What happens if order of columns is changed? EXPLAIN (ANALYSE, VERBOSE) SELECT * FROM PUBLIC.PERFORMANCE WHERE DEST = 'PDX' AND ORIGIN = 'EWR'; Creating index on dest column is a good idea.\nCREATE INDEX dest_idx ON PERFORMANCE (dest); EXPLAIN (ANALYSE, VERBOSE) SELECT * FROM PUBLIC.PERFORMANCE WHERE ORIGIN = 'EWR' AND DEST = 'PDX'; \"Bitmap Heap Scan on public.performance (cost=212.10..689.00 rows=132 width=84) (actual time=0.845..0.948 rows=89 loops=1)\" \" Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay\" \" Recheck Cond: (((performance.dest)::text = 'PDX'::text) AND ((performance.origin)::text = 'EWR'::text))\" \" Heap Blocks: exact=89\" \" -\u003e BitmapAnd (cost=212.10..212.10 rows=132 width=0) (actual time=0.833..0.834 rows=0 loops=1)\" \" -\u003e Bitmap Index Scan on dest_idx (cost=0.00..73.36 rows=6525 width=0) (actual time=0.353..0.353 rows=6613 loops=1)\" \" Index Cond: ((performance.dest)::text = 'PDX'::text)\" \" -\u003e Bitmap Index Scan on origin_idx (cost=0.00..138.42 rows=12533 width=0) (actual time=0.391..0.392 rows=12888 loops=1)\" \" Index Cond: ((performance.origin)::text = 'EWR'::text)\" \"Planning Time: 0.211 ms\" \"Execution Time: 0.976 ms\" Index types B-tree: Balanced tree index useful for equality and range queries. Hash: Useful for equality, But index need to be built manually on crashes. Generalized inverted Index (GIN): Useful for Array or full text search. Genneralized search index (GIST): Useful for Geometric data and full text search. Index Optimization EXPLAIN (ANALYSE, VERBOSE) SELECT * FROM PUBLIC.PERFORMANCE WHERE ORIGIN = 'EWR' AND DEP_DELAY_NEW \u003e 0; \"Gather (cost=1000.00..13682.63 rows=3985 width=84) (actual time=0.160..42.342 rows=4453 loops=1)\" \" Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay\" \" Workers Planned: 2\" \" Workers Launched: 2\" \" -\u003e Parallel Seq Scan on public.performance (cost=0.00..12284.13 rows=1660 width=84) (actual time=0.089..37.477 rows=1484 loops=3)\" \" Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay\" \" Filter: ((performance.dep_delay_new \u003e '0'::numeric) AND ((performance.origin)::text = 'EWR'::text))\" \" Rows Removed by Filter: 205669\" \" Worker 0: actual time=0.048..37.040 rows=1307 loops=1\" \" Worker 1: actual time=0.213..37.313 rows=1610 loops=1\" \"Planning Time: 0.097 ms\" \"Execution Time: 43.200 ms\" CREATE INDEX origin_idx ON PERFORMANCE (origin); EXPLAIN (ANALYSE, VERBOSE) SELECT * FROM PUBLIC.PERFORMANCE WHERE ORIGIN = 'EWR' AND DEP_DELAY_NEW \u003e 0; \"Bitmap Heap Scan on public.performance (cost=139.42..9133.13 rows=3985 width=84) (actual time=0.774..6.846 rows=4453 loops=1)\" \" Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay\" \" Recheck Cond: ((performance.origin)::text = 'EWR'::text)\" \" Filter: (performance.dep_delay_new \u003e '0'::numeric)\" \" Rows Removed by Filter: 8435\" \" Heap Blocks: exact=2747\" \" -\u003e Bitmap Index Scan on origin_idx (cost=0.00..138.42 rows=12533 width=0) (actual time=0.550..0.551 rows=12888 loops=1)\" \" Index Cond: ((performance.origin)::text = 'EWR'::text)\" \"Planning Time: 0.160 ms\" \"Execution Time: 7.614 ms\" -- Multicolumn index -- Creating a new index on both columns CREATE INDEX origin_dep_delay_new_idx ON PERFORMANCE (origin, dep_delay_new); EXPLAIN (ANALYSE, VERBOSE) SELECT * FROM PUBLIC.PERFORMANCE WHERE ORIGIN = 'EWR' AND DEP_DELAY_NEW \u003e 0; \"Bitmap Heap Scan on public.performance (cost=93.27..7053.38 rows=3985 width=84) (actual time=0.671..2.903 rows=4453 loops=1)\" \" Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay\" \" Recheck Cond: (((performance.origin)::text = 'EWR'::text) AND (performance.dep_delay_new \u003e '0'::numeric))\" \" Heap Blocks: exact=1634\" \" -\u003e Bitmap Index Scan on origin_dep_delay_new_idx (cost=0.00..92.27 rows=3985 width=0) (actual time=0.484..0.485 rows=4453 loops=1)\" \" Index Cond: (((performance.origin)::text = 'EWR'::text) AND (performance.dep_delay_new \u003e '0'::numeric))\" \"Planning Time: 0.170 ms\" \"Execution Time: 3.582 ms\" DROP INDEX origin_dep_delay_new_idx; -- Index order -- Changing the order of index - Performance is slower CREATE INDEX dep_delay_new_origin_idx ON PERFORMANCE (origin, dep_delay_new); EXPLAIN (ANALYSE, VERBOSE) SELECT * FROM PUBLIC.PERFORMANCE WHERE ORIGIN = 'EWR' AND DEP_DELAY_NEW \u003e 0; \"Bitmap Heap Scan on public.performance (cost=139.42..9133.13 rows=3984 width=84) (actual time=0.646..5.768 rows=4453 loops=1)\" \" Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay\" \" Recheck Cond: ((performance.origin)::text = 'EWR'::text)\" \" Filter: (performance.dep_delay_new \u003e '0'::numeric)\" \" Rows Removed by Filter: 8435\" \" Heap Blocks: exact=2747\" \" -\u003e Bitmap Index Scan on origin_idx (cost=0.00..138.42 rows=12533 width=0) (actual time=0.415..0.416 rows=12888 loops=1)\" \" Index Cond: ((performance.origin)::text = 'EWR'::text)\" \"Planning Time: 0.252 ms\" \"Execution Time: 6.501 ms\" -- Cover Index - Not useful in this case CREATE INDEX cover_idx ON PERFORMANCE (fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay); -- Useful when we have less number of columns in tables and it can minimize heap blocks scanned. Unique Index and Primary Key Primary key and unique columns already have indexes, even though its not visible in pg_admin UI.\nDROP TABLE public.sample; CREATE TABLE public.sample ( id integer NOT NULL, firstcol character varying(40) COLLATE pg_catalog.\"default\", secondcol integer, CONSTRAINT sample_pkey PRIMARY KEY (id) ) TABLESPACE pg_default; ALTER TABLE public.sample OWNER to postgres; -- To check if there is already an index SELECT * FROM PG_INDEX JOIN PG_CLASS AS C ON C.OID = PG_INDEX.INDEXRELID WHERE PG_INDEX.INDRELID = 'sample'::REGCLASS; -- verify creating multiple indexes on same column CREATE INDEX id_idx on sample(id) -- verify creating unique constraint ALTER TABLE SAMPLE ADD CONSTRAINT FIRSTCOL_UNQ_CONSTRAINT UNIQUE (FIRSTCOL) -- verify creating unique index on CREATE UNIQUE INDEX FIRSTCOL_UNQ_IDX on sample(firstcol) Case Insensitivity SELECT * FROM PUBLIC.PERFORMANCE WHERE origin_city_name = 'newark, NJ'; --- Making the query case insensitive EXPLAIN (ANALYSE, VERBOSE) SELECT * FROM PUBLIC.PERFORMANCE WHERE lower(origin_city_name) = lower('newark, Nj'); \"Gather (cost=1000.00..13594.83 rows=3107 width=85) (actual time=0.205..75.207 rows=12888 loops=1)\" \" Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay\" \" Workers Planned: 2\" \" Workers Launched: 2\" \" -\u003e Parallel Seq Scan on public.performance (cost=0.00..12284.13 rows=1295 width=85) (actual time=0.096..70.928 rows=4296 loops=3)\" \" Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay\" \" Filter: (lower((performance.origin_city_name)::text) = 'newark, nj'::text)\" \" Rows Removed by Filter: 202858\" \" Worker 0: actual time=0.163..71.812 rows=4500 loops=1\" \" Worker 1: actual time=0.084..71.995 rows=4401 loops=1\" \"Planning Time: 0.080 ms\" \"Execution Time: 77.392 ms\" CREATE INDEX ORIGIN_CITY_NAME_INDEX ON PERFORMANCE (ORIGIN_CITY_NAME) -- verify index is not used for query CREATE INDEX ORIGIN_CITY_NAME_CASE_INSENSITIVE_INDEX ON PERFORMANCE (LOWER(ORIGIN_CITY_NAME)) EXPLAIN (ANALYSE, VERBOSE) SELECT * FROM PUBLIC.PERFORMANCE WHERE lower(origin_city_name) = lower('newark, Nj'); \"Bitmap Heap Scan on public.performance (cost=36.50..6177.88 rows=3107 width=85) (actual time=0.619..15.666 rows=12888 loops=1)\" \" Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay\" \" Recheck Cond: (lower((performance.origin_city_name)::text) = 'newark, nj'::text)\" \" Heap Blocks: exact=2747\" \" -\u003e Bitmap Index Scan on origin_city_name_case_insensitive_index (cost=0.00..35.73 rows=3107 width=0) (actual time=0.408..0.409 rows=12888 loops=1)\" \" Index Cond: (lower((performance.origin_city_name)::text) = 'newark, nj'::text)\" \"Planning Time: 0.159 ms\" \"Execution Time: 18.005 ms\" Partial Index --- Creating partial index (based on usecase) CREATE INDEX DEP_DEL_NEW_IDX ON PERFORMANCE (DEP_DELAY_NEW) WHERE DEP_DELAY_NEW \u003e 10; Index Maintenance Reinitialize Indexes In case of heavy OLTP workload, lots of deletes, Reindex periodically.\nREINDEX INDEX origin_idx; REINDEX TABLE PERFORMANCE; -- with pg_cron SELECT cron.schedule('30 3 * * 6', $$REINDEX INDEX origin_idx$$); Populating Large Data Disable Auto Commit Wrap the query in transaction block BEGIN; -- Insert statements COMMIT; Bulk Insert with COPY Drop indexs before bulk insert --- Copying to a file Copy (Select \\* From performance) To 'performance.csv' With CSV DELIMITER ',' HEADER; --- Loading from a file COPY performance From 'performance.csv' With CSV DELIMITER ',' HEADER; Perform ANALYZE PERFORMANCE after bulk insert. This will create statistics on the table, helps postgres optimizer engine to optimize query plans. ANALYZE VERBOSE PERFORMANCE; INFO: analyzing \"public.performance\" INFO: \"performance\": scanned 8400 of 8400 pages, containing 621461 live rows and 0 dead rows; 30000 rows in sample, 621461 estimated total rows ANALYZE Analyse tables once a week. Vacuuming Tables and Database VACCUUM VERBOSE PERFORMANCE; INFO: vacuuming \"public.performance\" INFO: launched 2 parallel vacuum workers for index cleanup (planned: 2) INFO: \"performance\": found 0 removable, 7 nonremovable row versions in 1 out of 8400 pages DETAIL: 0 dead row versions cannot be removed yet, oldest xmin: 514 There were 0 unused item identifiers. Skipped 0 pages due to buffer pins, 0 frozen pages. 0 pages are entirely empty. CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.01 s. INFO: vacuuming \"pg_toast.pg_toast_16396\" INFO: \"pg_toast_16396\": found 0 removable, 0 nonremovable row versions in 0 out of 0 pages DETAIL: 0 dead row versions cannot be removed yet, oldest xmin: 514 There were 0 unused item identifiers. Skipped 0 pages due to buffer pins, 0 frozen pages. 0 pages are entirely empty. CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s. VACUUM DELETE FROM PERFORMANCE WHERE DEP_DELAY_NEW \u003e 10; VACCUUM VERBOSE PERFORMANCE; INFO: vacuuming \"public.performance\" INFO: launched 2 parallel vacuum workers for index vacuuming (planned: 2) INFO: scanned index \"dep_del_new_idx\" to remove 472701 row versions DETAIL: CPU: user: 0.01 s, system: 0.00 s, elapsed: 0.01 s INFO: scanned index \"origin_city_name_case_insensitive_index\" to remove 472701 row versions DETAIL: CPU: user: 0.05 s, system: 0.00 s, elapsed: 0.08 s INFO: scanned index \"origin_city_name_index\" to remove 472701 row versions DETAIL: CPU: user: 0.04 s, system: 0.01 s, elapsed: 0.08 s INFO: \"performance\": removed 472701 row versions in 8399 pages DETAIL: CPU: user: 0.01 s, system: 0.00 s, elapsed: 0.01 s INFO: index \"origin_city_name_index\" now contains 148760 row versions in 546 pages DETAIL: 472701 index row versions were removed. 0 index pages have been deleted, 0 are currently reusable. CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s. INFO: index \"origin_city_name_case_insensitive_index\" now contains 148760 row versions in 546 pages DETAIL: 472701 index row versions were removed. 0 index pages have been deleted, 0 are currently reusable. CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s. INFO: index \"dep_del_new_idx\" now contains 124759 row versions in 345 pages DETAIL: 0 index row versions were removed. 0 index pages have been deleted, 0 are currently reusable. CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s. INFO: \"performance\": found 472701 removable, 148760 nonremovable row versions in 8400 out of 8400 pages DETAIL: 0 dead row versions cannot be removed yet, oldest xmin: 515 There were 0 unused item identifiers. Skipped 0 pages due to buffer pins, 0 frozen pages. 0 pages are entirely empty. CPU: user: 0.09 s, system: 0.02 s, elapsed: 0.14 s. INFO: vacuuming \"pg_toast.pg_toast_16396\" INFO: \"pg_toast_16396\": found 0 removable, 0 nonremovable row versions in 0 out of 0 pages DETAIL: 0 dead row versions cannot be removed yet, oldest xmin: 515 There were 0 unused item identifiers. Skipped 0 pages due to buffer pins, 0 frozen pages. 0 pages are entirely empty. CPU: user: 0.00 s, system: 0.00 s, elapsed: 0.00 s. VACUUM Vacuum tables once a week. VACUUM VERBOSE; -- Vacuum all tables ","wordCount":"7260","inLanguage":"en","image":"https://raghu-vijaykumar.github.io/blog/postgresql_logo.png","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://raghu-vijaykumar.github.io/blog/docs/postgresql/"},"publisher":{"@type":"Organization","name":"Raghu Vijaykumar","logo":{"@type":"ImageObject","url":"https://raghu-vijaykumar.github.io/blog/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://raghu-vijaykumar.github.io/blog/ accesskey=h title="Raghu Vijaykumar (Alt + H)"><img src=https://raghu-vijaykumar.github.io/apple-touch-icon.png alt aria-label=logo height=35>Raghu Vijaykumar</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://raghu-vijaykumar.github.io/blog/about/ title=about><span>about</span></a></li><li><a href=https://raghu-vijaykumar.github.io/blog/docs/ title=docs><span>docs</span></a></li><li><a href=https://raghu-vijaykumar.github.io/blog/posts/ title=posts><span>posts</span></a></li><li><a href=https://raghu-vijaykumar.github.io/blog/tags/ title=tags><span>tags</span></a></li><li><a href=https://github.com/raghu-vijaykumar title=Github><span>Github</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://raghu-vijaykumar.github.io/blog/>Home</a>&nbsp;»&nbsp;<a href=https://raghu-vijaykumar.github.io/blog/docs/>Docs</a></div><h1 class="post-title entry-hint-parent">PostgreSQL</h1><div class=post-meta>35 min&nbsp;·&nbsp;7260 words&nbsp;·&nbsp;Me</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#data-types-in-postgresql>Data Types in PostgreSQL</a><ul><li><a href=#numeric-types>Numeric Types</a></li><li><a href=#datetime-types>Date/Time Types</a></li><li><a href=#geometric-types>Geometric Types</a></li><li><a href=#network-address-types>Network Address Types</a></li><li><a href=#character-types>Character Types</a></li><li><a href=#binary-data-types>Binary Data Types</a></li><li><a href=#boolean-type>Boolean Type</a></li><li><a href=#enumerated-types>Enumerated Types</a></li><li><a href=#composite-types>Composite Types</a></li><li><a href=#range-types>Range Types</a></li><li><a href=#uuid-type>UUID Type</a></li><li><a href=#xml-type>XML Type</a></li><li><a href=#json-types>JSON Types</a></li><li><a href=#arrays>Arrays</a></li><li><a href=#hstore>Hstore</a></li></ul></li><li><a href=#databasehttpswwwpostgresqlorgdocs13sql-createdatabasehtml><a href=https://www.postgresql.org/docs/13/sql-createdatabase.html>Database</a></a></li><li><a href=#tables>Tables</a><ul><li><a href=#show-tables-definition>Show tables definition</a></li><li><a href=#create-tablehttpswwwpostgresqlorgdocs13sql-createtablehtml><a href=https://www.postgresql.org/docs/13/sql-createtable.html>Create table</a></a></li></ul></li><li><a href=#querying-data>Querying Data</a><ul><li><a href=#playground>Playground</a></li><li><a href=#aliasing>Aliasing</a></li><li><a href=#limiting>Limiting</a></li><li><a href=#distinct>Distinct</a></li><li><a href=#filtering>Filtering</a></li><li><a href=#pattern-matching>Pattern Matching</a></li><li><a href=#null-values>Null Values</a></li><li><a href=#performing-joins>Performing Joins</a></li><li><a href=#ordering>Ordering</a></li><li><a href=#aggregate-functions>Aggregate Functions</a></li></ul></li><li><a href=#string-functions>String Functions</a><ul><li><a href=#concatenation>Concatenation</a></li><li><a href=#trim-functions>Trim Functions</a></li><li><a href=#string-isolation>String isolation</a></li><li><a href=#sub-string>Sub String</a></li></ul></li><li><a href=#arithmetic-functions--operators>Arithmetic Functions & Operators</a></li><li><a href=#set-fucntions>Set Fucntions</a></li><li><a href=#subquery>SubQuery</a><ul><li><a href=#non-correlated-subquery>Non-Correlated Subquery</a></li><li><a href=#correlated-subquery>Correlated Subquery</a></li></ul></li><li><a href=#common-table-expressions>Common Table Expressions</a><ul><li><a href=#non-recursive-cte>Non Recursive CTE</a></li><li><a href=#recursive-cte>Recursive CTE</a></li></ul></li><li><a href=#pivot-and-unpivot>Pivot and Unpivot</a></li><li><a href=#window-functions>Window Functions</a><ul><li><a href=#row-number>Row Number</a></li><li><a href=#partition>Partition</a></li><li><a href=#ranking>Ranking</a></li><li><a href=#special-values>Special values</a></li><li><a href=#lag-and-lead>Lag and Lead</a></li></ul></li><li><a href=#performance>Performance</a><ul><li><a href=#explain-and-analyse>Explain and Analyse</a></li><li><a href=#indexing>Indexing</a></li><li><a href=#populating-large-data>Populating Large Data</a></li><li><a href=#vacuuming-tables-and-database>Vacuuming Tables and Database</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p><img loading=lazy src=postgresql_logo.png alt=Logo></p><h2 id=data-types-in-postgresql>Data Types in PostgreSQL<a hidden class=anchor aria-hidden=true href=#data-types-in-postgresql>#</a></h2><p><strong>Data type</strong> defines what values can be stored in a column in PostgreSQL. Features:</p><ul><li><strong>Data Types</strong> are not immutable.</li><li>Can be changed or reassigned.</li><li>Can be converted to other data types in query executions.</li></ul><h3 id=numeric-types>Numeric Types<a hidden class=anchor aria-hidden=true href=#numeric-types>#</a></h3><ul><li><p><strong>Integer Types</strong>: Whole numbers, positive or negative, without decimals.</p><ul><li><code>smallint</code>: 2-byte integer.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_smallint</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=nb>SMALLINT</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_smallint</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>123</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>integer</code>: 4-byte integer.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_integer</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=nb>INTEGER</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_integer</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>123456</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>bigint</code>: 8-byte integer.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_bigint</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=nb>BIGINT</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_bigint</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>123456789012</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li><li><p><strong>Floating-Point Types</strong>: Numbers with fractional parts.</p><ul><li><code>real</code>: 4-byte floating-point number.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_real</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=nb>REAL</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_real</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>123</span><span class=p>.</span><span class=mi>45</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>double precision</code>: 8-byte floating-point number.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_double</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>DOUBLE</span><span class=w> </span><span class=k>PRECISION</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_double</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>123456</span><span class=p>.</span><span class=mi>789</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li><li><p><strong>Fixed-Point Types</strong>: Numbers with a specific number of digits after the decimal point.</p><ul><li><code>numeric</code>: Variable precision, exact.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_numeric</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=nb>NUMERIC</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_numeric</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>123456</span><span class=p>.</span><span class=mi>78</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>decimal</code>: Equivalent to <code>numeric</code>.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_decimal</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=nb>DECIMAL</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_decimal</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=mi>123456</span><span class=p>.</span><span class=mi>78</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li><li><p><strong>Serial Types</strong>: Auto-incrementing integers.</p><ul><li><code>serial</code>: 4-byte integer.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_serial</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=w> </span><span class=nb>SERIAL</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>bigserial</code>: 8-byte integer.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_bigserial</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=w> </span><span class=n>BIGSERIAL</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h3 id=datetime-types>Date/Time Types<a hidden class=anchor aria-hidden=true href=#datetime-types>#</a></h3><ul><li><strong>Date/Time Types</strong>: For handling dates and times.<ul><li><code>date</code>: Calendar date (year, month, day).<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_date</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=nb>DATE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_date</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;2024-06-14&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>time [ (p) ] [ without time zone ]</code>: Time of day (hour, minute, second, optional fractional seconds).<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_time</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>TIME</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_time</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;14:30:00&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>time [ (p) ] with time zone</code>: Time of day with time zone.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_time_tz</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>TIME</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=n>TIME</span><span class=w> </span><span class=k>ZONE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_time_tz</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;14:30:00+02&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>timestamp [ (p) ] [ without time zone ]</code>: Date and time (without time zone).<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_timestamp</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_timestamp</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;2024-06-14 14:30:00&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>timestamp [ (p) ] with time zone</code>: Date and time with time zone.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_timestamp_tz</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=w> </span><span class=k>WITH</span><span class=w> </span><span class=n>TIME</span><span class=w> </span><span class=k>ZONE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_timestamp_tz</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;2024-06-14 14:30:00+02&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>interval</code>: Time span (duration).<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_interval</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=nb>INTERVAL</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_interval</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;1 year 2 months 3 days&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h3 id=geometric-types>Geometric Types<a hidden class=anchor aria-hidden=true href=#geometric-types>#</a></h3><ul><li><strong>Geometric Types</strong>: For representing geometric figures.<ul><li><code>point</code>: A point in a 2D plane.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_point</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>POINT</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_point</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;(2, 3)&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>line</code>: Infinite line.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_line</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>LINE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_line</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;{1, -1, 0}&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>lseg</code>: Line segment.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_lseg</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>LSEG</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_lseg</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;[(2, 3), (4, 5)]&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>box</code>: Rectangular box.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_box</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>BOX</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_box</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;((2, 3), (4, 5))&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>path</code>: Geometric path.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_path</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>PATH</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_path</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;[(2, 3), (4, 5), (7, 8)]&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>polygon</code>: Closed geometric path (polygon).<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_polygon</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>POLYGON</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_polygon</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;((2, 3), (4, 5), (7, 8))&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>circle</code>: Circle.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_circle</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>CIRCLE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_circle</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;&lt;(2, 3), 5&gt;&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h3 id=network-address-types>Network Address Types<a hidden class=anchor aria-hidden=true href=#network-address-types>#</a></h3><ul><li><strong>Network Address Types</strong>: For storing network addresses.<ul><li><code>cidr</code>: IPv4 or IPv6 networks.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_cidr</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>CIDR</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_cidr</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;192.168.100.128/25&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>inet</code>: IPv4 or IPv6 host address.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_inet</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>INET</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_inet</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;192.168.100.128&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>macaddr</code>: MAC addresses.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_macaddr</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>MACADDR</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_macaddr</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;08:00:2b:01:02:03&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>macaddr8</code>: EUI-64 MAC addresses.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_macaddr8</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>MACADDR8</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_macaddr8</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;08:00:2b:01:02:03:04:05&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h3 id=character-types>Character Types<a hidden class=anchor aria-hidden=true href=#character-types>#</a></h3><ul><li><strong>Character Types</strong>: For storing text.<ul><li><code>char(n)</code>: Fixed-length character string.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_char</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=nb>CHAR</span><span class=p>(</span><span class=mi>10</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_char</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;hello&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>varchar(n)</code>: Variable-length character string.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_varchar</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>10</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_varchar</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;hello&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>text</code>: Variable-length character string with unlimited length.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_text</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=nb>TEXT</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_text</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;This is a long text field.&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h3 id=binary-data-types>Binary Data Types<a hidden class=anchor aria-hidden=true href=#binary-data-types>#</a></h3><ul><li><strong>Binary Data Types</strong>: For storing binary data.<ul><li><code>bytea</code>: Variable-length binary string.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_bytea</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>BYTEA</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_bytea</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=n>E</span><span class=s1>&#39;\\xDEADBEEF&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h3 id=boolean-type>Boolean Type<a hidden class=anchor aria-hidden=true href=#boolean-type>#</a></h3><ul><li><strong>Boolean Type</strong>: For storing boolean values.<ul><li><code>boolean</code>: Logical Boolean (true/false).<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_boolean</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=nb>BOOLEAN</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_boolean</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=k>TRUE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_boolean</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=k>FALSE</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h3 id=enumerated-types>Enumerated Types<a hidden class=anchor aria-hidden=true href=#enumerated-types>#</a></h3><ul><li><strong>Enumerated Types</strong>: For defining a custom data type with a set of predefined values.<ul><li>Example:<div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TYPE</span><span class=w> </span><span class=n>mood</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>ENUM</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;sad&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;ok&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;happy&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_enum</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>mood</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_enum</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;sad&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_enum</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;ok&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_enum</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;happy&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h3 id=composite-types>Composite Types<a hidden class=anchor aria-hidden=true href=#composite-types>#</a></h3><ul><li><strong>Composite Types</strong>: For defining a structured data type that can hold multiple fields.<ul><li>Example:<div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TYPE</span><span class=w> </span><span class=n>complex</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>r</span><span class=w> </span><span class=n>DOUBLE</span><span class=w> </span><span class=k>PRECISION</span><span class=p>,</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=n>DOUBLE</span><span class=w> </span><span class=k>PRECISION</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_composite</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>complex</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_composite</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=k>ROW</span><span class=p>(</span><span class=mi>1</span><span class=p>.</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>0</span><span class=p>));</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h3 id=range-types>Range Types<a hidden class=anchor aria-hidden=true href=#range-types>#</a></h3><ul><li><strong>Range Types</strong>: For representing a range of values.<ul><li><code>int4range</code>: Range of <code>integer</code>.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_int4range</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>INT4RANGE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_int4range</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;[1,10)&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>numrange</code>: Range of <code>numeric</code>.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_numrange</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>NUMRANGE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_numrange</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;[1.5, 2.5)&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>tsrange</code>: Range of <code>timestamp without time zone</code>.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_tsrange</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>TSRANGE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_tsrange</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;[&#34;2024-06-14 14:30:00&#34;, &#34;2024-06-14 15:30:00&#34;)&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>tstzrange</code>: Range of <code>timestamp with time zone</code>.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_tstzrange</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>TSTZRANGE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_tstzrange</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;[&#34;2024-06-14 14:30:00+02&#34;, &#34;2024-06-14 15:30:00+02&#34;)&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>daterange</code>: Range of <code>date</code>.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_daterange</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>DATERANGE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_daterange</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;[&#34;2024-06-14&#34;, &#34;2024-06-21&#34;)&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h3 id=uuid-type>UUID Type<a hidden class=anchor aria-hidden=true href=#uuid-type>#</a></h3><ul><li><strong>UUID Type</strong>: For storing universally unique identifiers.<ul><li>Example:<div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_uuid</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>UUID</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_uuid</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;a0eebc99-9c0b-4ef8-bb6d-6bb9bd380a11&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h3 id=xml-type>XML Type<a hidden class=anchor aria-hidden=true href=#xml-type>#</a></h3><ul><li><strong>XML Type</strong>: For storing XML data.<ul><li>Example:<div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_xml</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>XML</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_xml</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;&lt;foo&gt;bar&lt;/foo&gt;&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h3 id=json-types>JSON Types<a hidden class=anchor aria-hidden=true href=#json-types>#</a></h3><ul><li><strong>JSON Types</strong>: For storing JSON data.<ul><li><code>json</code>: Textual JSON data.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_json</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>JSON</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_json</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;{&#34;name&#34;: &#34;John&#34;, &#34;age&#34;: 30}&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>jsonb</code>: Binary JSON data (more efficient for certain operations).<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_jsonb</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>JSONB</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_jsonb</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;{&#34;name&#34;: &#34;John&#34;, &#34;age&#34;: 30}&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h3 id=arrays>Arrays<a hidden class=anchor aria-hidden=true href=#arrays>#</a></h3><ul><li><strong>Array Types</strong>: For storing arrays of values.<ul><li><code>integer[]</code>: Array of integers.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_int_array</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=nb>INTEGER</span><span class=p>[]);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_int_array</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;{1, 2, 3}&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li><li><code>text[]</code>: Array of text.<ul><li>Example:</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_text_array</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=nb>TEXT</span><span class=p>[]);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_text_array</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;{hello, world}&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h3 id=hstore>Hstore<a hidden class=anchor aria-hidden=true href=#hstore>#</a></h3><ul><li><strong>Hstore Type</strong>: For storing sets of key/value pairs.<ul><li>Example:<div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=n>EXTENSION</span><span class=w> </span><span class=n>hstore</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>example_hstore</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=w> </span><span class=n>HSTORE</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INSERT</span><span class=w> </span><span class=k>INTO</span><span class=w> </span><span class=n>example_hstore</span><span class=w> </span><span class=p>(</span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=k>VALUES</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;key1 =&gt; value1, key2 =&gt; value2&#39;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div></li></ul></li></ul><h2 id=databasehttpswwwpostgresqlorgdocs13sql-createdatabasehtml><a href=https://www.postgresql.org/docs/13/sql-createdatabase.html>Database</a><a hidden class=anchor aria-hidden=true href=#databasehttpswwwpostgresqlorgdocs13sql-createdatabasehtml>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>airlines</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>WITH</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>OWNER</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>postgres</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>ENCODING</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;UTF8&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>LC_COLLATE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;English_India.1252&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>LC_CTYPE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;English_India.1252&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>TABLESPACE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pg_default</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>CONNECTION</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>-</span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>COMMENT</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>DATABASE</span><span class=w> </span><span class=n>postgres</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>IS</span><span class=w> </span><span class=s1>&#39;default administrative connection database&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h2 id=tables>Tables<a hidden class=anchor aria-hidden=true href=#tables>#</a></h2><h3 id=show-tables-definition>Show tables definition<a hidden class=anchor aria-hidden=true href=#show-tables-definition>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- list all relations
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err>\</span><span class=n>dSEL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>List</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=n>relations</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=k>Schema</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=n>Name</span><span class=w>     </span><span class=o>|</span><span class=w> </span><span class=k>Type</span><span class=w>  </span><span class=o>|</span><span class=w>  </span><span class=k>Owner</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--------+-------------+-------+----------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=k>public</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>performance</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>postgres</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=k>public</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>person</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>postgres</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>2</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Table definition
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err>\</span><span class=n>d</span><span class=w> </span><span class=n>person</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                        </span><span class=k>Table</span><span class=w> </span><span class=s2>&#34;public.person&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>Column</span><span class=w>   </span><span class=o>|</span><span class=w>          </span><span class=k>Type</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=k>Collation</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>Nullable</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>Default</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------+------------------------+-----------+----------+---------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>person_id</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=nb>bigint</span><span class=w>                 </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=k>null</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>last_name</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=nb>character</span><span class=w> </span><span class=nb>varying</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=k>null</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>first_name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=nb>character</span><span class=w> </span><span class=nb>varying</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w>          </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>age</span><span class=w>        </span><span class=o>|</span><span class=w> </span><span class=nb>integer</span><span class=w>                </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=k>null</span><span class=w> </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Indexes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s2>&#34;person_pkey&#34;</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w> </span><span class=n>btree</span><span class=w> </span><span class=p>(</span><span class=n>person_id</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Extended table definition
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err>\</span><span class=n>d</span><span class=o>+</span><span class=w> </span><span class=n>person</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                                            </span><span class=k>Table</span><span class=w> </span><span class=s2>&#34;public.person&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=k>Column</span><span class=w>   </span><span class=o>|</span><span class=w>          </span><span class=k>Type</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=k>Collation</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>Nullable</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>Default</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>Storage</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>Stats</span><span class=w> </span><span class=n>target</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>Description</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------+------------------------+-----------+----------+---------+----------+--------------+-------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>person_id</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=nb>bigint</span><span class=w>                 </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=k>null</span><span class=w> </span><span class=o>|</span><span class=w>         </span><span class=o>|</span><span class=w> </span><span class=n>plain</span><span class=w>    </span><span class=o>|</span><span class=w>              </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>last_name</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=nb>character</span><span class=w> </span><span class=nb>varying</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=k>null</span><span class=w> </span><span class=o>|</span><span class=w>         </span><span class=o>|</span><span class=w> </span><span class=n>extended</span><span class=w> </span><span class=o>|</span><span class=w>              </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>first_name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=nb>character</span><span class=w> </span><span class=nb>varying</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w>          </span><span class=o>|</span><span class=w>         </span><span class=o>|</span><span class=w> </span><span class=n>extended</span><span class=w> </span><span class=o>|</span><span class=w>              </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>age</span><span class=w>        </span><span class=o>|</span><span class=w> </span><span class=nb>integer</span><span class=w>                </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w> </span><span class=k>not</span><span class=w> </span><span class=k>null</span><span class=w> </span><span class=o>|</span><span class=w>         </span><span class=o>|</span><span class=w> </span><span class=n>plain</span><span class=w>    </span><span class=o>|</span><span class=w>              </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Indexes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=s2>&#34;person_pkey&#34;</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w> </span><span class=n>btree</span><span class=w> </span><span class=p>(</span><span class=n>person_id</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>Access</span><span class=w> </span><span class=k>method</span><span class=p>:</span><span class=w> </span><span class=n>heap</span><span class=w>
</span></span></span></code></pre></div><h3 id=create-tablehttpswwwpostgresqlorgdocs13sql-createtablehtml><a href=https://www.postgresql.org/docs/13/sql-createtable.html>Create table</a><a hidden class=anchor aria-hidden=true href=#create-tablehttpswwwpostgresqlorgdocs13sql-createtablehtml>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- create a person table
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=p>[</span><span class=n>UNLOGGED</span><span class=p>]</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>person</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>person_id</span><span class=w> </span><span class=nb>BIGINT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=p>[</span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>],</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>last_name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>first_name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>255</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>age</span><span class=w> </span><span class=nb>INT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>(</span><span class=n>person_id</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- An unlogged table skips writing a write ahead log, its not crash safe and cannot be replicated.
</span></span></span><span class=line><span class=cl><span class=c1>-- Primary key can also be column property or table property in create statement.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Create table from select statement
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>PEOPLE_OVER_30</span><span class=w> </span><span class=k>AS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>PERSON</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>AGE</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>30</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Create table referencing other table.
</span></span></span><span class=line><span class=cl><span class=c1>-- Agencies table id is referenced by users table.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>AGENCIES</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  	</span><span class=n>ID</span><span class=w> </span><span class=nb>SERIAL</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>NAME</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>USERS</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>ID</span><span class=w> </span><span class=nb>SERIAL</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>AGENCY_ID</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>AGENCIES</span><span class=p>(</span><span class=n>ID</span><span class=p>)</span><span class=w> </span><span class=k>DEFERRABLE</span><span class=w> </span><span class=k>INITIALLY</span><span class=w> </span><span class=k>DEFERRED</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><h4 id=drop-table>Drop Table<a hidden class=anchor aria-hidden=true href=#drop-table>#</a></h4><p>Drop Table</p><ul><li>DROP TABLE removes tables from the database.</li><li>Can drop multiple tables at once.</li><li>CASCADE keyword is used to drop objects that depend on the table.</li><li>RESTRICT keyword prevents the table from being dropped if any objects depend on it.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- Drop a single table
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>DROP</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>person</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Drop multiple tables
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>DROP</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>person</span><span class=p>,</span><span class=w> </span><span class=n>people_over_30</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Drop table with cascade
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>DROP</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>agencies</span><span class=w> </span><span class=k>CASCADE</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Drop table with restrict
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>DROP</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=k>RESTRICT</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h4 id=alter-table>Alter Table<a hidden class=anchor aria-hidden=true href=#alter-table>#</a></h4><p>ALTER TABLE modifies the structure of an existing table.</p><ul><li>Can add, drop, or rename columns and constraints.</li><li>Can change the data type of a column.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- Add a new column
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>person</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ADD</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>email</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>255</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Drop a column
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>person</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>DROP</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>age</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Rename a column
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>person</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>RENAME</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>last_name</span><span class=w> </span><span class=k>TO</span><span class=w> </span><span class=n>surname</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Add a new constraint
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>users</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ADD</span><span class=w> </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=n>fk_agency</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FOREIGN</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=n>agency_id</span><span class=p>)</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>agencies</span><span class=p>(</span><span class=n>id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Drop a constraint
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>users</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>DROP</span><span class=w> </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=n>fk_agency</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Change the data type of a column
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>person</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ALTER</span><span class=w> </span><span class=k>COLUMN</span><span class=w> </span><span class=n>person_id</span><span class=w> </span><span class=k>TYPE</span><span class=w> </span><span class=nb>INT</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h2 id=querying-data>Querying Data<a hidden class=anchor aria-hidden=true href=#querying-data>#</a></h2><h3 id=playground>Playground<a hidden class=anchor aria-hidden=true href=#playground>#</a></h3><p>the data in the dir airline is a data dump that can be resorted using the following command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>&gt; pg_restore.exe --host <span class=s2>&#34;localhost&#34;</span> --port <span class=s2>&#34;5432&#34;</span> --username <span class=s2>&#34;postgres&#34;</span> --no-password --dbname <span class=s2>&#34;airlines&#34;</span> --format<span class=o>=</span>d --verbose <span class=s2>&#34;C:\\Users\\raghu\\Desktop\\COMBIN~1\\airlines\\&#34;</span>
</span></span><span class=line><span class=cl>pg_restore: connecting to database <span class=k>for</span> restore
</span></span><span class=line><span class=cl>pg_restore: creating TABLE <span class=s2>&#34;public.codes_cancellation&#34;</span>
</span></span><span class=line><span class=cl>pg_restore: creating TABLE <span class=s2>&#34;public.codes_carrier&#34;</span>
</span></span><span class=line><span class=cl>pg_restore: creating TABLE <span class=s2>&#34;public.perform_feb&#34;</span>
</span></span><span class=line><span class=cl>pg_restore: creating TABLE <span class=s2>&#34;public.performance&#34;</span>
</span></span><span class=line><span class=cl>pg_restore: processing data <span class=k>for</span> table <span class=s2>&#34;public.codes_cancellation&#34;</span>
</span></span><span class=line><span class=cl>pg_restore: processing data <span class=k>for</span> table <span class=s2>&#34;public.codes_carrier&#34;</span>
</span></span><span class=line><span class=cl>pg_restore: processing data <span class=k>for</span> table <span class=s2>&#34;public.perform_feb&#34;</span>
</span></span><span class=line><span class=cl>pg_restore: processing data <span class=k>for</span> table <span class=s2>&#34;public.performance&#34;</span>
</span></span></code></pre></div><h3 id=aliasing>Aliasing<a hidden class=anchor aria-hidden=true href=#aliasing>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- Aliasing select columns
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>carrier</span><span class=p>,</span><span class=w> </span><span class=n>mkt_carrier_fl_num</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>flight_number</span><span class=p>,</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>performance</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>carrier</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>flight_number</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>origin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>---------+---------------+--------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>UA</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>2429</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>EWR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>UA</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>2427</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>LAS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>UA</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>2426</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>SNA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>.....</span><span class=w> </span><span class=n>many</span><span class=w> </span><span class=k>more</span><span class=w> </span><span class=k>rows</span><span class=w>
</span></span></span></code></pre></div><h3 id=limiting>Limiting<a hidden class=anchor aria-hidden=true href=#limiting>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- limiting number of entries
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>performance</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>fl_date</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>mkt_carrier_fl_num</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>origin_city_name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>origin_state_abr</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest_city_name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest_state_abr</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dep_delay_new</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>arr_delay_new</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>cancelled</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>cancellation_code</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>diverted</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>carrier_delay</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>weather_delay</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>nas_delay</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>security_delay</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>late_aircraft_delay</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------+-------------+--------------------+--------+------------------+------------------+------+----------------+----------------+---------------+---------------+-----------+-------------------+----------+---------------+---------------+-----------+----------------+---------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>2429</span><span class=w>               </span><span class=o>|</span><span class=w> </span><span class=n>EWR</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>Newark</span><span class=p>,</span><span class=w> </span><span class=n>NJ</span><span class=w>       </span><span class=o>|</span><span class=w> </span><span class=n>NJ</span><span class=w>               </span><span class=o>|</span><span class=w> </span><span class=n>DEN</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>Denver</span><span class=p>,</span><span class=w> </span><span class=n>CO</span><span class=w>     </span><span class=o>|</span><span class=w> </span><span class=n>CO</span><span class=w>             </span><span class=o>|</span><span class=w>             </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w>             </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w>         </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w>                   </span><span class=o>|</span><span class=w>        </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w>               </span><span class=o>|</span><span class=w>               </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w>                </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><h3 id=distinct>Distinct<a hidden class=anchor aria-hidden=true href=#distinct>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- selecting distinct values of a column
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>performance</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>mkt_carrier</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=k>AS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>NK</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>VX</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>AA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>F9</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>B6</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>G4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>HA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>DL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>UA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>WN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>11</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- selecting distinct across multiple columns
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>mkt_carrier</span><span class=p>,</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>depart_city</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>performance</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>depart_city</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-------------+-------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>PIA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>NK</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>OAK</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>AA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>RDU</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>ABQ</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>DL</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>CLE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>.....</span><span class=w> </span><span class=mi>1176</span><span class=w> </span><span class=k>rows</span><span class=w>
</span></span></span></code></pre></div><h3 id=filtering>Filtering<a hidden class=anchor aria-hidden=true href=#filtering>#</a></h3><blockquote><p>:exclamation: Note: AND has higher operator precedence than OR. use appropriate parenthesis to reduce confusion. :exclamation:</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=w> </span><span class=c1>-- select all fields with a where condition
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>performance</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;EWR&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>fl_date</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>mkt_carrier_fl_num</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>origin_city_name</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>origin_state_abr</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest</span><span class=w> </span><span class=o>|</span><span class=w>         </span><span class=n>dest_city_name</span><span class=w>         </span><span class=o>|</span><span class=w> </span><span class=n>dest_state_abr</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dep_delay_new</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>arr_delay_new</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>cancelled</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>cancellation_code</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>diverted</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>carrier_delay</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>weather_delay</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>nas_delay</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>security_delay</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>late_aircraft_delay</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------+-------------+--------------------+--------+------------------+------------------+------+--------------------------------+----------------+---------------+---------------+-----------+-------------------+----------+---------------+---------------+-----------+----------------+---------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>2429</span><span class=w>               </span><span class=o>|</span><span class=w> </span><span class=n>EWR</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>Newark</span><span class=p>,</span><span class=w> </span><span class=n>NJ</span><span class=w>       </span><span class=o>|</span><span class=w> </span><span class=n>NJ</span><span class=w>               </span><span class=o>|</span><span class=w> </span><span class=n>DEN</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>Denver</span><span class=p>,</span><span class=w> </span><span class=n>CO</span><span class=w>                     </span><span class=o>|</span><span class=w> </span><span class=n>CO</span><span class=w>             </span><span class=o>|</span><span class=w>             </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w>             </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w>         </span><span class=mi>0</span><span class=w> </span><span class=o>||</span><span class=w>        </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w>               </span><span class=o>|</span><span class=w>               </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w>                </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>2415</span><span class=w>               </span><span class=o>|</span><span class=w> </span><span class=n>EWR</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>Newark</span><span class=p>,</span><span class=w> </span><span class=n>NJ</span><span class=w>       </span><span class=o>|</span><span class=w> </span><span class=n>NJ</span><span class=w>               </span><span class=o>|</span><span class=w> </span><span class=n>PDX</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>Portland</span><span class=p>,</span><span class=w> </span><span class=k>OR</span><span class=w>                   </span><span class=o>|</span><span class=w> </span><span class=k>OR</span><span class=w>             </span><span class=o>|</span><span class=w>             </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w>             </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w>         </span><span class=mi>0</span><span class=w> </span><span class=o>||</span><span class=w>        </span><span class=mi>0</span><span class=w> </span><span class=o>|</span><span class=w>               </span><span class=o>|</span><span class=w>               </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w>                </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>....</span><span class=w> </span><span class=n>many</span><span class=w> </span><span class=k>more</span><span class=w> </span><span class=k>rows</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=c1>--select with complex where condition
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=n>fl_date</span><span class=p>,</span><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>airline</span><span class=p>,</span><span class=w> </span><span class=n>mkt_carrier_fl_num</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>flight</span><span class=p>,</span><span class=w> </span><span class=n>origin</span><span class=p>,</span><span class=w> </span><span class=n>dest</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>performance</span><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ORD&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>dest</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;BZN&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>fl_date</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>airline</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>flight</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------+---------+--------+--------+------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>1990</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>BZN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>926</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>BZN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>02</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>1990</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>BZN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>...</span><span class=w> </span><span class=n>many</span><span class=w> </span><span class=k>more</span><span class=w> </span><span class=k>rows</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=c1>-- for not equal condition use &lt;&gt; or != and try out OR operator
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c1>--select where value is in between a range - Lower and upper boundaries are inclusive
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>fl_date</span><span class=p>,</span><span class=w> </span><span class=n>mkt_carrier</span><span class=p>,</span><span class=w> </span><span class=n>mkt_carrier_fl_num</span><span class=p>,</span><span class=w> </span><span class=n>dep_delay_new</span><span class=p>,</span><span class=w> </span><span class=n>origin</span><span class=p>,</span><span class=w> </span><span class=n>dest</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>performance</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>dep_delay_new</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>60</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>120</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>fl_date</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>mkt_carrier_fl_num</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dep_delay_new</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------+-------------+--------------------+---------------+--------+------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>2413</span><span class=w>               </span><span class=o>|</span><span class=w>            </span><span class=mi>76</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>BTV</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>2411</span><span class=w>               </span><span class=o>|</span><span class=w>            </span><span class=mi>72</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>EWR</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>SMF</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>2155</span><span class=w>               </span><span class=o>|</span><span class=w>            </span><span class=mi>94</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>IND</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>...</span><span class=w> </span><span class=n>many</span><span class=w> </span><span class=k>more</span><span class=w> </span><span class=k>rows</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- select in only specific values list
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>fl_date</span><span class=p>,</span><span class=w> </span><span class=n>mkt_carrier</span><span class=p>,</span><span class=w> </span><span class=n>mkt_carrier_fl_num</span><span class=p>,</span><span class=w> </span><span class=n>dep_delay_new</span><span class=p>,</span><span class=w> </span><span class=n>origin</span><span class=p>,</span><span class=w> </span><span class=n>dest</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>performance</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>dep_delay_new</span><span class=w> </span><span class=k>BETWEEN</span><span class=w> </span><span class=mi>60</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=mi>120</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;MKE&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;AZO&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>fl_date</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>mkt_carrier_fl_num</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dep_delay_new</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------+-------------+--------------------+---------------+--------+------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>3824</span><span class=w>               </span><span class=o>|</span><span class=w>           </span><span class=mi>107</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>MKE</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>3817</span><span class=w>               </span><span class=o>|</span><span class=w>            </span><span class=mi>62</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>AZO</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>3790</span><span class=w>               </span><span class=o>|</span><span class=w>            </span><span class=mi>97</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>AZO</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>...</span><span class=w> </span><span class=n>many</span><span class=w> </span><span class=k>more</span><span class=w> </span><span class=k>rows</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=c1>--- try out NOT BETWEEN and NOT IN operators
</span></span></span></code></pre></div><h3 id=pattern-matching>Pattern Matching<a hidden class=anchor aria-hidden=true href=#pattern-matching>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- select fields that a match a pattern with like
</span></span></span><span class=line><span class=cl><span class=c1>-- Matching single character
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>origin_city_name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>performance</span><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>origin_city_name</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;____, KS&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>origin_city_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>Hays</span><span class=p>,</span><span class=w> </span><span class=n>KS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Matching one or more characters
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>origin_city_name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>performance</span><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>origin_city_name</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;Fort%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>origin_city_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>---------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>Fort</span><span class=w> </span><span class=n>Smith</span><span class=p>,</span><span class=w> </span><span class=n>AR</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Fort</span><span class=w> </span><span class=n>Myers</span><span class=p>,</span><span class=w> </span><span class=n>FL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Fort</span><span class=w> </span><span class=n>Lauderdale</span><span class=p>,</span><span class=w> </span><span class=n>FL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Fort</span><span class=w> </span><span class=n>Wayne</span><span class=p>,</span><span class=w> </span><span class=k>IN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>4</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--- These wildcard _ and % can be used anywhere in match string
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--- Pattern matching with both _ and %
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>origin_city_name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>performance</span><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>origin_city_name</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;__________________, %&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>origin_city_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>Bloomington</span><span class=o>/</span><span class=n>Normal</span><span class=p>,</span><span class=w> </span><span class=n>IL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Hattiesburg</span><span class=o>/</span><span class=n>Laurel</span><span class=p>,</span><span class=w> </span><span class=n>MS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Sarasota</span><span class=o>/</span><span class=n>Bradenton</span><span class=p>,</span><span class=w> </span><span class=n>FL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>3</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--- To not match a pattern using NOT LIKE
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>origin_city_name</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>performance</span><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>origin_city_name</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>LIKE</span><span class=w> </span><span class=s1>&#39;%Fort%&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=n>origin_city_name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>Colorado</span><span class=w> </span><span class=n>Springs</span><span class=p>,</span><span class=w> </span><span class=n>CO</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Roanoke</span><span class=p>,</span><span class=w> </span><span class=n>VA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>Christiansted</span><span class=p>,</span><span class=w> </span><span class=n>VI</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>....</span><span class=w> </span><span class=n>many</span><span class=w> </span><span class=k>more</span><span class=w> </span><span class=k>rows</span><span class=w>
</span></span></span></code></pre></div><h3 id=null-values>Null Values<a hidden class=anchor aria-hidden=true href=#null-values>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- select fields that do not null values
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>fl_date</span><span class=p>,</span><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>airline</span><span class=p>,</span><span class=w> </span><span class=n>mkt_carrier_fl_num</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>flight</span><span class=p>,</span><span class=w> </span><span class=n>cancellation_code</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>performance</span><span class=w>  </span><span class=k>WHERE</span><span class=w> </span><span class=n>cancellation_code</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>fl_date</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>airline</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>flight</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>cancellation_code</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------+---------+--------+-------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>2034</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>864</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>A</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>488</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>B</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>...</span><span class=w> </span><span class=n>many</span><span class=w> </span><span class=k>more</span><span class=w> </span><span class=k>rows</span><span class=w>
</span></span></span></code></pre></div><h3 id=performing-joins>Performing Joins<a hidden class=anchor aria-hidden=true href=#performing-joins>#</a></h3><p><img loading=lazy src=./joins-venn-diagram.png alt="Joins Venn Diagram"></p><h4 id=inner-join>Inner Join<a hidden class=anchor aria-hidden=true href=#inner-join>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- select all entries from performance table that has an entry in codes carrier table on mkt_carrier and carrier_code.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>fl_date</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>mkt_carrier</span><span class=p>,</span><span class=n>cc</span><span class=p>.</span><span class=n>carrier_desc</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>mkt_carrier_fl_num</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>flight</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>origin</span><span class=p>,</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>dest</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>performance</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>codes_carrier</span><span class=w> </span><span class=n>cc</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>mkt_carrier</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cc</span><span class=p>.</span><span class=n>carrier_code</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>fl_date</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=n>carrier_desc</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>flight</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------+-------------+--------------------+--------+--------+------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>United</span><span class=w> </span><span class=n>Air</span><span class=w> </span><span class=n>Lines</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>2429</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>EWR</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>DEN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>United</span><span class=w> </span><span class=n>Air</span><span class=w> </span><span class=n>Lines</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>2427</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>LAS</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>SFO</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>United</span><span class=w> </span><span class=n>Air</span><span class=w> </span><span class=n>Lines</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>2426</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>SNA</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>DEN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>United</span><span class=w> </span><span class=n>Air</span><span class=w> </span><span class=n>Lines</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>2425</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>RSW</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>...</span><span class=w> </span><span class=n>many</span><span class=w> </span><span class=k>more</span><span class=w> </span><span class=k>rows</span><span class=w>
</span></span></span></code></pre></div><h4 id=outer-join>Outer Join<a hidden class=anchor aria-hidden=true href=#outer-join>#</a></h4><h5 id=left-join>Left Join<a hidden class=anchor aria-hidden=true href=#left-join>#</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- fetching only details of the flight that was cancelled
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>	</span><span class=k>SELECT</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>FL_DATE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>P</span><span class=p>.</span><span class=n>MKT_CARRIER</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>CA</span><span class=p>.</span><span class=n>CANCEL_DESC</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>P</span><span class=p>.</span><span class=n>MKT_CARRIER_FL_NUM</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>FLIGHT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>P</span><span class=p>.</span><span class=n>ORIGIN</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>P</span><span class=p>.</span><span class=n>DEST</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>CODES_CANCELLATION</span><span class=w> </span><span class=n>CA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>LEFT</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w> </span><span class=n>P</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>CANCELLATION_CODE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>CA</span><span class=p>.</span><span class=n>CANCELLATION_CODE</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>fl_date</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=n>cancel_desc</span><span class=w>     </span><span class=o>|</span><span class=w> </span><span class=n>flight</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------+-------------+---------------------+--------+--------+------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>Weather</span><span class=w>             </span><span class=o>|</span><span class=w> </span><span class=mi>2034</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>IAH</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>MFE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>Carrier</span><span class=w>             </span><span class=o>|</span><span class=w> </span><span class=mi>864</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>LAS</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>SFO</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>Weather</span><span class=w>             </span><span class=o>|</span><span class=w> </span><span class=mi>488</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>MFE</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>IAH</span><span class=w>
</span></span></span></code></pre></div><h5 id=right-join>Right Join<a hidden class=anchor aria-hidden=true href=#right-join>#</a></h5><blockquote><p>:exclamation: Note: Use Left Join as a standard practice, until right join is absolutely necessary. :exclamation:</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>--- select all records from table B and joins with table A.
</span></span></span></code></pre></div><h4 id=full-join>Full Join<a hidden class=anchor aria-hidden=true href=#full-join>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>--- Selects all records from both the tables and performs join operation.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>FL_DATE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>P</span><span class=p>.</span><span class=n>MKT_CARRIER</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>CA</span><span class=p>.</span><span class=n>CANCEL_DESC</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>P</span><span class=p>.</span><span class=n>MKT_CARRIER_FL_NUM</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>FLIGHT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>P</span><span class=p>.</span><span class=n>ORIGIN</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>P</span><span class=p>.</span><span class=n>DEST</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>CODES_CANCELLATION</span><span class=w> </span><span class=n>CA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FULL</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w> </span><span class=n>P</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>CANCELLATION_CODE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>CA</span><span class=p>.</span><span class=n>CANCELLATION_CODE</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>fl_date</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=n>cancel_desc</span><span class=w>     </span><span class=o>|</span><span class=w> </span><span class=n>flight</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------+-------------+---------------------+--------+--------+------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w>                     </span><span class=o>|</span><span class=w> </span><span class=mi>2429</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>EWR</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>DEN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w>                     </span><span class=o>|</span><span class=w> </span><span class=mi>2427</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>LAS</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>SFO</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w>                     </span><span class=o>|</span><span class=w> </span><span class=mi>2426</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>SNA</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>DEN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w>                     </span><span class=o>|</span><span class=w> </span><span class=mi>2425</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>RSW</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>
</span></span></span></code></pre></div><h3 id=ordering>Ordering<a hidden class=anchor aria-hidden=true href=#ordering>#</a></h3><h3 id=aggregate-functions>Aggregate Functions<a hidden class=anchor aria-hidden=true href=#aggregate-functions>#</a></h3><h4 id=count>Count<a hidden class=anchor aria-hidden=true href=#count>#</a></h4><h4 id=sum>Sum<a hidden class=anchor aria-hidden=true href=#sum>#</a></h4><h4 id=min-max>Min Max<a hidden class=anchor aria-hidden=true href=#min-max>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- select min and max deplay for an airport pair
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>ORIGIN</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>DEST</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>MAX</span><span class=p>(</span><span class=n>ARR_DELAY_NEW</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>MIN</span><span class=p>(</span><span class=n>ARR_DELAY_NEW</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>ARR_DELAY_NEW</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>AND</span><span class=w> </span><span class=n>ARR_DELAY_NEW</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>ORIGIN</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>DEST</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>DEST</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>origin</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>max</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=k>min</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--------+------+------+------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>ATL</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ABE</span><span class=w>  </span><span class=o>|</span><span class=w>  </span><span class=mi>281</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>CLT</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ABE</span><span class=w>  </span><span class=o>|</span><span class=w>  </span><span class=mi>181</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>DTW</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ABE</span><span class=w>  </span><span class=o>|</span><span class=w>  </span><span class=mi>353</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>FLL</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ABE</span><span class=w>  </span><span class=o>|</span><span class=w>   </span><span class=mi>89</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>ORD</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ABE</span><span class=w>  </span><span class=o>|</span><span class=w>  </span><span class=mi>195</span><span class=w> </span><span class=o>|</span><span class=w>    </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>...</span><span class=w> </span><span class=n>many</span><span class=w> </span><span class=k>more</span><span class=w> </span><span class=k>rows</span><span class=w>
</span></span></span></code></pre></div><h4 id=average>Average<a hidden class=anchor aria-hidden=true href=#average>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- Calculating AVG delay for flights that have delay &gt; 0 ordering by most departure delay
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>mkt_carrier</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>cc</span><span class=p>.</span><span class=n>carrier_desc</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>airline</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>AVG</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>dep_delay_new</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_dep_delay</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>AVG</span><span class=p>(</span><span class=n>p</span><span class=p>.</span><span class=n>arr_delay_new</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>avg_arr_delay</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>FROM</span><span class=w> </span><span class=n>performance</span><span class=w> </span><span class=n>p</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>codes_carrier</span><span class=w> </span><span class=n>cc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>ON</span><span class=w> </span><span class=n>cc</span><span class=p>.</span><span class=n>carrier_code</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>mkt_carrier</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>dep_delay_new</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>arr_delay_new</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w>  </span><span class=n>p</span><span class=p>.</span><span class=n>mkt_carrier</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>cc</span><span class=p>.</span><span class=n>carrier_desc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>avg_dep_delay</span><span class=w> </span><span class=k>desc</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=o>|</span><span class=w>      </span><span class=n>airline</span><span class=w>       </span><span class=o>|</span><span class=w>    </span><span class=n>avg_dep_delay</span><span class=w>    </span><span class=o>|</span><span class=w>    </span><span class=n>avg_arr_delay</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-------------+--------------------+---------------------+---------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>DL</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>Delta</span><span class=w> </span><span class=n>Air</span><span class=w> </span><span class=n>Lines</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=mi>70</span><span class=p>.</span><span class=mi>5181465755953480</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>67</span><span class=p>.</span><span class=mi>1188111500830718</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>United</span><span class=w> </span><span class=n>Air</span><span class=w> </span><span class=n>Lines</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>66</span><span class=p>.</span><span class=mi>0501955939880585</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>64</span><span class=p>.</span><span class=mi>4807082561251802</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>F9</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>Frontier</span><span class=w> </span><span class=n>Airlines</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>65</span><span class=p>.</span><span class=mi>9053406998158379</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>61</span><span class=p>.</span><span class=mi>6850828729281768</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>B6</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>JetBlue</span><span class=w> </span><span class=n>Airways</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=mi>64</span><span class=p>.</span><span class=mi>9873220906590121</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>63</span><span class=p>.</span><span class=mi>2437507475182394</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>NK</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>Spirit</span><span class=w> </span><span class=n>Air</span><span class=w> </span><span class=n>Lines</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>55</span><span class=p>.</span><span class=mi>4537678207739308</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>53</span><span class=p>.</span><span class=mi>5845213849287169</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>G4</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>Allegiant</span><span class=w> </span><span class=n>Air</span><span class=w>      </span><span class=o>|</span><span class=w> </span><span class=mi>52</span><span class=p>.</span><span class=mi>6692737430167598</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>51</span><span class=p>.</span><span class=mi>4497206703910615</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>AA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>American</span><span class=w> </span><span class=n>Airlines</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>49</span><span class=p>.</span><span class=mi>5509546633142139</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>49</span><span class=p>.</span><span class=mi>0363793509860926</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=k>AS</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>Alaska</span><span class=w> </span><span class=n>Airlines</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=mi>40</span><span class=p>.</span><span class=mi>0871443089430894</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>39</span><span class=p>.</span><span class=mi>2555894308943089</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>VX</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>Virgin</span><span class=w> </span><span class=n>America</span><span class=w>     </span><span class=o>|</span><span class=w> </span><span class=mi>39</span><span class=p>.</span><span class=mi>9071691176470588</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>40</span><span class=p>.</span><span class=mi>2012867647058824</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>WN</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>Southwest</span><span class=w> </span><span class=n>Airlines</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>32</span><span class=p>.</span><span class=mi>7705248760471876</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>29</span><span class=p>.</span><span class=mi>0510172679090443</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>HA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>Hawaiian</span><span class=w> </span><span class=n>Airlines</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>21</span><span class=p>.</span><span class=mi>5402704291593180</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>23</span><span class=p>.</span><span class=mi>5996472663139330</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>11</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><h4 id=filtering-aggregates---having>Filtering Aggregates - HAVING<a hidden class=anchor aria-hidden=true href=#filtering-aggregates---having>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- Calculating AVG delay for flights that have delay &gt; 0 and having more than 60 min avg delay and order by most departure delay
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>MKT_CARRIER</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>CC</span><span class=p>.</span><span class=n>CARRIER_DESC</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>AIRLINE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>AVG</span><span class=p>(</span><span class=n>P</span><span class=p>.</span><span class=n>DEP_DELAY_NEW</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>AVG_DEP_DELAY</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>AVG</span><span class=p>(</span><span class=n>P</span><span class=p>.</span><span class=n>ARR_DELAY_NEW</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>AVG_ARR_DELAY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w> </span><span class=n>P</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>CODES_CARRIER</span><span class=w> </span><span class=n>CC</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>CC</span><span class=p>.</span><span class=n>CARRIER_CODE</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>MKT_CARRIER</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>DEP_DELAY_NEW</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>AND</span><span class=w> </span><span class=n>ARR_DELAY_NEW</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>P</span><span class=p>.</span><span class=n>MKT_CARRIER</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>CC</span><span class=p>.</span><span class=n>CARRIER_DESC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>HAVING</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>P</span><span class=p>.</span><span class=n>DEP_DELAY_NEW</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>60</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>OR</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>P</span><span class=p>.</span><span class=n>ARR_DELAY_NEW</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>60</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>AVG_DEP_DELAY</span><span class=w> </span><span class=k>DESC</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=o>|</span><span class=w>      </span><span class=n>airline</span><span class=w>      </span><span class=o>|</span><span class=w>    </span><span class=n>avg_dep_delay</span><span class=w>    </span><span class=o>|</span><span class=w>    </span><span class=n>avg_arr_delay</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-------------+-------------------+---------------------+---------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>DL</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>Delta</span><span class=w> </span><span class=n>Air</span><span class=w> </span><span class=n>Lines</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>70</span><span class=p>.</span><span class=mi>5181465755953480</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>67</span><span class=p>.</span><span class=mi>1188111500830718</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>UA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>United</span><span class=w> </span><span class=n>Air</span><span class=w> </span><span class=n>Lines</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=mi>66</span><span class=p>.</span><span class=mi>0501955939880585</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>64</span><span class=p>.</span><span class=mi>4807082561251802</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>F9</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>Frontier</span><span class=w> </span><span class=n>Airlines</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>65</span><span class=p>.</span><span class=mi>9053406998158379</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>61</span><span class=p>.</span><span class=mi>6850828729281768</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>B6</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=n>JetBlue</span><span class=w> </span><span class=n>Airways</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=mi>64</span><span class=p>.</span><span class=mi>9873220906590121</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=mi>63</span><span class=p>.</span><span class=mi>2437507475182394</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>4</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><h2 id=string-functions>String Functions<a hidden class=anchor aria-hidden=true href=#string-functions>#</a></h2><h3 id=concatenation>Concatenation<a hidden class=anchor aria-hidden=true href=#concatenation>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- Concatenate two string fields
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>carrier_code</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39;, &#39;</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>carrier_desc</span><span class=w>  </span><span class=k>AS</span><span class=w> </span><span class=n>carrier</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>codes_carrier</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>carrier</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>AA</span><span class=p>,</span><span class=w> </span><span class=n>American</span><span class=w> </span><span class=n>Airlines</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=k>AS</span><span class=p>,</span><span class=w> </span><span class=n>Alaska</span><span class=w> </span><span class=n>Airlines</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>B6</span><span class=p>,</span><span class=w> </span><span class=n>JetBlue</span><span class=w> </span><span class=n>Airways</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>DL</span><span class=p>,</span><span class=w> </span><span class=n>Delta</span><span class=w> </span><span class=n>Air</span><span class=w> </span><span class=n>Lines</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>F9</span><span class=p>,</span><span class=w> </span><span class=n>Frontier</span><span class=w> </span><span class=n>Airlines</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>G4</span><span class=p>,</span><span class=w> </span><span class=n>Allegiant</span><span class=w> </span><span class=n>Air</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>HA</span><span class=p>,</span><span class=w> </span><span class=n>Hawaiian</span><span class=w> </span><span class=n>Airlines</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>NK</span><span class=p>,</span><span class=w> </span><span class=n>Spirit</span><span class=w> </span><span class=n>Air</span><span class=w> </span><span class=n>Lines</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>UA</span><span class=p>,</span><span class=w> </span><span class=n>United</span><span class=w> </span><span class=n>Air</span><span class=w> </span><span class=n>Lines</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>VX</span><span class=p>,</span><span class=w> </span><span class=n>Virgin</span><span class=w> </span><span class=n>America</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>WN</span><span class=p>,</span><span class=w> </span><span class=n>Southwest</span><span class=w> </span><span class=n>Airlines</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>11</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Alternative syntax
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>CONCAT</span><span class=p>(</span><span class=n>carrier_code</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;, &#39;</span><span class=w> </span><span class=p>,</span><span class=w> </span><span class=n>carrier_desc</span><span class=p>)</span><span class=w>  </span><span class=k>AS</span><span class=w> </span><span class=n>carrier</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>codes_carrier</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Concatenate multiple strings
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>CONCAT_WS</span><span class=p>(</span><span class=s1>&#39;, &#39;</span><span class=w> </span><span class=p>,</span><span class=n>carrier_code</span><span class=p>,</span><span class=w>  </span><span class=n>carrier_desc</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;USA&#39;</span><span class=p>)</span><span class=w>  </span><span class=k>AS</span><span class=w> </span><span class=n>carrier</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>codes_carrier</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=n>carrier</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-----------------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>AA</span><span class=p>,</span><span class=w> </span><span class=n>American</span><span class=w> </span><span class=n>Airlines</span><span class=p>,</span><span class=w> </span><span class=n>USA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=k>AS</span><span class=p>,</span><span class=w> </span><span class=n>Alaska</span><span class=w> </span><span class=n>Airlines</span><span class=p>,</span><span class=w> </span><span class=n>USA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>B6</span><span class=p>,</span><span class=w> </span><span class=n>JetBlue</span><span class=w> </span><span class=n>Airways</span><span class=p>,</span><span class=w> </span><span class=n>USA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>DL</span><span class=p>,</span><span class=w> </span><span class=n>Delta</span><span class=w> </span><span class=n>Air</span><span class=w> </span><span class=n>Lines</span><span class=p>,</span><span class=w> </span><span class=n>USA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>F9</span><span class=p>,</span><span class=w> </span><span class=n>Frontier</span><span class=w> </span><span class=n>Airlines</span><span class=p>,</span><span class=w> </span><span class=n>USA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>G4</span><span class=p>,</span><span class=w> </span><span class=n>Allegiant</span><span class=w> </span><span class=n>Air</span><span class=p>,</span><span class=w> </span><span class=n>USA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>HA</span><span class=p>,</span><span class=w> </span><span class=n>Hawaiian</span><span class=w> </span><span class=n>Airlines</span><span class=p>,</span><span class=w> </span><span class=n>USA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>NK</span><span class=p>,</span><span class=w> </span><span class=n>Spirit</span><span class=w> </span><span class=n>Air</span><span class=w> </span><span class=n>Lines</span><span class=p>,</span><span class=w> </span><span class=n>USA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>UA</span><span class=p>,</span><span class=w> </span><span class=n>United</span><span class=w> </span><span class=n>Air</span><span class=w> </span><span class=n>Lines</span><span class=p>,</span><span class=w> </span><span class=n>USA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>VX</span><span class=p>,</span><span class=w> </span><span class=n>Virgin</span><span class=w> </span><span class=n>America</span><span class=p>,</span><span class=w> </span><span class=n>USA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>WN</span><span class=p>,</span><span class=w> </span><span class=n>Southwest</span><span class=w> </span><span class=n>Airlines</span><span class=p>,</span><span class=w> </span><span class=n>USA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>11</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><h3 id=trim-functions>Trim Functions<a hidden class=anchor aria-hidden=true href=#trim-functions>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- trim leading and trailing spaces from a string
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>TRIM</span><span class=p>(</span><span class=s1>&#39; radar &#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>btrim</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>radar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- trim leading and trailing characters from a string
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>TRIM</span><span class=p>(</span><span class=s1>&#39;r&#39;</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=s1>&#39;radar&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>btrim</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=k>ada</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--trim leading characters from a string
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>postgres</span><span class=o>=#</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=k>TRIM</span><span class=p>(</span><span class=k>LEADING</span><span class=w> </span><span class=s1>&#39;ra&#39;</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=s1>&#39;radar&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>ltrim</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>dar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--trim trailing characters from a string
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>TRIM</span><span class=p>(</span><span class=k>TRAILING</span><span class=w> </span><span class=s1>&#39;dr&#39;</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=s1>&#39;radar&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>rtrim</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>rada</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Note d is not present in the string as trailing character only r is trimmed.
</span></span></span></code></pre></div><h3 id=string-isolation>String isolation<a hidden class=anchor aria-hidden=true href=#string-isolation>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- select left n characters from a string
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>LEFT</span><span class=p>(</span><span class=s1>&#39;Pluralsight&#39;</span><span class=p>,</span><span class=mi>6</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>left</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>Plural</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- select right n characters from a string
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>RIGHT</span><span class=p>(</span><span class=s1>&#39;Pluralsight&#39;</span><span class=p>,</span><span class=mi>6</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=k>right</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>lsight</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><h3 id=sub-string>Sub String<a hidden class=anchor aria-hidden=true href=#sub-string>#</a></h3><blockquote><p>:exclamation: <strong>Note</strong>: Array index starts from 1 in PostgreSQL.:exclamation:</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- split string by a delimiter and return the string n corresponding to the index
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>SPLIT_PART</span><span class=p>(</span><span class=s1>&#39;USA/DC/202&#39;</span><span class=p>,</span><span class=s1>&#39;/&#39;</span><span class=p>,</span><span class=mi>2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>split_part</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>DC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--- select substring using from index and length
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>SUBSTRING</span><span class=p>(</span><span class=s1>&#39;USA/DC/202&#39;</span><span class=p>,</span><span class=mi>5</span><span class=p>,</span><span class=mi>2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=k>substring</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-----------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>DC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Alternative syntax
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>SUBSTRING</span><span class=p>(</span><span class=s1>&#39;USA/DC/202&#39;</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=k>FOR</span><span class=w> </span><span class=mi>2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=k>substring</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-----------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>DC</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- select substring using from index to end of string
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>SUBSTRING</span><span class=p>(</span><span class=s1>&#39;USA/DC/202&#39;</span><span class=p>,</span><span class=mi>5</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=k>substring</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-----------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>DC</span><span class=o>/</span><span class=mi>202</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>1</span><span class=w> </span><span class=k>row</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><h2 id=arithmetic-functions--operators>Arithmetic Functions & Operators<a hidden class=anchor aria-hidden=true href=#arithmetic-functions--operators>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- Addition / Subtraction
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Division (beaware of data types)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=mi>13</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>6</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Division with data type fix
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=mi>13</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>::</span><span class=nb>float</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>6</span><span class=p>.</span><span class=mi>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Modulo  MOD(a,b) returns the remainder of the division of a by b
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=mi>15</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Power - POWER(base,exponent)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=mi>12</span><span class=w> </span><span class=o>^</span><span class=w> </span><span class=mi>2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>144</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Square Root - SQRT(a)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>|/</span><span class=mi>5</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>2</span><span class=p>.</span><span class=mi>23606797749979</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Absolute value - ABS(a)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>@</span><span class=p>(</span><span class=mi>36</span><span class=o>-</span><span class=mi>45</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>9</span><span class=w>
</span></span></span></code></pre></div><h2 id=set-fucntions>Set Fucntions<a hidden class=anchor aria-hidden=true href=#set-fucntions>#</a></h2><p>SQL Set theory basics:</p><ul><li>Results of a query can be considered as a set.</li><li>SQL sets have same number of columns and same data types.</li></ul><p><img loading=lazy src=./set-operations.png alt="SQL Set Operations"></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- Union operation
</span></span></span><span class=line><span class=cl><span class=c1>-- Return results of two queries.
</span></span></span><span class=line><span class=cl><span class=c1>-- Union filters all duplicate records.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>column1</span><span class=p>,</span><span class=w> </span><span class=n>column2</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>UNION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>column1</span><span class=p>,</span><span class=w> </span><span class=n>column2</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Union all returns all records, including duplicates.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>column1</span><span class=p>,</span><span class=w> </span><span class=n>column2</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>column1</span><span class=p>,</span><span class=w> </span><span class=n>column2</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Intersect operation
</span></span></span><span class=line><span class=cl><span class=c1>-- Return result from two queries that are present in both.
</span></span></span><span class=line><span class=cl><span class=c1>-- Intersect filters all duplicate records.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>column1</span><span class=p>,</span><span class=w> </span><span class=n>column2</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INTERSECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>column1</span><span class=p>,</span><span class=w> </span><span class=n>column2</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Intersect all returns all records, including duplicates.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>column1</span><span class=p>,</span><span class=w> </span><span class=n>column2</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INTERSECT</span><span class=w> </span><span class=k>ALL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>column1</span><span class=p>,</span><span class=w> </span><span class=n>column2</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Except operation
</span></span></span><span class=line><span class=cl><span class=c1>-- Return result from two queries that appears only in left query.
</span></span></span><span class=line><span class=cl><span class=c1>-- Except filters all duplicate records.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>column1</span><span class=p>,</span><span class=w> </span><span class=n>column2</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>EXCEPT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>column1</span><span class=p>,</span><span class=w> </span><span class=n>column2</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Except all returns all records, including duplicates.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>column1</span><span class=p>,</span><span class=w> </span><span class=n>column2</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>EXCEPT</span><span class=w> </span><span class=k>ALL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>column1</span><span class=p>,</span><span class=w> </span><span class=n>column2</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>table2</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h2 id=subquery>SubQuery<a hidden class=anchor aria-hidden=true href=#subquery>#</a></h2><p>A nested query where the result of one query can be use in other query.</p><p>Types:</p><ul><li>Correlated Subquery</li><li>Non-Correlated Subquery</li></ul><p>Features:</p><ul><li>Advantageous to calculate aggregates on the fly.</li><li>Membership questions can be used in subqueries.</li></ul><h3 id=non-correlated-subquery>Non-Correlated Subquery<a hidden class=anchor aria-hidden=true href=#non-correlated-subquery>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- select flights that were cancelled due to weather
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>FL_DATE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>MKT_CARRIER</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=s1>&#39; &#39;</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>MKT_CARRIER_FL_NUM</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>FLIGHT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>ORIGIN</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>DEST</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>CANCELLED</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>AND</span><span class=w> </span><span class=n>CANCELLATION_CODE</span><span class=w> </span><span class=k>IN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>CANCELLATION_CODE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=k>FROM</span><span class=w> </span><span class=n>CODES_CANCELLATION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=k>WHERE</span><span class=w> </span><span class=n>CANCEL_DESC</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Weather&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>fl_date</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>flight</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------+---------+--------+------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w> </span><span class=mi>2034</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>IAH</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>MFE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w> </span><span class=mi>488</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>MFE</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>IAH</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w> </span><span class=mi>4748</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>RAP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w> </span><span class=mi>4640</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>DSM</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>...</span><span class=w> </span><span class=n>many</span><span class=w> </span><span class=k>more</span><span class=w> </span><span class=k>rows</span><span class=w>
</span></span></span></code></pre></div><h3 id=correlated-subquery>Correlated Subquery<a hidden class=anchor aria-hidden=true href=#correlated-subquery>#</a></h3><p>A subquery that uses values from the primary query i.e, its evaluated for each row of the primary query.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- select flights from ORD to RAP which had delay greater than average delay here subquery depends on A.ORIGIN.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>CONCAT_WS</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span><span class=n>A</span><span class=p>.</span><span class=n>MKT_CARRIER</span><span class=p>,</span><span class=n>A</span><span class=p>.</span><span class=n>MKT_CARRIER_FL_NUM</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>FLIGHT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>A</span><span class=p>.</span><span class=n>ORIGIN</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>A</span><span class=p>.</span><span class=n>DEST</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>A</span><span class=p>.</span><span class=n>DEP_DELAY_NEW</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w> </span><span class=n>A</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=p>.</span><span class=n>ORIGIN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ORD&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>AND</span><span class=w> </span><span class=n>A</span><span class=p>.</span><span class=n>DEST</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;RAP&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>AND</span><span class=w> </span><span class=n>A</span><span class=p>.</span><span class=n>DEP_DELAY_NEW</span><span class=w> </span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>DEP_DELAY_NEW</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=k>FROM</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=k>WHERE</span><span class=w> </span><span class=n>DEP_DELAY_NEW</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=k>AND</span><span class=w> </span><span class=n>ORIGIN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>A</span><span class=p>.</span><span class=n>ORIGIN</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>flight</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dep_delay_new</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>---------+--------+------+---------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>UA</span><span class=w> </span><span class=mi>4748</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>RAP</span><span class=w>  </span><span class=o>|</span><span class=w>           </span><span class=mi>144</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>UA</span><span class=w> </span><span class=mi>4748</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>RAP</span><span class=w>  </span><span class=o>|</span><span class=w>           </span><span class=mi>124</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>AA</span><span class=w> </span><span class=mi>3652</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>RAP</span><span class=w>  </span><span class=o>|</span><span class=w>            </span><span class=mi>67</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>3</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Average delay for flights from ORD to RAP is
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>DEP_DELAY_NEW</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=k>FROM</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=k>WHERE</span><span class=w> </span><span class=n>DEP_DELAY_NEW</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=k>AND</span><span class=w> </span><span class=n>ORIGIN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;ORD&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>47</span><span class=p>.</span><span class=mi>25</span><span class=w>
</span></span></span></code></pre></div><h2 id=common-table-expressions>Common Table Expressions<a hidden class=anchor aria-hidden=true href=#common-table-expressions>#</a></h2><p>Create result sets that can be referenced in subsequest queries</p><p>Types:</p><ul><li>Non Recursive CTE</li><li>Recursive CTE</li></ul><p>Features:</p><ul><li>Easier to read and interpret complex queries.</li><li>Can be performance optimizations for correlated subqueries.</li></ul><h3 id=non-recursive-cte>Non Recursive CTE<a hidden class=anchor aria-hidden=true href=#non-recursive-cte>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- list all the flights based with delay greater than average delay grouped by origin.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>WITH</span><span class=w> </span><span class=n>AVG_DELAY_PER_ORIGIN</span><span class=w> </span><span class=k>AS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>DEP_DELAY_NEW</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DELAY</span><span class=p>,</span><span class=w> </span><span class=n>ORIGIN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>FROM</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>WHERE</span><span class=w> </span><span class=n>DEP_DELAY_NEW</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>ORIGIN</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>CONCAT_WS</span><span class=p>(</span><span class=s1>&#39; &#39;</span><span class=p>,</span><span class=n>A</span><span class=p>.</span><span class=n>MKT_CARRIER</span><span class=p>,</span><span class=n>A</span><span class=p>.</span><span class=n>MKT_CARRIER_FL_NUM</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>FLIGHT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>A</span><span class=p>.</span><span class=n>ORIGIN</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>A</span><span class=p>.</span><span class=n>DEST</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>A</span><span class=p>.</span><span class=n>DEP_DELAY_NEW</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w> </span><span class=n>A</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>INNER</span><span class=w> </span><span class=k>JOIN</span><span class=w> </span><span class=n>AVG_DELAY_PER_ORIGIN</span><span class=w> </span><span class=n>B</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ON</span><span class=w> </span><span class=n>A</span><span class=p>.</span><span class=n>ORIGIN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>B</span><span class=p>.</span><span class=n>ORIGIN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>A</span><span class=p>.</span><span class=n>DEP_DELAY_NEW</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=n>B</span><span class=p>.</span><span class=n>DELAY</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>flight</span><span class=w>  </span><span class=o>|</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dep_delay_new</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>---------+--------+------+---------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>UA</span><span class=w> </span><span class=mi>4279</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>EWR</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>GSP</span><span class=w>  </span><span class=o>|</span><span class=w>            </span><span class=mi>96</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>UA</span><span class=w> </span><span class=mi>4303</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>GRR</span><span class=w>  </span><span class=o>|</span><span class=w>           </span><span class=mi>101</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>UA</span><span class=w> </span><span class=mi>4305</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>PVD</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>  </span><span class=o>|</span><span class=w>           </span><span class=mi>112</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>...</span><span class=w> </span><span class=n>many</span><span class=w> </span><span class=k>more</span><span class=w> </span><span class=k>rows</span><span class=w>
</span></span></span></code></pre></div><h3 id=recursive-cte>Recursive CTE<a hidden class=anchor aria-hidden=true href=#recursive-cte>#</a></h3><blockquote><p>Note: In CTE we can optionally specify a column name which is seful in recursion.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>--- recursively evaluate sum of % with itself till 25 is reached
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>WITH</span><span class=w> </span><span class=k>RECURSIVE</span><span class=w> </span><span class=n>SERIES</span><span class=p>(</span><span class=n>LIST_NUM</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=mi>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>UNION</span><span class=w> </span><span class=k>ALL</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=n>LIST_NUM</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>FROM</span><span class=w> </span><span class=n>SERIES</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>WHERE</span><span class=w> </span><span class=n>LIST_NUM</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>5</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>25</span><span class=w> </span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>LIST_NUM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>SERIES</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>list_num</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>----------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>        </span><span class=mi>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=mi>10</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=mi>15</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=mi>20</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=mi>25</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>5</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><h2 id=pivot-and-unpivot>Pivot and Unpivot<a hidden class=anchor aria-hidden=true href=#pivot-and-unpivot>#</a></h2><p>These are used to transform one table into another</p><ul><li>Pivot - Rows into columns</li><li>Unpivot - Columns into rows</li></ul><p>Suppose we have a table named <code>sales</code>:</p><table><thead><tr><th>product</th><th>quarter</th><th>sales</th></tr></thead><tbody><tr><td>A</td><td>Q1</td><td>100</td></tr><tr><td>A</td><td>Q2</td><td>150</td></tr><tr><td>A</td><td>Q3</td><td>200</td></tr><tr><td>A</td><td>Q4</td><td>250</td></tr><tr><td>B</td><td>Q1</td><td>300</td></tr><tr><td>B</td><td>Q2</td><td>350</td></tr><tr><td>B</td><td>Q3</td><td>400</td></tr><tr><td>B</td><td>Q4</td><td>450</td></tr></tbody></table><p>We want to pivot this table to have quarters as columns.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>product</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>quarter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Q1&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>sales</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>Q1</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>quarter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Q2&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>sales</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>Q2</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>quarter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Q3&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>sales</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>Q3</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>SUM</span><span class=p>(</span><span class=k>CASE</span><span class=w> </span><span class=k>WHEN</span><span class=w> </span><span class=n>quarter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;Q4&#39;</span><span class=w> </span><span class=k>THEN</span><span class=w> </span><span class=n>sales</span><span class=w> </span><span class=k>ELSE</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>END</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>Q4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>sales</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>product</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><table><thead><tr><th>product</th><th>Q1</th><th>Q2</th><th>Q3</th><th>Q4</th></tr></thead><tbody><tr><td>A</td><td>100</td><td>150</td><td>200</td><td>250</td></tr><tr><td>B</td><td>300</td><td>350</td><td>400</td><td>450</td></tr></tbody></table><p>To unpivot the <code>quarterly_sales</code> result back to original table</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>product</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>quarter</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>sales</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>quarterly_sales</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>UNPIVOT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>sales</span><span class=w> </span><span class=k>FOR</span><span class=w> </span><span class=n>quarter</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=n>Q1</span><span class=p>,</span><span class=w> </span><span class=n>Q2</span><span class=p>,</span><span class=w> </span><span class=n>Q3</span><span class=p>,</span><span class=w> </span><span class=n>Q4</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>unpivoted_sales</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h2 id=window-functions>Window Functions<a hidden class=anchor aria-hidden=true href=#window-functions>#</a></h2><p>A window is a set of table rows over which a function is applied.</p><p>Features:</p><ul><li>Aggregagte functions can also be applied over window functions.</li><li>Order of Evaluation<ul><li>Evaluated after joins, groupings and having clause.</li><li>Evaluated same time as select statements.</li><li>To use others selections in a window functions<ul><li>include selection in a subquery or CTE.</li><li>apply window function on the outer query.</li></ul></li></ul></li><li>Cannot be used in WHERE or HAVINg clause.</li></ul><h3 id=row-number>Row Number<a hidden class=anchor aria-hidden=true href=#row-number>#</a></h3><p>Assigns sequential number to each row, the window is defined by OVER() clause.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>--- list all distinct carriers with ROW_NUMBER assigned to each row
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>WITH</span><span class=w> </span><span class=n>DISTINCT_CARRIER</span><span class=w> </span><span class=k>AS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=p>(</span><span class=n>MKT_CARRIER</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>CARRIER</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>FROM</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>ROW_NUMBER</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=p>()</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>CARRIER</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>DISTINCT_CARRIER</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>sl</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>carrier</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>----+---------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>AS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>NK</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>VX</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>AA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>5</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>B6</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>6</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>F9</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>7</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>G4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>8</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>HA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>9</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>DL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>10</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>11</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>WN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>11</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- list all distinct carriers with ROW_NUMBER assigned to each row with ordering
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>WITH</span><span class=w> </span><span class=n>DISTINCT_CARRIER</span><span class=w> </span><span class=k>AS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=p>(</span><span class=n>MKT_CARRIER</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>CARRIER</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>FROM</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>ROW_NUMBER</span><span class=p>()</span><span class=w> </span><span class=n>OVER</span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>CARRIER</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>SL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>CARRIER</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>DISTINCT_CARRIER</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>sl</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>carrier</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>----+---------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>  </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>AA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>AS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>B6</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>DL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>5</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>F9</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>6</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>G4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>7</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>HA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>8</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>NK</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=mi>9</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>UA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>10</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>VX</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>11</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>WN</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>11</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><h3 id=partition>Partition<a hidden class=anchor aria-hidden=true href=#partition>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- list count of flights from a origin to dest across all carriers
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=k>DISTINCT</span><span class=w> </span><span class=n>ORIGIN</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>DEST</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=p>(</span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>ORIGIN</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>ORIGIN</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>DEST</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>ORIGIN</span><span class=w> </span><span class=k>DESC</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>DEST</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>origin</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=k>count</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--------+------+-------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>YUM</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>PHX</span><span class=w>  </span><span class=o>|</span><span class=w>     </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>YNG</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>PIE</span><span class=w>  </span><span class=o>|</span><span class=w>     </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>YNG</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>SFB</span><span class=w>  </span><span class=o>|</span><span class=w>     </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>YKM</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>SEA</span><span class=w>  </span><span class=o>|</span><span class=w>     </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>YAK</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>CDV</span><span class=w>  </span><span class=o>|</span><span class=w>     </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>YAK</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>JNU</span><span class=w>  </span><span class=o>|</span><span class=w>     </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>...</span><span class=w> </span><span class=n>many</span><span class=w> </span><span class=k>more</span><span class=w> </span><span class=k>rows</span><span class=w>
</span></span></span></code></pre></div><h3 id=ranking>Ranking<a hidden class=anchor aria-hidden=true href=#ranking>#</a></h3><p>Ranking assigns sequential number to each row, however matching rows are matched the same.</p><p>Dense Rank is used to avoid gaps in ranking.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>mkt_carrier</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>mkt_carrier_fl_num</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>origin</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>dest</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>arr_delay_new</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>Row_number</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>OVER</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>mkt_carrier_fl_num</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>Rank</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>OVER</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>arr_delay_new</span><span class=w> </span><span class=k>DESC</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DELAY_RANK</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>Dense_rank</span><span class=p>()</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>         </span><span class=n>OVER</span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>           </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>arr_delay_new</span><span class=w> </span><span class=k>DESC</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DELAY_DENSE_RANK</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w>   </span><span class=n>performance</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w>  </span><span class=n>arr_delay_new</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=k>AND</span><span class=w> </span><span class=n>arr_delay_new</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=k>AND</span><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;AA&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=k>AND</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;MCI&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=k>AND</span><span class=w> </span><span class=n>fl_date</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;2018-01-16&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ORDER</span><span class=w>  </span><span class=k>BY</span><span class=w> </span><span class=n>arr_delay_new</span><span class=w> </span><span class=k>ASC</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>mkt_carrier</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>mkt_carrier_fl_num</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>origin</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>dest</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>arr_delay_new</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>row_number</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>delay_rank</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>delay_dense_rank</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-------------+--------------------+--------+------+---------------+------------+------------+------------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=n>AA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>2640</span><span class=w>               </span><span class=o>|</span><span class=w> </span><span class=n>MCI</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>DFW</span><span class=w>  </span><span class=o>|</span><span class=w>             </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w>         </span><span class=mi>10</span><span class=w> </span><span class=o>|</span><span class=w>                </span><span class=mi>8</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>AA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>5121</span><span class=w>               </span><span class=o>|</span><span class=w> </span><span class=n>MCI</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>CLT</span><span class=w>  </span><span class=o>|</span><span class=w>             </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w>         </span><span class=mi>10</span><span class=w> </span><span class=o>|</span><span class=w>         </span><span class=mi>10</span><span class=w> </span><span class=o>|</span><span class=w>                </span><span class=mi>8</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>AA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>4586</span><span class=w>               </span><span class=o>|</span><span class=w> </span><span class=n>MCI</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>MIA</span><span class=w>  </span><span class=o>|</span><span class=w>             </span><span class=mi>8</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>7</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>8</span><span class=w> </span><span class=o>|</span><span class=w>                </span><span class=mi>7</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>AA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>1224</span><span class=w>               </span><span class=o>|</span><span class=w> </span><span class=n>MCI</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>DFW</span><span class=w>  </span><span class=o>|</span><span class=w>             </span><span class=mi>8</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>8</span><span class=w> </span><span class=o>|</span><span class=w>                </span><span class=mi>7</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>AA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>4604</span><span class=w>               </span><span class=o>|</span><span class=w> </span><span class=n>MCI</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>DCA</span><span class=w>  </span><span class=o>|</span><span class=w>             </span><span class=mi>9</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>8</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>7</span><span class=w> </span><span class=o>|</span><span class=w>                </span><span class=mi>6</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>AA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>248</span><span class=w>                </span><span class=o>|</span><span class=w> </span><span class=n>MCI</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>  </span><span class=o>|</span><span class=w>            </span><span class=mi>12</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>5</span><span class=w> </span><span class=o>|</span><span class=w>                </span><span class=mi>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>AA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>2983</span><span class=w>               </span><span class=o>|</span><span class=w> </span><span class=n>MCI</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>  </span><span class=o>|</span><span class=w>            </span><span class=mi>12</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>5</span><span class=w> </span><span class=o>|</span><span class=w>                </span><span class=mi>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>AA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>3456</span><span class=w>               </span><span class=o>|</span><span class=w> </span><span class=n>MCI</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>  </span><span class=o>|</span><span class=w>            </span><span class=mi>16</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>6</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>4</span><span class=w> </span><span class=o>|</span><span class=w>                </span><span class=mi>4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>AA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>4659</span><span class=w>               </span><span class=o>|</span><span class=w> </span><span class=n>MCI</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>DCA</span><span class=w>  </span><span class=o>|</span><span class=w>            </span><span class=mi>25</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>9</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>3</span><span class=w> </span><span class=o>|</span><span class=w>                </span><span class=mi>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>AA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>601</span><span class=w>                </span><span class=o>|</span><span class=w> </span><span class=n>MCI</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>PHX</span><span class=w>  </span><span class=o>|</span><span class=w>            </span><span class=mi>32</span><span class=w> </span><span class=o>|</span><span class=w>         </span><span class=mi>11</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>2</span><span class=w> </span><span class=o>|</span><span class=w>                </span><span class=mi>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>AA</span><span class=w>          </span><span class=o>|</span><span class=w> </span><span class=mi>3135</span><span class=w>               </span><span class=o>|</span><span class=w> </span><span class=n>MCI</span><span class=w>    </span><span class=o>|</span><span class=w> </span><span class=n>ORD</span><span class=w>  </span><span class=o>|</span><span class=w>            </span><span class=mi>90</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>5</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>1</span><span class=w> </span><span class=o>|</span><span class=w>                </span><span class=mi>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=mi>11</span><span class=w> </span><span class=k>rows</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><h3 id=special-values>Special values<a hidden class=anchor aria-hidden=true href=#special-values>#</a></h3><p>FIRST_VALUE() and LAST_VALUE() are used to get the first and last value of a column.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>DEST</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>LAST_VALUE</span><span class=p>(</span><span class=n>ARR_DELAY_NEW</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=n>W</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>FIRST_VALUE</span><span class=w> </span><span class=p>(</span><span class=n>ARR_DELAY_NEW</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=n>W</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>ARR_DELAY_NEW</span><span class=w> </span><span class=k>IS</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=k>AND</span><span class=w> </span><span class=n>ARR_DELAY_NEW</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>WINDOW</span><span class=w> </span><span class=n>W</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=p>(</span><span class=n>PARTITION</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>DEST</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--- Wierd result
</span></span></span></code></pre></div><h3 id=lag-and-lead>Lag and Lead<a hidden class=anchor aria-hidden=true href=#lag-and-lead>#</a></h3><p>Lagging rows are the rows that occur before the current row.
Leading rows are the rows that occur after the current row.</p><p>Features:</p><ul><li>These are used in month to month or year over year analysis.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>-- get daily count group by day and lag by 5 day in another column and delta over five days.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>WITH</span><span class=w> </span><span class=n>DAILY_FLIGHT_COUNT</span><span class=w> </span><span class=k>AS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>(</span><span class=k>SELECT</span><span class=w> </span><span class=n>FL_DATE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>			</span><span class=k>COUNT</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DAILY_COUNT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>FROM</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>GROUP</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>FL_DATE</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=n>FL_DATE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>DAILY_COUNT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>LAG</span><span class=p>(</span><span class=n>DAILY_COUNT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=mi>5</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>FL_DATE</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>LAG_COUNT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>DAILY_COUNT</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>LAG</span><span class=p>(</span><span class=n>DAILY_COUNT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=mi>5</span><span class=p>)</span><span class=w> </span><span class=n>OVER</span><span class=w> </span><span class=p>(</span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>FL_DATE</span><span class=p>)</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=n>DELTA_COUNT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>DAILY_FLIGHT_COUNT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>FL_DATE</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=n>fl_date</span><span class=w>   </span><span class=o>|</span><span class=w> </span><span class=n>daily_count</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>lag_count</span><span class=w> </span><span class=o>|</span><span class=w> </span><span class=n>delta_count</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>------------+-------------+-----------+-------------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>01</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=mi>19515</span><span class=w> </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>02</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=mi>21672</span><span class=w> </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>03</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=mi>20940</span><span class=w> </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>04</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=mi>20980</span><span class=w> </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>05</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=mi>21026</span><span class=w> </span><span class=o>|</span><span class=w>           </span><span class=o>|</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>06</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=mi>17484</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>19515</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=o>-</span><span class=mi>2031</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>07</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=mi>20812</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>21672</span><span class=w> </span><span class=o>|</span><span class=w>        </span><span class=o>-</span><span class=mi>860</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>08</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=mi>21021</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>20940</span><span class=w> </span><span class=o>|</span><span class=w>          </span><span class=mi>81</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>09</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=mi>19942</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>20980</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=o>-</span><span class=mi>1038</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>10</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=mi>20487</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>21026</span><span class=w> </span><span class=o>|</span><span class=w>        </span><span class=o>-</span><span class=mi>539</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>11</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=mi>21151</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>17484</span><span class=w> </span><span class=o>|</span><span class=w>        </span><span class=mi>3667</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>12</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=mi>21319</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>20812</span><span class=w> </span><span class=o>|</span><span class=w>         </span><span class=mi>507</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=mi>2018</span><span class=o>-</span><span class=mi>01</span><span class=o>-</span><span class=mi>13</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=mi>16037</span><span class=w> </span><span class=o>|</span><span class=w>     </span><span class=mi>21021</span><span class=w> </span><span class=o>|</span><span class=w>       </span><span class=o>-</span><span class=mi>4984</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=p>...</span><span class=w> </span><span class=k>Rows</span><span class=w> </span><span class=n>till</span><span class=w> </span><span class=k>end</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=k>month</span><span class=w>
</span></span></span></code></pre></div><h2 id=performance>Performance<a hidden class=anchor aria-hidden=true href=#performance>#</a></h2><h3 id=explain-and-analyse>Explain and Analyse<a hidden class=anchor aria-hidden=true href=#explain-and-analyse>#</a></h3><h4 id=select-query>Select Query<a hidden class=anchor aria-hidden=true href=#select-query>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w> </span><span class=k>ANALYSE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>PUBLIC</span><span class=p>.</span><span class=n>PERFORMANCE</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Seq Scan on performance  (cost=0.00..14614.61 rows=621461 width=84) (actual time=0.067..126.664 rows=621461 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Planning Time: 0.068 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Execution Time: 224.380 ms&#34;</span><span class=w>
</span></span></span></code></pre></div><ul><li>0.00 (Planning/Startup cost).</li><li>14614.61 Query plan cost. (Total cost)<ul><li>COST = <code>(disk pages read _ sequential page cost) + (rows scanned _ cpu tuple cost) = (8400 * 1.0) + (621461 * 0.01) = 14614.61</code></li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=n>RELPAGES</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=s2>&#34;Disk Page Read&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>RELTUPLES</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=s2>&#34;Rows Scanned&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>PG_CLASS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>RELNAME</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;performance&#39;</span><span class=w>
</span></span></span></code></pre></div><ul><li>621461 rows is the number of rows returned by the query. (Number of rows returned)</li><li>84 Bytes is the size of the returned rows. (Total size of data/number of returned rows)</li></ul><h3 id=indexing>Indexing<a hidden class=anchor aria-hidden=true href=#indexing>#</a></h3><p>Indexs are a way to speed up queries. But indexes also add overhead to the database system as a whole, so they should be used sensibly.</p><h4 id=select-with-where-clause>Select with Where clause<a hidden class=anchor aria-hidden=true href=#select-with-where-clause>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYSE</span><span class=p>,</span><span class=w> </span><span class=k>VERBOSE</span><span class=p>)</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>PUBLIC</span><span class=p>.</span><span class=n>PERFORMANCE</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>ORIGIN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;EWR&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Gather  (cost=1000.00..13890.08 rows=12533 width=84) (actual time=0.206..33.883 rows=12888 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Workers Planned: 2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Workers Launched: 2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  -&gt;  Parallel Seq Scan on public.performance  (cost=0.00..11636.78 rows=5222 width=84) (actual time=0.027..28.880 rows=4296 loops=3)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Filter: ((performance.origin)::text = &#39;EWR&#39;::text)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Rows Removed by Filter: 202858&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Worker 0:  actual time=0.017..29.242 rows=4372 loops=1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Worker 1:  actual time=0.021..29.648 rows=4217 loops=1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Planning Time: 0.044 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Execution Time: 36.007 ms&#34;</span><span class=w>
</span></span></span></code></pre></div><p>Creating index on <code>origin</code> column is a good idea.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>origin_idx</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w> </span><span class=p>(</span><span class=n>origin</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYSE</span><span class=p>,</span><span class=w> </span><span class=k>VERBOSE</span><span class=p>)</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>PUBLIC</span><span class=p>.</span><span class=n>PERFORMANCE</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>ORIGIN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;EWR&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Bitmap Heap Scan on public.performance  (cost=141.56..9103.93 rows=12533 width=84) (actual time=0.676..17.586 rows=12888 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Recheck Cond: ((performance.origin)::text = &#39;EWR&#39;::text)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Heap Blocks: exact=2747&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  -&gt;  Bitmap Index Scan on origin_idx  (cost=0.00..138.42 rows=12533 width=0) (actual time=0.453..0.453 rows=12888 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Index Cond: ((performance.origin)::text = &#39;EWR&#39;::text)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Planning Time: 0.161 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Execution Time: 19.913 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYSE</span><span class=p>,</span><span class=w> </span><span class=k>VERBOSE</span><span class=p>)</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>PUBLIC</span><span class=p>.</span><span class=n>PERFORMANCE</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>ORIGIN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;EWR&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>DEST</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PDX&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Bitmap Heap Scan on public.performance  (cost=138.46..9132.16 rows=132 width=84) (actual time=1.256..5.416 rows=89 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Recheck Cond: ((performance.origin)::text = &#39;EWR&#39;::text)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Filter: ((performance.dest)::text = &#39;PDX&#39;::text)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Rows Removed by Filter: 12799&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Heap Blocks: exact=2747&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  -&gt;  Bitmap Index Scan on origin_idx  (cost=0.00..138.42 rows=12533 width=0) (actual time=0.864..0.865 rows=12888 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Index Cond: ((performance.origin)::text = &#39;EWR&#39;::text)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Planning Time: 0.108 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Execution Time: 5.450 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- What happens if order of columns is changed?
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYSE</span><span class=p>,</span><span class=w> </span><span class=k>VERBOSE</span><span class=p>)</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>PUBLIC</span><span class=p>.</span><span class=n>PERFORMANCE</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>DEST</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PDX&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>ORIGIN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;EWR&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p>Creating index on <code>dest</code> column is a good idea.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>dest_idx</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w> </span><span class=p>(</span><span class=n>dest</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYSE</span><span class=p>,</span><span class=w> </span><span class=k>VERBOSE</span><span class=p>)</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>PUBLIC</span><span class=p>.</span><span class=n>PERFORMANCE</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>ORIGIN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;EWR&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>DEST</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;PDX&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Bitmap Heap Scan on public.performance  (cost=212.10..689.00 rows=132 width=84) (actual time=0.845..0.948 rows=89 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Recheck Cond: (((performance.dest)::text = &#39;PDX&#39;::text) AND ((performance.origin)::text = &#39;EWR&#39;::text))&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Heap Blocks: exact=89&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  -&gt;  BitmapAnd  (cost=212.10..212.10 rows=132 width=0) (actual time=0.833..0.834 rows=0 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        -&gt;  Bitmap Index Scan on dest_idx  (cost=0.00..73.36 rows=6525 width=0) (actual time=0.353..0.353 rows=6613 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;              Index Cond: ((performance.dest)::text = &#39;PDX&#39;::text)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        -&gt;  Bitmap Index Scan on origin_idx  (cost=0.00..138.42 rows=12533 width=0) (actual time=0.391..0.392 rows=12888 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;              Index Cond: ((performance.origin)::text = &#39;EWR&#39;::text)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Planning Time: 0.211 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Execution Time: 0.976 ms&#34;</span><span class=w>
</span></span></span></code></pre></div><h4 id=index-types>Index types<a hidden class=anchor aria-hidden=true href=#index-types>#</a></h4><ul><li>B-tree: Balanced tree index useful for equality and range queries.</li><li>Hash: Useful for equality, But index need to be built manually on crashes.</li><li>Generalized inverted Index (GIN): Useful for Array or full text search.</li><li>Genneralized search index (GIST): Useful for Geometric data and full text search.</li></ul><h4 id=index-optimization>Index Optimization<a hidden class=anchor aria-hidden=true href=#index-optimization>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYSE</span><span class=p>,</span><span class=w> </span><span class=k>VERBOSE</span><span class=p>)</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>PUBLIC</span><span class=p>.</span><span class=n>PERFORMANCE</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>ORIGIN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;EWR&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>DEP_DELAY_NEW</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Gather  (cost=1000.00..13682.63 rows=3985 width=84) (actual time=0.160..42.342 rows=4453 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Workers Planned: 2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Workers Launched: 2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  -&gt;  Parallel Seq Scan on public.performance  (cost=0.00..12284.13 rows=1660 width=84) (actual time=0.089..37.477 rows=1484 loops=3)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Filter: ((performance.dep_delay_new &gt; &#39;0&#39;::numeric) AND ((performance.origin)::text = &#39;EWR&#39;::text))&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Rows Removed by Filter: 205669&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Worker 0:  actual time=0.048..37.040 rows=1307 loops=1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Worker 1:  actual time=0.213..37.313 rows=1610 loops=1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Planning Time: 0.097 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Execution Time: 43.200 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>origin_idx</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w> </span><span class=p>(</span><span class=n>origin</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYSE</span><span class=p>,</span><span class=w> </span><span class=k>VERBOSE</span><span class=p>)</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>PUBLIC</span><span class=p>.</span><span class=n>PERFORMANCE</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>ORIGIN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;EWR&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>DEP_DELAY_NEW</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Bitmap Heap Scan on public.performance  (cost=139.42..9133.13 rows=3985 width=84) (actual time=0.774..6.846 rows=4453 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Recheck Cond: ((performance.origin)::text = &#39;EWR&#39;::text)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Filter: (performance.dep_delay_new &gt; &#39;0&#39;::numeric)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Rows Removed by Filter: 8435&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Heap Blocks: exact=2747&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  -&gt;  Bitmap Index Scan on origin_idx  (cost=0.00..138.42 rows=12533 width=0) (actual time=0.550..0.551 rows=12888 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Index Cond: ((performance.origin)::text = &#39;EWR&#39;::text)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Planning Time: 0.160 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Execution Time: 7.614 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Multicolumn index
</span></span></span><span class=line><span class=cl><span class=c1>-- Creating a new index on both columns
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>origin_dep_delay_new_idx</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w> </span><span class=p>(</span><span class=n>origin</span><span class=p>,</span><span class=w> </span><span class=n>dep_delay_new</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYSE</span><span class=p>,</span><span class=w> </span><span class=k>VERBOSE</span><span class=p>)</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>PUBLIC</span><span class=p>.</span><span class=n>PERFORMANCE</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>ORIGIN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;EWR&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>DEP_DELAY_NEW</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Bitmap Heap Scan on public.performance  (cost=93.27..7053.38 rows=3985 width=84) (actual time=0.671..2.903 rows=4453 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Recheck Cond: (((performance.origin)::text = &#39;EWR&#39;::text) AND (performance.dep_delay_new &gt; &#39;0&#39;::numeric))&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Heap Blocks: exact=1634&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  -&gt;  Bitmap Index Scan on origin_dep_delay_new_idx  (cost=0.00..92.27 rows=3985 width=0) (actual time=0.484..0.485 rows=4453 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Index Cond: (((performance.origin)::text = &#39;EWR&#39;::text) AND (performance.dep_delay_new &gt; &#39;0&#39;::numeric))&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Planning Time: 0.170 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Execution Time: 3.582 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>DROP</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>origin_dep_delay_new_idx</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Index order
</span></span></span><span class=line><span class=cl><span class=c1>-- Changing the order of index - Performance is slower
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>dep_delay_new_origin_idx</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w> </span><span class=p>(</span><span class=n>origin</span><span class=p>,</span><span class=w> </span><span class=n>dep_delay_new</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYSE</span><span class=p>,</span><span class=w> </span><span class=k>VERBOSE</span><span class=p>)</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>PUBLIC</span><span class=p>.</span><span class=n>PERFORMANCE</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>ORIGIN</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;EWR&#39;</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>DEP_DELAY_NEW</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Bitmap Heap Scan on public.performance  (cost=139.42..9133.13 rows=3984 width=84) (actual time=0.646..5.768 rows=4453 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Recheck Cond: ((performance.origin)::text = &#39;EWR&#39;::text)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Filter: (performance.dep_delay_new &gt; &#39;0&#39;::numeric)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Rows Removed by Filter: 8435&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Heap Blocks: exact=2747&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  -&gt;  Bitmap Index Scan on origin_idx  (cost=0.00..138.42 rows=12533 width=0) (actual time=0.415..0.416 rows=12888 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Index Cond: ((performance.origin)::text = &#39;EWR&#39;::text)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Planning Time: 0.252 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Execution Time: 6.501 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Cover Index - Not useful in this case
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>cover_idx</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w> </span><span class=p>(</span><span class=n>fl_date</span><span class=p>,</span><span class=w> </span><span class=n>mkt_carrier</span><span class=p>,</span><span class=w> </span><span class=n>mkt_carrier_fl_num</span><span class=p>,</span><span class=w> </span><span class=n>origin</span><span class=p>,</span><span class=w> </span><span class=n>origin_city_name</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>									  </span><span class=n>origin_state_abr</span><span class=p>,</span><span class=w> </span><span class=n>dest</span><span class=p>,</span><span class=w> </span><span class=n>dest_city_name</span><span class=p>,</span><span class=w> </span><span class=n>dest_state_abr</span><span class=p>,</span><span class=w> </span><span class=n>dep_delay_new</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>									   </span><span class=n>arr_delay_new</span><span class=p>,</span><span class=w> </span><span class=n>cancelled</span><span class=p>,</span><span class=w> </span><span class=n>cancellation_code</span><span class=p>,</span><span class=w> </span><span class=n>diverted</span><span class=p>,</span><span class=w> </span><span class=n>carrier_delay</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>									   </span><span class=n>weather_delay</span><span class=p>,</span><span class=w> </span><span class=n>nas_delay</span><span class=p>,</span><span class=w> </span><span class=n>security_delay</span><span class=p>,</span><span class=w> </span><span class=n>late_aircraft_delay</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Useful when we have less number of columns in tables and it can minimize heap blocks scanned.
</span></span></span></code></pre></div><h5 id=unique-index-and-primary-key>Unique Index and Primary Key<a hidden class=anchor aria-hidden=true href=#unique-index-and-primary-key>#</a></h5><p>Primary key and unique columns already have indexes, even though its not visible in pg_admin UI.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>DROP</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>public</span><span class=p>.</span><span class=n>sample</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>public</span><span class=p>.</span><span class=n>sample</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>id</span><span class=w> </span><span class=nb>integer</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>firstcol</span><span class=w> </span><span class=nb>character</span><span class=w> </span><span class=nb>varying</span><span class=p>(</span><span class=mi>40</span><span class=p>)</span><span class=w> </span><span class=k>COLLATE</span><span class=w> </span><span class=n>pg_catalog</span><span class=p>.</span><span class=s2>&#34;default&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>secondcol</span><span class=w> </span><span class=nb>integer</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=n>sample_pkey</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=p>(</span><span class=n>id</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>TABLESPACE</span><span class=w> </span><span class=n>pg_default</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=k>public</span><span class=p>.</span><span class=n>sample</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>OWNER</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>postgres</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- To check if there is already an index
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=n>PG_INDEX</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>JOIN</span><span class=w> </span><span class=n>PG_CLASS</span><span class=w> </span><span class=k>AS</span><span class=w> </span><span class=k>C</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>C</span><span class=p>.</span><span class=n>OID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>PG_INDEX</span><span class=p>.</span><span class=n>INDEXRELID</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>PG_INDEX</span><span class=p>.</span><span class=n>INDRELID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;sample&#39;</span><span class=p>::</span><span class=n>REGCLASS</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- verify creating multiple indexes on same column
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>id_idx</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>sample</span><span class=p>(</span><span class=n>id</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- verify creating unique constraint
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>ALTER</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>SAMPLE</span><span class=w> </span><span class=k>ADD</span><span class=w> </span><span class=k>CONSTRAINT</span><span class=w> </span><span class=n>FIRSTCOL_UNQ_CONSTRAINT</span><span class=w> </span><span class=k>UNIQUE</span><span class=w> </span><span class=p>(</span><span class=n>FIRSTCOL</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- verify creating unique index on
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>UNIQUE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>FIRSTCOL_UNQ_IDX</span><span class=w> </span><span class=k>on</span><span class=w> </span><span class=n>sample</span><span class=p>(</span><span class=n>firstcol</span><span class=p>)</span><span class=w>
</span></span></span></code></pre></div><h5 id=case-insensitivity>Case Insensitivity<a hidden class=anchor aria-hidden=true href=#case-insensitivity>#</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>PUBLIC</span><span class=p>.</span><span class=n>PERFORMANCE</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>origin_city_name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;newark, NJ&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--- Making the query case insensitive
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYSE</span><span class=p>,</span><span class=w> </span><span class=k>VERBOSE</span><span class=p>)</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>PUBLIC</span><span class=p>.</span><span class=n>PERFORMANCE</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>lower</span><span class=p>(</span><span class=n>origin_city_name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>lower</span><span class=p>(</span><span class=s1>&#39;newark, Nj&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Gather  (cost=1000.00..13594.83 rows=3107 width=85) (actual time=0.205..75.207 rows=12888 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Workers Planned: 2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Workers Launched: 2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  -&gt;  Parallel Seq Scan on public.performance  (cost=0.00..12284.13 rows=1295 width=85) (actual time=0.096..70.928 rows=4296 loops=3)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Filter: (lower((performance.origin_city_name)::text) = &#39;newark, nj&#39;::text)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Rows Removed by Filter: 202858&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Worker 0:  actual time=0.163..71.812 rows=4500 loops=1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Worker 1:  actual time=0.084..71.995 rows=4401 loops=1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Planning Time: 0.080 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Execution Time: 77.392 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>ORIGIN_CITY_NAME_INDEX</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w> </span><span class=p>(</span><span class=n>ORIGIN_CITY_NAME</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- verify index is not used for query
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>ORIGIN_CITY_NAME_CASE_INSENSITIVE_INDEX</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w> </span><span class=p>(</span><span class=k>LOWER</span><span class=p>(</span><span class=n>ORIGIN_CITY_NAME</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>EXPLAIN</span><span class=w> </span><span class=p>(</span><span class=k>ANALYSE</span><span class=p>,</span><span class=w> </span><span class=k>VERBOSE</span><span class=p>)</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=o>*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>FROM</span><span class=w> </span><span class=k>PUBLIC</span><span class=p>.</span><span class=n>PERFORMANCE</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=k>lower</span><span class=p>(</span><span class=n>origin_city_name</span><span class=p>)</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>lower</span><span class=p>(</span><span class=s1>&#39;newark, Nj&#39;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Bitmap Heap Scan on public.performance  (cost=36.50..6177.88 rows=3107 width=85) (actual time=0.619..15.666 rows=12888 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Output: fl_date, mkt_carrier, mkt_carrier_fl_num, origin, origin_city_name, origin_state_abr, dest, dest_city_name, dest_state_abr, dep_delay_new, arr_delay_new, cancelled, cancellation_code, diverted, carrier_delay, weather_delay, nas_delay, security_delay, late_aircraft_delay&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Recheck Cond: (lower((performance.origin_city_name)::text) = &#39;newark, nj&#39;::text)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  Heap Blocks: exact=2747&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;  -&gt;  Bitmap Index Scan on origin_city_name_case_insensitive_index  (cost=0.00..35.73 rows=3107 width=0) (actual time=0.408..0.409 rows=12888 loops=1)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;        Index Cond: (lower((performance.origin_city_name)::text) = &#39;newark, nj&#39;::text)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Planning Time: 0.159 ms&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=s2>&#34;Execution Time: 18.005 ms&#34;</span><span class=w>
</span></span></span></code></pre></div><h5 id=partial-index>Partial Index<a hidden class=anchor aria-hidden=true href=#partial-index>#</a></h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>--- Creating partial index (based on usecase)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>CREATE</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>DEP_DEL_NEW_IDX</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w> </span><span class=p>(</span><span class=n>DEP_DELAY_NEW</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>WHERE</span><span class=w> </span><span class=n>DEP_DELAY_NEW</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>10</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h4 id=index-maintenance>Index Maintenance<a hidden class=anchor aria-hidden=true href=#index-maintenance>#</a></h4><h4 id=reinitialize-indexes>Reinitialize Indexes<a hidden class=anchor aria-hidden=true href=#reinitialize-indexes>#</a></h4><p>In case of heavy OLTP workload, lots of deletes, Reindex periodically.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>REINDEX</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>origin_idx</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>REINDEX</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- with pg_cron
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>SELECT</span><span class=w> </span><span class=n>cron</span><span class=p>.</span><span class=n>schedule</span><span class=p>(</span><span class=s1>&#39;30 3 * * 6&#39;</span><span class=p>,</span><span class=w> </span><span class=err>$$</span><span class=k>REINDEX</span><span class=w> </span><span class=k>INDEX</span><span class=w> </span><span class=n>origin_idx$$</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><h3 id=populating-large-data>Populating Large Data<a hidden class=anchor aria-hidden=true href=#populating-large-data>#</a></h3><h4 id=disable-auto-commit>Disable Auto Commit<a hidden class=anchor aria-hidden=true href=#disable-auto-commit>#</a></h4><ul><li>Wrap the query in transaction block</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>BEGIN</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>-- Insert statements
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>COMMIT</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><h4 id=bulk-insert-with-copy>Bulk Insert with COPY<a hidden class=anchor aria-hidden=true href=#bulk-insert-with-copy>#</a></h4><ul><li>Drop indexs before bulk insert</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=c1>--- Copying to a file
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>Copy</span><span class=w> </span><span class=p>(</span><span class=k>Select</span><span class=w> </span><span class=err>\</span><span class=o>*</span><span class=w> </span><span class=k>From</span><span class=w> </span><span class=n>performance</span><span class=p>)</span><span class=w> </span><span class=k>To</span><span class=w> </span><span class=s1>&#39;performance.csv&#39;</span><span class=w> </span><span class=k>With</span><span class=w> </span><span class=n>CSV</span><span class=w> </span><span class=k>DELIMITER</span><span class=w> </span><span class=s1>&#39;,&#39;</span><span class=w> </span><span class=n>HEADER</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>--- Loading from a file
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>COPY</span><span class=w> </span><span class=n>performance</span><span class=w>  </span><span class=k>From</span><span class=w> </span><span class=s1>&#39;performance.csv&#39;</span><span class=w> </span><span class=k>With</span><span class=w> </span><span class=n>CSV</span><span class=w> </span><span class=k>DELIMITER</span><span class=w> </span><span class=s1>&#39;,&#39;</span><span class=w> </span><span class=n>HEADER</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><ul><li>Perform <code>ANALYZE PERFORMANCE</code> after bulk insert. This will create statistics on the table, helps postgres optimizer engine to optimize query plans.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>ANALYZE</span><span class=w> </span><span class=k>VERBOSE</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=n>analyzing</span><span class=w> </span><span class=s2>&#34;public.performance&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=s2>&#34;performance&#34;</span><span class=p>:</span><span class=w> </span><span class=n>scanned</span><span class=w> </span><span class=mi>8400</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=mi>8400</span><span class=w> </span><span class=n>pages</span><span class=p>,</span><span class=w> </span><span class=n>containing</span><span class=w> </span><span class=mi>621461</span><span class=w> </span><span class=n>live</span><span class=w> </span><span class=k>rows</span><span class=w> </span><span class=k>and</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>dead</span><span class=w> </span><span class=k>rows</span><span class=p>;</span><span class=w> </span><span class=mi>30000</span><span class=w> </span><span class=k>rows</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>sample</span><span class=p>,</span><span class=w> </span><span class=mi>621461</span><span class=w> </span><span class=n>estimated</span><span class=w> </span><span class=n>total</span><span class=w> </span><span class=k>rows</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>ANALYZE</span><span class=w>
</span></span></span></code></pre></div><ul><li>Analyse tables once a week.</li></ul><h3 id=vacuuming-tables-and-database>Vacuuming Tables and Database<a hidden class=anchor aria-hidden=true href=#vacuuming-tables-and-database>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=n>VACCUUM</span><span class=w> </span><span class=k>VERBOSE</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=n>vacuuming</span><span class=w> </span><span class=s2>&#34;public.performance&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=n>launched</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=n>parallel</span><span class=w> </span><span class=k>vacuum</span><span class=w> </span><span class=n>workers</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=k>index</span><span class=w> </span><span class=n>cleanup</span><span class=w> </span><span class=p>(</span><span class=n>planned</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=s2>&#34;performance&#34;</span><span class=p>:</span><span class=w> </span><span class=k>found</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>removable</span><span class=p>,</span><span class=w> </span><span class=mi>7</span><span class=w> </span><span class=n>nonremovable</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>out</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=mi>8400</span><span class=w> </span><span class=n>pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>DETAIL</span><span class=p>:</span><span class=w>  </span><span class=mi>0</span><span class=w> </span><span class=n>dead</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w> </span><span class=n>cannot</span><span class=w> </span><span class=n>be</span><span class=w> </span><span class=n>removed</span><span class=w> </span><span class=n>yet</span><span class=p>,</span><span class=w> </span><span class=n>oldest</span><span class=w> </span><span class=n>xmin</span><span class=p>:</span><span class=w> </span><span class=mi>514</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>There</span><span class=w> </span><span class=n>were</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>unused</span><span class=w> </span><span class=n>item</span><span class=w> </span><span class=n>identifiers</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Skipped</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>pages</span><span class=w> </span><span class=n>due</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>buffer</span><span class=w> </span><span class=n>pins</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>frozen</span><span class=w> </span><span class=n>pages</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>0</span><span class=w> </span><span class=n>pages</span><span class=w> </span><span class=k>are</span><span class=w> </span><span class=n>entirely</span><span class=w> </span><span class=n>empty</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>CPU</span><span class=p>:</span><span class=w> </span><span class=k>user</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=k>system</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>elapsed</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>01</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=n>vacuuming</span><span class=w> </span><span class=s2>&#34;pg_toast.pg_toast_16396&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=s2>&#34;pg_toast_16396&#34;</span><span class=p>:</span><span class=w> </span><span class=k>found</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>removable</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>nonremovable</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>out</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>DETAIL</span><span class=p>:</span><span class=w>  </span><span class=mi>0</span><span class=w> </span><span class=n>dead</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w> </span><span class=n>cannot</span><span class=w> </span><span class=n>be</span><span class=w> </span><span class=n>removed</span><span class=w> </span><span class=n>yet</span><span class=p>,</span><span class=w> </span><span class=n>oldest</span><span class=w> </span><span class=n>xmin</span><span class=p>:</span><span class=w> </span><span class=mi>514</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>There</span><span class=w> </span><span class=n>were</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>unused</span><span class=w> </span><span class=n>item</span><span class=w> </span><span class=n>identifiers</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Skipped</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>pages</span><span class=w> </span><span class=n>due</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>buffer</span><span class=w> </span><span class=n>pins</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>frozen</span><span class=w> </span><span class=n>pages</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>0</span><span class=w> </span><span class=n>pages</span><span class=w> </span><span class=k>are</span><span class=w> </span><span class=n>entirely</span><span class=w> </span><span class=n>empty</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>CPU</span><span class=p>:</span><span class=w> </span><span class=k>user</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=k>system</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>elapsed</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>VACUUM</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>DELETE</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>DEP_DELAY_NEW</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>10</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>VACCUUM</span><span class=w> </span><span class=k>VERBOSE</span><span class=w> </span><span class=n>PERFORMANCE</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=n>vacuuming</span><span class=w> </span><span class=s2>&#34;public.performance&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=n>launched</span><span class=w> </span><span class=mi>2</span><span class=w> </span><span class=n>parallel</span><span class=w> </span><span class=k>vacuum</span><span class=w> </span><span class=n>workers</span><span class=w> </span><span class=k>for</span><span class=w> </span><span class=k>index</span><span class=w> </span><span class=n>vacuuming</span><span class=w> </span><span class=p>(</span><span class=n>planned</span><span class=p>:</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=n>scanned</span><span class=w> </span><span class=k>index</span><span class=w> </span><span class=s2>&#34;dep_del_new_idx&#34;</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>remove</span><span class=w> </span><span class=mi>472701</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>DETAIL</span><span class=p>:</span><span class=w>  </span><span class=n>CPU</span><span class=p>:</span><span class=w> </span><span class=k>user</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>01</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=k>system</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>elapsed</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>01</span><span class=w> </span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=n>scanned</span><span class=w> </span><span class=k>index</span><span class=w> </span><span class=s2>&#34;origin_city_name_case_insensitive_index&#34;</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>remove</span><span class=w> </span><span class=mi>472701</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>DETAIL</span><span class=p>:</span><span class=w>  </span><span class=n>CPU</span><span class=p>:</span><span class=w> </span><span class=k>user</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>05</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=k>system</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>elapsed</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>08</span><span class=w> </span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=n>scanned</span><span class=w> </span><span class=k>index</span><span class=w> </span><span class=s2>&#34;origin_city_name_index&#34;</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>remove</span><span class=w> </span><span class=mi>472701</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>DETAIL</span><span class=p>:</span><span class=w>  </span><span class=n>CPU</span><span class=p>:</span><span class=w> </span><span class=k>user</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>04</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=k>system</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>01</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>elapsed</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>08</span><span class=w> </span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=s2>&#34;performance&#34;</span><span class=p>:</span><span class=w> </span><span class=n>removed</span><span class=w> </span><span class=mi>472701</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=mi>8399</span><span class=w> </span><span class=n>pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>DETAIL</span><span class=p>:</span><span class=w>  </span><span class=n>CPU</span><span class=p>:</span><span class=w> </span><span class=k>user</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>01</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=k>system</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>elapsed</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>01</span><span class=w> </span><span class=n>s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=k>index</span><span class=w> </span><span class=s2>&#34;origin_city_name_index&#34;</span><span class=w> </span><span class=n>now</span><span class=w> </span><span class=k>contains</span><span class=w> </span><span class=mi>148760</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=mi>546</span><span class=w> </span><span class=n>pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>DETAIL</span><span class=p>:</span><span class=w>  </span><span class=mi>472701</span><span class=w> </span><span class=k>index</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w> </span><span class=n>were</span><span class=w> </span><span class=n>removed</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>0</span><span class=w> </span><span class=k>index</span><span class=w> </span><span class=n>pages</span><span class=w> </span><span class=n>have</span><span class=w> </span><span class=n>been</span><span class=w> </span><span class=n>deleted</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>are</span><span class=w> </span><span class=n>currently</span><span class=w> </span><span class=n>reusable</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>CPU</span><span class=p>:</span><span class=w> </span><span class=k>user</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=k>system</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>elapsed</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=k>index</span><span class=w> </span><span class=s2>&#34;origin_city_name_case_insensitive_index&#34;</span><span class=w> </span><span class=n>now</span><span class=w> </span><span class=k>contains</span><span class=w> </span><span class=mi>148760</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=mi>546</span><span class=w> </span><span class=n>pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>DETAIL</span><span class=p>:</span><span class=w>  </span><span class=mi>472701</span><span class=w> </span><span class=k>index</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w> </span><span class=n>were</span><span class=w> </span><span class=n>removed</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>0</span><span class=w> </span><span class=k>index</span><span class=w> </span><span class=n>pages</span><span class=w> </span><span class=n>have</span><span class=w> </span><span class=n>been</span><span class=w> </span><span class=n>deleted</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>are</span><span class=w> </span><span class=n>currently</span><span class=w> </span><span class=n>reusable</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>CPU</span><span class=p>:</span><span class=w> </span><span class=k>user</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=k>system</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>elapsed</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=k>index</span><span class=w> </span><span class=s2>&#34;dep_del_new_idx&#34;</span><span class=w> </span><span class=n>now</span><span class=w> </span><span class=k>contains</span><span class=w> </span><span class=mi>124759</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=mi>345</span><span class=w> </span><span class=n>pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>DETAIL</span><span class=p>:</span><span class=w>  </span><span class=mi>0</span><span class=w> </span><span class=k>index</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w> </span><span class=n>were</span><span class=w> </span><span class=n>removed</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>0</span><span class=w> </span><span class=k>index</span><span class=w> </span><span class=n>pages</span><span class=w> </span><span class=n>have</span><span class=w> </span><span class=n>been</span><span class=w> </span><span class=n>deleted</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>are</span><span class=w> </span><span class=n>currently</span><span class=w> </span><span class=n>reusable</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>CPU</span><span class=p>:</span><span class=w> </span><span class=k>user</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=k>system</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>elapsed</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=s2>&#34;performance&#34;</span><span class=p>:</span><span class=w> </span><span class=k>found</span><span class=w> </span><span class=mi>472701</span><span class=w> </span><span class=n>removable</span><span class=p>,</span><span class=w> </span><span class=mi>148760</span><span class=w> </span><span class=n>nonremovable</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=mi>8400</span><span class=w> </span><span class=k>out</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=mi>8400</span><span class=w> </span><span class=n>pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>DETAIL</span><span class=p>:</span><span class=w>  </span><span class=mi>0</span><span class=w> </span><span class=n>dead</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w> </span><span class=n>cannot</span><span class=w> </span><span class=n>be</span><span class=w> </span><span class=n>removed</span><span class=w> </span><span class=n>yet</span><span class=p>,</span><span class=w> </span><span class=n>oldest</span><span class=w> </span><span class=n>xmin</span><span class=p>:</span><span class=w> </span><span class=mi>515</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>There</span><span class=w> </span><span class=n>were</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>unused</span><span class=w> </span><span class=n>item</span><span class=w> </span><span class=n>identifiers</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Skipped</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>pages</span><span class=w> </span><span class=n>due</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>buffer</span><span class=w> </span><span class=n>pins</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>frozen</span><span class=w> </span><span class=n>pages</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>0</span><span class=w> </span><span class=n>pages</span><span class=w> </span><span class=k>are</span><span class=w> </span><span class=n>entirely</span><span class=w> </span><span class=n>empty</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>CPU</span><span class=p>:</span><span class=w> </span><span class=k>user</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>09</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=k>system</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>02</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>elapsed</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>14</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=n>vacuuming</span><span class=w> </span><span class=s2>&#34;pg_toast.pg_toast_16396&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>INFO</span><span class=p>:</span><span class=w>  </span><span class=s2>&#34;pg_toast_16396&#34;</span><span class=p>:</span><span class=w> </span><span class=k>found</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>removable</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>nonremovable</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>out</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>pages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>DETAIL</span><span class=p>:</span><span class=w>  </span><span class=mi>0</span><span class=w> </span><span class=n>dead</span><span class=w> </span><span class=k>row</span><span class=w> </span><span class=n>versions</span><span class=w> </span><span class=n>cannot</span><span class=w> </span><span class=n>be</span><span class=w> </span><span class=n>removed</span><span class=w> </span><span class=n>yet</span><span class=p>,</span><span class=w> </span><span class=n>oldest</span><span class=w> </span><span class=n>xmin</span><span class=p>:</span><span class=w> </span><span class=mi>515</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>There</span><span class=w> </span><span class=n>were</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>unused</span><span class=w> </span><span class=n>item</span><span class=w> </span><span class=n>identifiers</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Skipped</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>pages</span><span class=w> </span><span class=n>due</span><span class=w> </span><span class=k>to</span><span class=w> </span><span class=n>buffer</span><span class=w> </span><span class=n>pins</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=n>frozen</span><span class=w> </span><span class=n>pages</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=mi>0</span><span class=w> </span><span class=n>pages</span><span class=w> </span><span class=k>are</span><span class=w> </span><span class=n>entirely</span><span class=w> </span><span class=n>empty</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>CPU</span><span class=p>:</span><span class=w> </span><span class=k>user</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=k>system</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>,</span><span class=w> </span><span class=n>elapsed</span><span class=p>:</span><span class=w> </span><span class=mi>0</span><span class=p>.</span><span class=mi>00</span><span class=w> </span><span class=n>s</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>VACUUM</span><span class=w>
</span></span></span></code></pre></div><ul><li>Vacuum tables once a week.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>VACUUM</span><span class=w> </span><span class=k>VERBOSE</span><span class=p>;</span><span class=w> </span><span class=c1>-- Vacuum all tables
</span></span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://raghu-vijaykumar.github.io/blog/tags/postgresql/>Postgresql</a></li><li><a href=https://raghu-vijaykumar.github.io/blog/tags/database/>Database</a></li></ul><nav class=paginav><a class=prev href=https://raghu-vijaykumar.github.io/blog/docs/apache-beam/><span class=title>« Prev</span><br><span>Apache Beam - Dataflow</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share PostgreSQL on x" href="https://x.com/intent/tweet/?text=PostgreSQL&amp;url=https%3a%2f%2fraghu-vijaykumar.github.io%2fblog%2fdocs%2fpostgresql%2f&amp;hashtags=postgresql%2cdatabase"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PostgreSQL on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fraghu-vijaykumar.github.io%2fblog%2fdocs%2fpostgresql%2f&amp;title=PostgreSQL&amp;summary=PostgreSQL&amp;source=https%3a%2f%2fraghu-vijaykumar.github.io%2fblog%2fdocs%2fpostgresql%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PostgreSQL on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fraghu-vijaykumar.github.io%2fblog%2fdocs%2fpostgresql%2f&title=PostgreSQL"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PostgreSQL on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fraghu-vijaykumar.github.io%2fblog%2fdocs%2fpostgresql%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PostgreSQL on whatsapp" href="https://api.whatsapp.com/send?text=PostgreSQL%20-%20https%3a%2f%2fraghu-vijaykumar.github.io%2fblog%2fdocs%2fpostgresql%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PostgreSQL on telegram" href="https://telegram.me/share/url?text=PostgreSQL&amp;url=https%3a%2f%2fraghu-vijaykumar.github.io%2fblog%2fdocs%2fpostgresql%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share PostgreSQL on ycombinator" href="https://news.ycombinator.com/submitlink?t=PostgreSQL&u=https%3a%2f%2fraghu-vijaykumar.github.io%2fblog%2fdocs%2fpostgresql%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://raghu-vijaykumar.github.io/blog/>Raghu Vijaykumar</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>