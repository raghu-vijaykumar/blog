<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Design Patterns | Raghu Vijaykumar</title>
<meta name=keywords content="system-design,software-architecture,patterns"><meta name=description content="Design Patterns Before we get to the design patterns themselves, there is just one more piece of housekeeping that I wanted to mention, and that is to do with the so-called Gamma categorization.
Typically, in design pattern literature, regardless of which language of design patterns we are talking about, we split all the design patterns into several different categories. These categories are often called Gamma categorization, named after Erich Gamma, one of the authors of the original Gang of Four book that uses C++ and Smalltalk."><meta name=author content="Me"><link rel=canonical href=https://raghu-vijaykumar.github.io/blog/docs/system-design/design-patterns/readme/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.e7c811b1152f0ea0017b0724f2c040700cf8bf84343fd4fd5eca45af82337db9.css integrity="sha256-58gRsRUvDqABewck8sBAcAz4v4Q0P9T9XspFr4Izfbk=" rel="preload stylesheet" as=style><link rel=icon href=https://raghu-vijaykumar.github.io/blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://raghu-vijaykumar.github.io/blog/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://raghu-vijaykumar.github.io/blog/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://raghu-vijaykumar.github.io/blog/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://raghu-vijaykumar.github.io/blog/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://raghu-vijaykumar.github.io/blog/docs/system-design/design-patterns/readme/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Design Patterns"><meta property="og:description" content="Design Patterns Before we get to the design patterns themselves, there is just one more piece of housekeeping that I wanted to mention, and that is to do with the so-called Gamma categorization.
Typically, in design pattern literature, regardless of which language of design patterns we are talking about, we split all the design patterns into several different categories. These categories are often called Gamma categorization, named after Erich Gamma, one of the authors of the original Gang of Four book that uses C++ and Smalltalk."><meta property="og:type" content="article"><meta property="og:url" content="https://raghu-vijaykumar.github.io/blog/docs/system-design/design-patterns/readme/"><meta property="og:image" content="https://raghu-vijaykumar.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="docs"><meta property="article:published_time" content="2024-08-24T05:54:50+00:00"><meta property="article:modified_time" content="2024-08-24T05:54:50+00:00"><meta property="og:site_name" content="Raghu Vijaykumar"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://raghu-vijaykumar.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Design Patterns"><meta name=twitter:description content="Design Patterns Before we get to the design patterns themselves, there is just one more piece of housekeeping that I wanted to mention, and that is to do with the so-called Gamma categorization.
Typically, in design pattern literature, regardless of which language of design patterns we are talking about, we split all the design patterns into several different categories. These categories are often called Gamma categorization, named after Erich Gamma, one of the authors of the original Gang of Four book that uses C++ and Smalltalk."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Docs","item":"https://raghu-vijaykumar.github.io/blog/docs/"},{"@type":"ListItem","position":2,"name":"Design Patterns","item":"https://raghu-vijaykumar.github.io/blog/docs/system-design/design-patterns/readme/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Design Patterns","name":"Design Patterns","description":"Design Patterns Before we get to the design patterns themselves, there is just one more piece of housekeeping that I wanted to mention, and that is to do with the so-called Gamma categorization.\nTypically, in design pattern literature, regardless of which language of design patterns we are talking about, we split all the design patterns into several different categories. These categories are often called Gamma categorization, named after Erich Gamma, one of the authors of the original Gang of Four book that uses C++ and Smalltalk.","keywords":["system-design","software-architecture","patterns"],"articleBody":"Design Patterns Before we get to the design patterns themselves, there is just one more piece of housekeeping that I wanted to mention, and that is to do with the so-called Gamma categorization.\nTypically, in design pattern literature, regardless of which language of design patterns we are talking about, we split all the design patterns into several different categories. These categories are often called Gamma categorization, named after Erich Gamma, one of the authors of the original Gang of Four book that uses C++ and Smalltalk.\nGamma Categorization Creational Patterns\nThese patterns deal with the creation or construction of objects. Object construction can be more complicated than simply invoking a constructor. Explicit Creation: Directly calling the constructor with arguments to initialize an object. Implicit Creation: Using mechanisms like dependency injection frameworks or reflection to create objects behind the scenes. Wholesale Creation: A single statement or constructor call is sufficient to initialize the object. Piecewise Initialization: Several steps or statements are needed to fully initialize an object. Structural Patterns\nConcerned with the structure of classes and their members. Focus on how classes and objects are composed to form larger structures. Examples include wrappers that mimic the underlying interface they wrap. Emphasize good API design, making interfaces convenient and usable for others. Structural patterns often involve replicating or enhancing interfaces for better usability. Behavioral Patterns\nUnlike creational and structural patterns, behavioral patterns don’t follow a central theme. They address different problems and solve them in unique ways using various object-oriented mechanisms. There may be some overlap (e.g., Strategy and Template Method patterns), but each pattern generally solves a specific problem with its own approach. Behavioral patterns focus on the interaction and responsibility of objects. Factory Pattern Factory Method and Factory Class Implementation The Factory Method and the Factory Class design patterns, which are essential for creating objects in a way that is both flexible and adheres to object-oriented principles like the Single Responsibility Principle and Open/Closed Principle.\nThe discussion begins by introducing a simple Point class and evolves into explaining how to initialize points using both Cartesian and Polar coordinates while maintaining clean and understandable code.\nFactory Method Pattern The Factory Method is a design pattern that provides an alternative to using constructors (initializers) directly for object creation. It allows for the creation of objects without specifying the exact class of the object that will be created.\nProblem Statement: Initially, the Point class is designed to accept Cartesian coordinates (x, y). However, if we want to add support for polar coordinates (rho, theta), we encounter issues:\nRedefining the constructor for different coordinate systems isn’t possible. Expanding the constructor to handle multiple coordinate systems can lead to cluttered and complex code, breaking the Single Responsibility Principle. Solution: Instead of overloading or expanding the constructor, we can create factory methods:\nFactory methods are static methods that handle the creation of objects with different initialization requirements. These methods clearly indicate the type of initialization (Cartesian or Polar) and keep the initialization logic encapsulated. from enum import Enum from math import * class CoordinateSystem(Enum): CARTESIAN = 1 POLAR = 2 class Point: def __init__(self, a, b, system=CoordinateSystem.CARTESIAN): if system == CoordinateSystem.CARTESIAN: self.x = a self.y = b elif system == CoordinateSystem.POLAR: self.x = a * sin(b) self.y = a * cos(b) def __str__(self): return f'x: {self.x}, y: {self.y}' @staticmethod def new_cartesian_point(x, y): return Point(x, y) @staticmethod def new_polar_point(rho, theta): return Point(rho * sin(theta), rho * cos(theta)) In this implementation: new_cartesian_point(x, y) and new_polar_point(rho, theta) are static factory methods that create a Point object based on the coordinate system.\nFactory Class Pattern A Factory Class centralizes the creation logic of related objects. When a class starts accumulating too many factory methods, it’s often a good idea to move these methods into a separate class.\nProblem Statement As the number of factory methods grows, the Point class might become cluttered. This violates the Single Responsibility Principle as the class is handling both the creation and representation of points.\nSolution Extract the factory methods into a separate PointFactory class:\nThis class will be responsible for the creation of Point objects. This separation ensures that the Point class only focuses on representing a point, while the factory handles object creation. class PointFactory: @staticmethod def new_cartesian_point(x, y): return Point(x, y) @staticmethod def new_polar_point(rho, theta): return Point(rho * sin(theta), rho * cos(theta)) In the PointFactory class: new_cartesian_point(x, y) and new_polar_point(rho, theta) methods are moved here, separating concerns.\nUsage if __name__ == '__main__': p1 = Point(2, 3, CoordinateSystem.CARTESIAN) p2 = PointFactory.new_cartesian_point(1, 2) p3 = Point.Factory.new_cartesian_point(5, 6) # Using nested factory class p4 = Point.factory.new_cartesian_point(7, 8) # Singleton factory instance print(p1, p2, p3, p4) In this example:\nPointFactory.new_cartesian_point(1, 2) creates a Cartesian point using the factory class. Point.factory.new_cartesian_point(7, 8) demonstrates using a singleton factory instance. Abstract Factory Design Pattern Implementation The abstract factory design pattern allows for the creation of families of related objects without specifying their concrete classes. This implementation demonstrates how to use abstract factories to create different types of drinks (e.g., tea and coffee) using a vending machine scenario.\nStep-by-Step Implementation HotDrink Abstract Base Class: An abstract base class HotDrink is defined with an abstract method consume. Concrete drink classes (e.g., Tea, Coffee) inherit from this base class and implement the consume method. Concrete Drink Classes: Two concrete classes, Tea and Coffee, inherit from HotDrink and provide specific implementations of the consume method. HotDrinkFactory Abstract Base Class: An abstract base class HotDrinkFactory is defined with a method prepare. This method is meant to be overridden by concrete factory classes to prepare specific types of drinks. Concrete Factory Classes: Two concrete factory classes, TeaFactory and CoffeeFactory, inherit from HotDrinkFactory. These classes implement the prepare method to create instances of Tea and Coffee, respectively. HotDrinkMachine Class: The HotDrinkMachine class simulates a vending machine that can prepare different types of drinks. It uses an enumeration AvailableDrink to list available drink types. The machine maintains a list of factory instances for each drink type. Drink Preparation: The make_drink method in HotDrinkMachine allows the user to select a drink type and specify the amount. The corresponding factory prepares the drink, and the consume method is called to simulate drinking it. from abc import ABC from enum import Enum, auto # Abstract base class for drinks class HotDrink(ABC): def consume(self): pass # Concrete drink classes class Tea(HotDrink): def consume(self): print('This tea is nice but I\\'d prefer it with milk') class Coffee(HotDrink): def consume(self): print('This coffee is delicious') # Abstract base class for drink factories class HotDrinkFactory(ABC): def prepare(self, amount): pass # Concrete factory classes class TeaFactory(HotDrinkFactory): def prepare(self, amount): print(f'Put in tea bag, boil water, pour {amount}ml, enjoy!') return Tea() class CoffeeFactory(HotDrinkFactory): def prepare(self, amount): print(f'Grind some beans, boil water, pour {amount}ml, enjoy!') return Coffee() # Vending machine class for preparing drinks class HotDrinkMachine: class AvailableDrink(Enum): # Lists available drinks COFFEE = auto() TEA = auto() factories = [] initialized = False def __init__(self): if not self.initialized: self.initialized = True for d in self.AvailableDrink: name = d.name[0] + d.name[1:].lower() factory_name = name + 'Factory' factory_instance = eval(factory_name)() self.factories.append((name, factory_instance)) def make_drink(self): print('Available drinks:') for f in self.factories: print(f[0]) s = input(f'Please pick drink (0-{len(self.factories)-1}): ') idx = int(s) s = input(f'Specify amount: ') amount = int(s) return self.factories[idx][1].prepare(amount) # Standalone function to prepare drinks def make_drink(type): if type == 'tea': return TeaFactory().prepare(200) elif type == 'coffee': return CoffeeFactory().prepare(50) else: return None # Main function to demonstrate the vending machine if __name__ == '__main__': hdm = HotDrinkMachine() drink = hdm.make_drink() drink.consume() Key Concepts Abstract Base Classes (ABC): Used to define a common interface for a group of related objects. Concrete Implementations: Specific classes that implement the abstract methods defined in the base classes. Factory Pattern: A design pattern used to create objects without specifying the exact class of the object that will be created. Duck Typing: Python’s dynamic typing feature where the type of an object is determined by its behavior (methods and properties) rather than its inheritance from a specific class. This pattern is particularly useful in scenarios where you need to create families of related objects and want to ensure that the objects are created in a consistent manner.\nPrototype Design Pattern The prototype design pattern is a creational design pattern that allows an object to be cloned, creating new instances by copying an existing object, known as the prototype. This pattern is particularly useful when creating a new object from scratch is resource-intensive or when an object should be replicated with slight modifications.\nMotivation In many real-world scenarios, objects are not designed from scratch but are built upon existing designs. The prototype pattern follows this approach by allowing an existing object to be duplicated and then customized without affecting the original object. This is especially useful when the construction of objects is complex or resource-heavy.\nKey Concepts Prototype: The original object that will be copied.\nCloning: Creating a new instance by copying the prototype. Deep Copy: A type of copy where all attributes of the object are recursively copied, ensuring that the new object does not reference the same attributes as the original. Shallow Copy: A type of copy where only the object’s references are copied, meaning that both the original and the copied object share the same references. Example Implementation in Python import copy class Address: def __init__(self, street_address, city, country): self.country = country self.city = city self.street_address = street_address def __str__(self): return f'{self.street_address}, {self.city}, {self.country}' class Person: def __init__(self, name, address): self.name = name self.address = address def __str__(self): return f'{self.name} lives at {self.address}' Usage Creating a Prototype:\njohn = Person(\"John\", Address(\"123 London Road\", \"London\", \"UK\")) print(john) Cloning with Deep Copy:\njane = copy.deepcopy(john) jane.name = \"Jane\" jane.address.street_address = \"124 London Road\" print(john, jane) Output\nJohn lives at 123 London Road, London, UK John lives at 123 London Road, London, UK Jane lives at 124 London Road, London, UK In this example, jane is created as a deep copy of john. This means jane has the same initial properties as john, but changes to jane do not affect john.\nShallow Copy Example (Not Recommended for This Case):\njane = copy.copy(john) jane.name = \"Jane\" jane.address.street_address = \"124 London Road\" print(john, jane) Output\nJohn lives at 124 London Road, London, UK Jane lives at 124 London Road, London, UK Benefits of the Prototype Pattern Efficiency: Reduces the overhead of creating complex objects from scratch. Flexibility: Allows the creation of new objects by varying the state of the existing objects. Decoupling: Clients are decoupled from the specific classes they are using, as they interact with the prototype instead of directly with the class. Singleton Design Pattern The singleton design pattern ensures that a class has only one instance and provides a global point of access to that instance. This pattern is often used when exactly one object is needed to coordinate actions across the system, such as when managing shared resources like databases or configuration settings.\nMotivation The singleton pattern is motivated by scenarios where certain classes should only be instantiated once. Common examples include:\nDatabase Connections: You typically only want one instance of a database connection throughout the lifecycle of an application to avoid redundant connections and ensure consistent access to the data. Object Factories: An object factory is often stateless and doesn’t require multiple instances, making a singleton a natural choice. The pattern is often criticized because its improper use can lead to design issues, such as hidden dependencies and difficulties in testing. However, when used appropriately, it can be a powerful tool for managing global state.\nKey Concepts Single Instance: The singleton pattern restricts the instantiation of a class to one “single” instance.\nGlobal Access: Provides a global point of access to that instance. Lazy Instantiation: The singleton instance is created only when it is actually needed, rather than at the time of application startup. Example Implementation in Python import random class Database: initialized = False def __init__(self): # Initialization logic (e.g., loading a database) would go here. pass _instance = None def __new__(cls, *args, **kwargs): if not cls._instance: cls._instance = super(Database, cls).__new__(cls, *args, **kwargs) return cls._instance Usage # Creating the Singleton Instance database = Database() # Verifying Singleton Behavior if __name__ == '__main__': d1 = Database() d2 = Database() print(d1 == d2) # True, as both d1 and d2 refer to the same instance print(database == d1) # True, database and d1 refer to the same instance Overriding new: The new method is overridden to control the object allocation. If an instance already exists (_instance is not None), the existing instance is returned. If no instance exists, a new one is created and assigned to _instance. Initialization (init): The init method is called every time an instance is created or accessed. In a singleton, this can cause issues if initialization logic (e.g., loading resources) is placed here. To avoid repeated initialization, consider adding a guard clause to prevent the execution of initialization logic if the instance is already initialized. Potential Issues Repeated Initialization: Even though the singleton ensures that only one instance of the class exists, the init method might still be called multiple times. This can be problematic if init performs expensive operations, like loading a database. One way to handle this is by adding an initialization flag. Testing: Singletons can make unit testing challenging, as they introduce hidden dependencies. In testing, you may need to reset or mock the singleton instance to ensure tests are isolated from each other. Benefits of the Singleton Pattern Controlled Access: Ensures a class has only one instance, which is useful for resources like configuration settings or loggers. Global State: Provides a global point of access to the instance, making it easy to share the instance across different parts of the application. Singleton Using a Decorator A decorator can be used to implement the Singleton pattern by controlling the instantiation of a class and ensuring that only one instance of the class is ever created.\nCode Example:\ndef singleton(class_): instances = {} def get_instance(*args, **kwargs): if class_ not in instances: instances[class_] = class_(*args, **kwargs) return instances[class_] return get_instance @singleton class Database: def __init__(self): print('Loading database') if __name__ == '__main__': d1 = Database() d2 = Database() print(d1 == d2) # True, indicating that d1 and d2 are the same instance The singleton decorator keeps a dictionary of instances. When a class is instantiated, the decorator checks if an instance of the class already exists. If not, it creates one; otherwise, it returns the existing instance. The initializer is only called once, preventing multiple initializations. Singleton Using a Metaclass A metaclass can also be used to create a Singleton. The metaclass ensures that only one instance of the class is created, similar to the decorator approach.\nCode Example:\nclass Singleton(type): _instances = {} def __call__(cls, *args, **kwargs): if cls not in cls._instances: cls._instances[cls] = super(Singleton, cls).__call__(*args, **kwargs) return cls._instances[cls] class Database(metaclass=Singleton): def __init__(self): print('Loading database') if __name__ == '__main__': d1 = Database() d2 = Database() print(d1 == d2) # True, indicating that d1 and d2 are the same instance The Singleton metaclass overrides the call method, which is responsible for object creation. It checks if an instance of the class exists; if not, it creates one using the super() function. This approach is similar to the decorator but leverages Python’s metaclass capabilities. Monostate (Borg) Singleton Pattern The Monostate pattern is a variation of the Singleton pattern where all instances of the class share the same state. Unlike the traditional Singleton, it allows multiple instances but with shared state.\nCode Example:\nclass CEO: __shared_state = { 'name': 'Steve', 'age': 55 } def __init__(self): self.__dict__ = self.__shared_state def __str__(self): return f'{self.name} is {self.age} years old' class Monostate: _shared_state = {} def __new__(cls, *args, **kwargs): obj = super(Monostate, cls).__new__(cls, *args, **kwargs) obj.__dict__ = cls._shared_state return obj class CFO(Monostate): def __init__(self): self.name = '' self.money_managed = 0 def __str__(self): return f'{self.name} manages ${self.money_managed}bn' if __name__ == '__main__': ceo1 = CEO() print(ceo1) ceo1.age = 66 ceo2 = CEO() ceo2.age = 77 print(ceo1) print(ceo2) ceo2.name = 'Tim' ceo3 = CEO() print(ceo1, ceo2, ceo3) cfo1 = CFO() cfo1.name = 'Sheryl' cfo1.money_managed = 1 print(cfo1) cfo2 = CFO() cfo2.name = 'Ruth' cfo2.money_managed = 10 print(cfo1, cfo2, sep='\\n') In the Monostate pattern, the __shared_state or _shared_state dictionary is used to store the state of the class. Each instance shares the same state by setting self.dict to reference this shared state. Changes made through any instance will affect all other instances since they all reference the same state. Singleton Testing The Singleton pattern ensures that a class has only one instance and provides a global point of access to that instance. In this example, the Singleton is implemented using a metaclass.\nclass Singleton(type): _instances = {} def __call__(cls, *args, **kwargs): if cls not in cls._instances: cls._instances[cls] = super(Singleton, cls).__call__(*args, **kwargs) return cls._instances[cls] Here, the Singleton metaclass keeps a dictionary of instances, ensuring that only one instance of a class exists. If an instance already exists, it returns the existing instance instead of creating a new one.\nDatabase Class: The Database class uses the Singleton pattern to ensure that only one instance of the database is loaded into memory.\nclass Database(metaclass=Singleton): def __init__(self): self.population = {} f = open('capitals.txt', 'r') lines = f.readlines() for i in range(0, len(lines), 2): self.population[lines[i].strip()] = int(lines[i + 1].strip()) f.close() The Database class reads from a file named capitals.txt to load population data for various cities.\nSingleton Record Finder: The SingletonRecordFinder class uses the Database singleton to calculate the total population of a list of cities.\nclass SingletonRecordFinder: def total_population(self, cities): result = 0 for c in cities: result += Database().population[c] return result This approach tightly couples the record finder to the singleton database, which can make testing difficult.\nConfigurable Record Finder: To improve testability, the ConfigurableRecordFinder allows dependency injection, enabling the use of different databases for testing.\nclass ConfigurableRecordFinder: def __init__(self, db): self.db = db def total_population(self, cities): result = 0 for c in cities: result += self.db.population[c] return result This class takes a database object as an argument, making it possible to inject a dummy database during testing.\nDummy Database for Testing: The DummyDatabase class is a mock database used for unit testing.\nclass DummyDatabase: population = { 'alpha': 1, 'beta': 2, 'gamma': 3 } def get_population(self, name): return self.population[name] This class provides predictable, hardcoded population data to facilitate reliable testing.\nUnit Tests: The following unit tests ensure the Singleton behavior and verify the functionality of both the SingletonRecordFinder and ConfigurableRecordFinder.\nimport unittest class SingletonTests(unittest.TestCase): def test_is_singleton(self): db = Database() db2 = Database() self.assertEqual(db, db2) def test_singleton_total_population(self): \"\"\" This tests on a live database :( \"\"\" rf = SingletonRecordFinder() names = ['Seoul', 'Mexico City'] tp = rf.total_population(names) self.assertEqual(tp, 17500000 + 17400000) # what if these change? ddb = DummyDatabase() def test_dependent_total_population(self): crf = ConfigurableRecordFinder(self.ddb) self.assertEqual( crf.total_population(['alpha', 'beta']), 3 ) if __name__ == '__main__': unittest.main() test_is_singleton: Verifies that only one instance of the Database class exists. test_singleton_total_population: Tests the total population calculation using the SingletonRecordFinder with live data. test_dependent_total_population: Tests the total population calculation using the ConfigurableRecordFinder with a dummy database. These tests demonstrate the importance of decoupling code from singletons to allow for better testability.\nAdapter Design Pattern The Adapter Design Pattern allows objects with incompatible interfaces to work together. It acts as a bridge between two interfaces, adapting one interface to another that the client expects.\nProblem Statement When building software systems, it is common to encounter situations where an existing class or component has an interface that does not match the interface required by a specific client. Modifying the existing class to meet the new interface could lead to breaking other parts of the system or complicating the code unnecessarily. In such cases, the Adapter Pattern provides a solution by creating a wrapper (adapter) around the existing class to adapt its interface to the expected one.\nReal-World Analogy A travel adapter is a perfect analogy for the Adapter Pattern. Electrical devices have different plug types and voltage requirements based on the country they are designed for. Instead of modifying each device to fit into different outlets, a travel adapter converts the plug type to fit the outlet and allows the device to function properly.\nParticipants\nTarget (Client Interface): The interface expected by the client. Adaptee: The existing interface that needs to be adapted. Adapter: The class that implements the Target interface and adapts the Adaptee to the Target. Example Implementation Consider a scenario where you are given a legacy API that includes a Point class and a draw_point function for drawing points. However, you are working with a system where graphical objects are represented by lines and rectangles.\nGiven API\nclass Point: def __init__(self, x, y): self.x = x self.y = y def draw_point(p): print('.', end='') Working Classes\nclass Line: def __init__(self, start, end): self.start = start self.end = end class Rectangle(list): def __init__(self, x, y, width, height): super().__init__() self.append(Line(Point(x, y), Point(x + width, y))) self.append(Line(Point(x + width, y), Point(x + width, y + height))) self.append(Line(Point(x, y), Point(x, y + height))) self.append(Line(Point(x, y + height), Point(x + width, y + height))) Adapter Implementation The LineToPointAdapter adapts the Line class to be compatible with the draw_point function by converting the line into a series of points.\nclass LineToPointAdapter(list): count = 0 def __init__(self, line): self.count += 1 print(f'{self.count}: Generating points for line ' f'[{line.start.x},{line.start.y}]→' f'[{line.end.x},{line.end.y}]') left = min(line.start.x, line.end.x) right = max(line.start.x, line.end.x) top = min(line.start.y, line.end.y) bottom = max(line.start.y, line.end.y) if right - left == 0: for y in range(top, bottom + 1): self.append(Point(left, y)) elif line.end.y - line.start.y == 0: for x in range(left, right + 1): self.append(Point(x, top)) Usage Example The draw function can now work with rectangles by using the LineToPointAdapter to convert lines into points.\ndef draw(rcs): print(\"\\n\\n--- Drawing some stuff ---\\n\") for rc in rcs: for line in rc: adapter = LineToPointAdapter(line) for p in adapter: draw_point(p) if __name__ == '__main__': rs = [ Rectangle(1, 1, 10, 10), Rectangle(3, 3, 6, 6) ] draw(rs) draw(rs) The Adapter Pattern is a useful design pattern when you need to integrate classes with incompatible interfaces. It allows you to reuse existing code without modifying it, thereby promoting flexibility and reusability in software design.\nImplementing a Cache A cache is a data structure that stores the results of expensive function calls and reuses those results when the same inputs occur again. By implementing a cache in the adapter, we can avoid regenerating temporary objects, improving the efficiency of the code.\nModifying the Adapter to Use a Cache: The LineToPointAdapter class is modified to include a cache, which is a dictionary that maps hash values of Line objects to their corresponding points. This way, if a Line has already been converted to points, the adapter can retrieve the points from the cache instead of regenerating them.\nSteps in the Cache Implementation: Calculate Hash Value: The adapter first calculates a unique hash value for the Line object. This hash value is used as the key in the cache dictionary.\nself.h = hash(line) Check Cache: Before generating points, the adapter checks if the points for the given line are already present in the cache.\nif self.h in self.cache: return Generate Points if Not Cached: If the points are not in the cache, the adapter generates them and stores them in the cache.\npoints = [] # (Point generation logic) self.cache[self.h] = points Iterate Over Cached Points: The iter method is overridden to return an iterator over the cached points.\ndef __iter__(self): return iter(self.cache[self.h]) By incorporating caching into the adapter, we can significantly reduce the number of temporary objects generated, thereby improving the performance and efficiency of the system. This approach is especially beneficial when the adapter is repeatedly invoked with the same data.\nBridge Design Pattern The Bridge design pattern is used to decouple an abstraction from its implementation, allowing both to vary independently. This pattern is particularly useful when dealing with a potential “Cartesian product complexity explosion,” which occurs when multiple abstractions and implementations multiply the number of classes needed.\nCode Structure Renderer Interface: Renderer: An abstract base class that defines the method render_circle(radius). This method serves as the interface for rendering shapes. Concrete Implementations of Renderer: VectorRenderer: A concrete implementation of Renderer. It provides a specific implementation for rendering circles in a vector form. RasterRenderer: Another concrete implementation of Renderer. It renders circles in a raster (pixel-based) form. Shape Base Class: Shape: An abstract base class that requires a Renderer to be passed during initialization. This class defines the methods draw() and resize(factor), which are intended to be overridden by derived classes. Concrete Shape Implementation: Circle: A concrete implementation of the Shape class. It includes a radius attribute and provides specific implementations for the draw() and resize(factor) methods. draw(): Uses the associated Renderer to render the circle based on its radius. resize(factor): Resizes the circle by multiplying its radius by the given factor. Main Execution: The script demonstrates the usage of the Bridge pattern by creating instances of VectorRenderer and RasterRenderer, and then using these renderers to draw and resize a Circle. Code Example class Renderer: def render_circle(self, radius): pass class VectorRenderer(Renderer): def render_circle(self, radius): print(f'Drawing a circle of radius {radius}') class RasterRenderer(Renderer): def render_circle(self, radius): print(f'Drawing pixels for circle of radius {radius}') class Shape: def __init__(self, renderer): self.renderer = renderer def draw(self): pass def resize(self, factor): pass class Circle(Shape): def __init__(self, renderer, radius): super().__init__(renderer) self.radius = radius def draw(self): self.renderer.render_circle(self.radius) def resize(self, factor): self.radius *= factor if __name__ == '__main__': raster = RasterRenderer() vector = VectorRenderer() circle = Circle(vector, 5) circle.draw() circle.resize(2) circle.draw() Usage Renderers: The VectorRenderer and RasterRenderer provide different ways to render the Circle. Shapes: The Circle class can be extended or modified without altering the renderer classes, showcasing the flexibility provided by the Bridge pattern. Advantages Decoupling: The Bridge pattern decouples abstraction (Shape) from implementation (Renderer), enabling both to evolve independently. Reduced Complexity: By separating concerns, the pattern avoids a complexity explosion that could result from combining multiple abstractions and implementations. Limitations Open/Closed Principle: The pattern requires modifications to existing classes (e.g., adding new methods to Renderer and its subclasses) when new shapes or renderers are introduced, which might violate the open/closed principle. Composite Design Pattern The Composite Design Pattern is a structural design pattern that allows you to treat individual objects and compositions of objects uniformly. This pattern provides a way to group objects into tree structures to represent part-whole hierarchies. Composite lets clients treat individual objects and compositions of objects uniformly, thereby simplifying the client code.\nMotivation In software development, there are scenarios where you need to work with both individual objects and collections of objects. For example, in a graphics application, you might have simple shapes like circles and squares, but you might also want to group these shapes together to form complex structures.\nThe Composite Design Pattern enables you to treat both individual objects (e.g., a circle or a square) and groups of objects (e.g., a group of shapes) uniformly. This pattern allows you to define a common interface for all objects in the composition, so clients can interact with both individual components and composites through the same interface.\nImplementation Base Class The base class, GraphicObject, serves as the foundation for both individual components (e.g., Circle and Square) and composite objects (e.g., a group of shapes). It contains a list of children that represent the group of objects and a color property.\nclass GraphicObject: def __init__(self, color=None): self.color = color self.children = [] self._name = 'Group' @property def name(self): return self._name def _print(self, items, depth): items.append('*' * depth) if self.color: items.append(self.color) items.append(f'{self.name}\\n') for child in self.children: child._print(items, depth + 1) def __str__(self): items = [] self._print(items, 0) return ''.join(items) Concrete Classes Concrete classes like Circle and Square inherit from GraphicObject and override the name property to return their specific type. These classes can be treated as both individual objects and as part of a composite object.\nclass Circle(GraphicObject): @property def name(self): return 'Circle' class Square(GraphicObject): @property def name(self): return 'Square' Example Usage Below is an example of how you can use the Composite Design Pattern to create and manipulate both individual shapes and groups of shapes.\nif __name__ == '__main__': drawing = GraphicObject() drawing._name = 'My Drawing' drawing.children.append(Square('Red')) drawing.children.append(Circle('Yellow')) group = GraphicObject() # no name group.children.append(Circle('Blue')) group.children.append(Square('Blue')) drawing.children.append(group) print(drawing) Output The output of the above code will display a hierarchy of the shapes and groups within the drawing:\n*My Drawing **Red **Square **Yellow **Circle **Group ***Blue ***Circle ***Blue ***Square Neural Network Example This documentation describes an implementation of the Composite Design Pattern in the context of modeling a neural network. The pattern is used to treat individual neurons and layers of neurons uniformly, allowing them to be connected seamlessly. This approach simplifies the handling of connections within a neural network by making scalar elements behave like collections.\nKey Components Connectable Class Purpose: Provides a base class that allows any derived class to connect to other instances of Connectable. Implements the Iterable interface, enabling the uniform treatment of single elements and collections. Methods: connect_to(self, other): Connects the current instance (self) to another Connectable instance (other). Iterates over elements of self and other, creating two-way connections between them. iter(self): Defines iteration over instances, yielding self in the case of scalar objects. Neuron Class Purpose: Represents a single neuron within a neural network. Inherits from Connectable to enable connections with other neurons or layers of neurons. Attributes: name: The name of the neuron. inputs: A list of neurons connected as inputs to this neuron. outputs: A list of neurons connected as outputs from this neuron. Methods: init(self, name): Initializes a neuron with a name, and empty input/output lists. str(self): Returns a string representation of the neuron, including its name, the number of inputs, and the number of outputs. NeuronLayer Class Purpose: Represents a layer of neurons. Inherits from both list and Connectable, allowing it to behave like a list of neurons while also supporting connections. Attributes: name: The name of the neuron layer. Methods: init(self, name, count): Initializes a neuron layer with a specified number of neurons. Each neuron in the layer is named according to the layer’s name and its index. str(self): Returns a string representation of the neuron layer, including its name and the number of neurons it contains. Example Usage Connecting Neurons and Layers The following code demonstrates how to create neurons and layers, and connect them using the connect_to method:\nif __name__ == '__main__': neuron1 = Neuron('n1') neuron2 = Neuron('n2') layer1 = NeuronLayer('L1', 3) layer2 = NeuronLayer('L2', 4) neuron1.connect_to(neuron2) neuron1.connect_to(layer1) layer1.connect_to(neuron2) layer1.connect_to(layer2) print(neuron1) print(neuron2) print(layer1) print(layer2) Output This example produces the following output:\nn1, 0 inputs, 4 outputs n2, 4 inputs, 0 outputs L1 with 3 neurons L2 with 4 neurons Explanation Neuron 1 (n1) is connected to Neuron 2 (n2) and Layer 1 (L1). This results in n1 having 4 outputs (3 to L1 and 1 to n2), while n2 has 4 inputs (3 from L1 and 1 from n1). Layer 1 (L1) is connected to Layer 2 (L2), creating connections between all neurons in L1 and L2. The connect_to method in Connectable enables this flexibility, allowing neurons and layers to be interconnected regardless of their types. Decorator Pattern The Decorator Pattern is a structural design pattern used to add additional behaviors or responsibilities to objects dynamically. Unlike subclassing, where additional functionality is achieved through inheritance, the decorator pattern allows the augmentation of an object’s behavior without modifying its structure or the need for inheritance. This promotes adherence to the Open/Closed Principle and Single Responsibility Principle in software design.\nMotivation The main motivation for using the decorator pattern is to add features or functionality to existing objects in a flexible and reusable way. Instead of altering the original object or creating numerous subclasses for every possible combination of features, decorators allow you to “wrap” an object with new functionality dynamically.\nImplementation General Approach\nInheritance: One way to augment a class is by inheriting from it and adding new features. However, this approach can become cumbersome if multiple combinations of features are needed, leading to an explosion of subclasses. Decorators: A more flexible approach is to use decorators, which are objects that wrap the original object and add new behaviors to it. Decorators can be stacked, allowing for dynamic and combinatorial behavior modification. Python-Specific Implementation In Python, the decorator pattern can be implemented using higher-order functions, where a function wraps another function to extend its behavior. Python also provides special syntax for applying decorators to functions, using the @decorator_name syntax.\nimport time def time_it(func): def wrapper(): start = time.time() # Measure start time result = func() # Call the original function end = time.time() # Measure end time print(f'{func.__name__} took {int((end-start)*1000)}ms') # Print execution time return result return wrapper @time_it # Applying the time_it decorator def some_op(): print('Starting op') time.sleep(1) # Simulate a time-consuming operation print('We are done') return 123 if __name__ == '__main__': some_op() Explanation Decorator Function (time_it):\nPurpose: Measures the execution time of the function it decorates. How It Works: It defines an inner function (wrapper) that wraps the original function. The wrapper function records the start time, executes the original function, records the end time, and then prints the time taken to execute the function. Finally, it returns the result of the original function. Decorated Function (some_op):\nA simple function that simulates a time-consuming operation using time.sleep(1). The @time_it decorator is applied to this function, meaning that every time some_op is called, it will be wrapped in the timing logic defined in time_it. Execution:\nWhen some_op is called, the execution time is measured and printed due to the decorator, illustrating how the decorator pattern can be used to augment behavior without modifying the original function. Key Points Flexible Augmentation: Decorators allow the addition of functionality in a flexible manner without altering the original object or function. Reusability: Decorators can be reused across different functions or objects, promoting code reusability. Adherence to Design Principles: The decorator pattern supports the Open/Closed Principle by allowing the extension of an object’s behavior without modifying its code. Classic Implementation of Decorator Pattern in Object-Oriented Programming The Decorator Pattern is a structural design pattern used to dynamically add behavior to individual objects without affecting the behavior of other objects from the same class. This is achieved by creating decorator classes that wrap the original class, augmenting its functionality. This approach adheres to the Open/Closed Principle by allowing functionality to be extended without modifying existing code.\nMotivation In object-oriented programming, there often arises a need to extend the functionality of a class without modifying its code. Traditional inheritance can lead to an explosion of subclasses for every combination of features, making the system complex and hard to maintain. The decorator pattern offers a more flexible and reusable solution by allowing the dynamic composition of behaviors.\nImplementation Core Components Abstract Base Class (Shape):\nThe abstract base class provides a common interface for all shapes, ensuring that concrete classes and decorators can be treated uniformly. Concrete Classes (Circle, Square): These classes represent the basic shapes. They implement the core functionality, such as resizing or defining specific properties like radius or side length. Decorator Classes (ColoredShape, TransparentShape): These classes are decorators that add additional functionality, such as color or transparency, to the basic shapes. They wrap a shape object and extend its behavior. from abc import ABC class Shape(ABC): def __str__(self): return '' class Circle(Shape): def __init__(self, radius=0.0): self.radius = radius def resize(self, factor): self.radius *= factor def __str__(self): return f'A circle of radius {self.radius}' class Square(Shape): def __init__(self, side): self.side = side def __str__(self): return f'A square with side {self.side}' class ColoredShape(Shape): def __init__(self, shape, color): if isinstance(shape, ColoredShape): raise Exception('Cannot apply ColoredDecorator twice') self.shape = shape self.color = color def __str__(self): return f'{self.shape} has the color {self.color}' class TransparentShape(Shape): def __init__(self, shape, transparency): self.shape = shape self.transparency = transparency def __str__(self): return f'{self.shape} has {self.transparency * 100.0}% transparency' if __name__ == '__main__': circle = Circle(2) print(circle) red_circle = ColoredShape(circle, \"red\") print(red_circle) red_half_transparent_square = TransparentShape(red_circle, 0.5) print(red_half_transparent_square) # Example of double decoration mixed = ColoredShape(ColoredShape(Circle(3), 'red'), 'blue') print(mixed) Explanation Abstract Base Class (Shape):\nProvides a base class for all shapes, enforcing a uniform interface. In this case, it only defines a str method, which is overridden by concrete shapes and decorators. Concrete Shapes (Circle, Square): These classes inherit from Shape and provide specific implementations for geometric shapes.\nCircle: Implements radius-related functionality and includes a resize method.\nSquare: Represents a square and stores the length of its side. Decorator Classes (ColoredShape, TransparentShape):\nColoredShape: Adds color to a shape. It checks if the shape has already been colored to prevent applying the same decorator twice.\nTransparentShape: Adds transparency to a shape and converts the transparency value into a percentage for display.\nCombining Decorators:\nDecorators can be stacked, allowing for multiple extensions of the original shape’s functionality. For example, a circle can be both colored and transparent. The code demonstrates how to combine these decorators to create complex shapes with multiple features.\nKey Points Dynamic Behavior Extension: The decorator pattern allows you to dynamically add functionality to objects at runtime, promoting flexibility and reusability. Adherence to Design Principles: The pattern adheres to the Open/Closed Principle by allowing objects to be extended without modifying their code. Preventing Redundant Decoration: The implementation includes checks to prevent the same decorator from being applied multiple times, avoiding redundant or conflicting behaviors. Limitations Access to Original Methods: Decorators do not automatically provide access to the original object’s methods unless explicitly programmed. For example, the resize method of Circle is not accessible once the shape is decorated. Complexity: When multiple decorators are stacked, it can become difficult to manage the interactions between them, particularly if they modify the same aspect of the object. File Decorator Implementation with Logging This documentation outlines the implementation of a class decorator that wraps around a file object, allowing additional functionality such as logging while maintaining access to the file’s original methods. The approach leverages dynamic programming to proxy all operations from the decorator to the underlying file, minimizing the need to manually override each file method.\nClass: FileWithLogging The FileWithLogging class is a decorator for file objects, allowing additional operations (like logging) to be performed whenever certain methods (e.g., writelines) are called on the file. It also ensures that all other file operations behave as if they were directly performed on the original file.\nclass FileWithLogging: def __init__(self, file): self.file = file def writelines(self, strings): self.file.writelines(strings) print(f'wrote {len(strings)} lines') def __iter__(self): return self.file.__iter__() def __next__(self): return self.file.__next__() def __getattr__(self, item): return getattr(self.__dict__['file'], item) def __setattr__(self, key, value): if key == 'file': self.__dict__[key] = value else: setattr(self.__dict__['file'], key) def __delattr__(self, item): delattr(self.__dict__['file'], item) Constructor: init(self, file): Initialize the decorator with the file to be wrapped. Method: writelines(self, strings): Write multiple lines to the file and log how many lines were written. Method: iter(self): Allow the decorated file to be used in a loop, forwarding iteration to the original file. Method: next(self): Support fetching the next line in a loop, just like the original Method: getattr(self, item): Forward all method and attribute calls to the original file, ensuring the decorator acts just like the file. Method: setattr(self, key, value): Set attributes either on the decorator or the original file, depending on the key. Method: delattr(self, item): Delete attributes from the original file.\nExample Usage: file = FileWithLogging(open('hello.txt', 'w')) file.writelines(['hello', 'world']) # Logs: wrote 2 lines file.write('testing') file.close() The FileWithLogging class decorates a file to add logging and ensure it retains all original file behaviors. It demonstrates how to wrap an object and dynamically forward calls, making it an effective example of enhancing functionality without modifying the original class.\nFacade Design Pattern The Facade Design Pattern provides a simplified interface to a complex subsystem. It offers an easy-to-use API while hiding the complexities of underlying systems. In software systems, this allows clients to perform operations with minimal code, while still enabling power users to access lower-level functionality when needed.\nIn this example, a Console class is implemented as a facade to manage Buffer and Viewport components, which handle the complexity of text manipulation in a console-based system.\nComponents: Buffer Class:\nPurpose: Represents a low-level construct that holds characters in a 1D list (simulating a text buffer). Attributes: width: Width of the buffer (default: 30). height: Height of the buffer (default: 20). buffer: A list of characters initialized to blank spaces (’ ‘), with a total size of width * height. Methods: getitem(item): Allows access to elements in the buffer using indexing. write(text): Appends text to the buffer. Code:\npython Copy code class Buffer: def init(self, width=30, height=20): self.width = width self.height = height self.buffer = [’ ‘] * (width * height)\ndef __getitem__(self, item): return self.buffer.__getitem__(item) def write(self, text): self.buffer += text Viewport Class:\nPurpose: Acts as a view into a section of the buffer, allowing partial content to be displayed or manipulated. Attributes: buffer: Holds a reference to a Buffer object. offset: Represents the starting point of the viewport within the buffer (default: 0). Methods: get_char_at(index): Retrieves a character from the buffer at a specified index, adjusted by the viewport’s offset. append(text): Appends text to the buffer. Code:\npython Copy code class Viewport: def init(self, buffer=Buffer()): self.buffer = buffer self.offset = 0\ndef get_char_at(self, index): return self.buffer[self.offset + index] def append(self, text): self.buffer += text Console Class (Facade):\nPurpose: Provides a high-level interface for interacting with the system by internally managing a buffer and viewport. It also exposes some lower-level functionality for advanced users. Attributes: buffers: A list to manage multiple Buffer objects. viewports: A list to manage multiple Viewport objects. current_viewport: The active Viewport being used by the console. Methods: write(text): High-level method that writes text to the current buffer via the viewport. get_char_at(index): Low-level method that allows the user to directly access characters in the buffer. Code:\npython Copy code class Console: def init(self): b = Buffer() self.current_viewport = Viewport(b) self.buffers = [b] self.viewports = [self.current_viewport]\n# High-level method def write(self, text): self.current_viewport.buffer.write(text) # Low-level method def get_char_at(self, index): return self.current_viewport.get_char_at(index) Usage Example:\nThe console can be used for both high-level operations (e.g., writing to the buffer) and low-level operations (e.g., retrieving characters from the buffer). Code:\npython Copy code if name == ‘main’: c = Console() c.write(‘hello’) # High-level write ch = c.get_char_at(0) # Low-level character access print(ch) # Output: ‘h’ Key Concepts: High-Level API: Provides a simple interface for common tasks, such as writing to the console, without requiring knowledge of the underlying structure (write method in Console). Low-Level API: Exposes detailed functionality for advanced users, allowing direct manipulation of buffer and viewport objects (get_char_at method in Console). Buffer and Viewport: Handle the complexity of managing text and presenting it in specific areas of the console. Multifunctional Facade: The Console class serves as both a simplified and powerful interface, providing flexibility for different user requirements.\nFlyweight Pattern This documentation explains the implementation of the Flyweight Design Pattern, a space optimization technique used to minimize memory consumption in scenarios where multiple objects share similar data. By externalizing and reusing common data, the Flyweight Pattern ensures that only a small number of objects are instantiated, reducing redundancy and optimizing resource usage.\nProblem Statement The goal is to prevent redundant memory usage when storing common or repetitive data across multiple objects. For example, in a massively multiplayer online game or a text editor, many users may have similar names, and it would be inefficient to store identical or similar strings repeatedly.\nTo address this, the Flyweight Pattern externalizes the common data and stores references to it, rather than storing the data directly in each object.\nExample Scenario Consider a system where 10,000 users are created, and each user has a first and last name. Without optimization, the system would store each full name as a unique string, resulting in significant memory overhead. Even though there are only 200 unique first and last names (100 first names and 100 last names), the traditional approach leads to the storage of 10,000 full names.\nThe Flyweight Pattern reduces memory usage by storing only 200 unique strings and referencing them via indices, rather than duplicating the full names for each user.\nImplementation The following implementation demonstrates the Flyweight Design Pattern using Python:\nUser Class (Inefficient Implementation): This class stores the full name of each user as a single string. Memory consumption increases with each new user, even if the first and last names are identical. python Copy code class User: def init(self, name): self.name = name User2 Class (Flyweight Implementation): This class optimizes memory usage by storing first and last names externally in a static list (strings) and referencing them via indices. When a user object is created, the first and last names are split, and their indices are stored instead of the actual strings. The get_or_add function checks if the name is already stored. If it is, it returns the index; otherwise, it adds the name to the list and returns the new index. The str method reconstructs the full name by concatenating the indexed first and last names from the static list. python Copy code class User2: strings = []\ndef __init__(self, full_name): def get_or_add(s): if s in self.strings: return self.strings.index(s) else: self.strings.append(s) return len(self.strings)-1 self.names = [get_or_add(x) for x in full_name.split(' ')] def __str__(self): return ' '.join([self.strings[x] for x in self.names]) Random Name Generation: A function random_string is used to generate random first and last names of length 8, simulating user names for the purpose of the experiment. python Copy code def random_string(): chars = string.ascii_lowercase return ‘’.join([random.choice(chars) for x in range(8)]) Main Program: The program creates 10,000 users using the inefficient User class and then optimizes memory usage by switching to the User2 class, which utilizes the Flyweight Pattern. python Copy code if name == ‘main’: users = []\nfirst_names = [random_string() for x in range(100)] last_names = [random_string() for x in range(100)] for first in first_names: for last in last_names: users.append(User(f'{first} {last}')) u2 = User2('Jim Jones') u3 = User2('Frank Jones') print(u2.names) print(u3.names) print(User2.strings) users2 = [] for first in first_names: for last in last_names: users2.append(User2(f'{first} {last}')) Benefits of Flyweight Pattern Memory Optimization: Instead of creating new strings for each user, the Flyweight Pattern reuses existing strings by referencing them via indices. This reduces memory consumption significantly. Efficient Storage: Only 200 unique strings are stored, regardless of the number of users. The full names are reconstructed dynamically when needed, saving memory and reducing overhead. Example Output The code first prints the indices corresponding to the first and last names for two users: ‘Jim Jones’ and ‘Frank Jones’. It also prints the shared static list of unique strings (User2.strings), which stores the first and last names. This approach demonstrates how the Flyweight Pattern effectively reduces redundant memory usage in scenarios with repetitive data.\nText Formatting Example Overview This document demonstrates the implementation of the Flyweight Design Pattern for text formatting, showcasing memory optimization in cases where only specific portions of text require formatting. The solution compares a naive approach to text formatting with a more efficient implementation using the Flyweight pattern.\nProblem Statement When formatting large amounts of text, such as capitalizing certain letters or words, allocating resources for each character in the text can become inefficient, especially when only a small subset of the text needs formatting.\nFor example, in a naive implementation, formatting operations (e.g., capitalizing letters) are applied using an array of boolean values to track whether each character in the text should be capitalized. This approach consumes unnecessary memory when formatting operations are sparse across large texts.\nThe Flyweight pattern offers an optimized solution by sharing the formatting information across text segments, reducing memory usage.\nNaive Approach FormattedText Class Purpose: A simple approach to formatting text, where a boolean array tracks which characters need to be capitalized. Initialization: Takes a string of plain text as input and creates an array of booleans (caps), initialized to False. Capitalization: Uses the capitalize() method to update the boolean array for characters within the specified range. String Representation: The str() method checks the boolean array when generating the final formatted string. Code:\npython Copy code class FormattedText: def init(self, plain_text): self.plain_text = plain_text self.caps = [False] * len(plain_text)\ndef capitalize(self, start, end): for i in range(start, end): self.caps[i] = True def __str__(self): result = [] for i in range(len(self.plain_text)): c = self.plain_text[i] result.append(c.upper() if self.caps[i] else c) return ''.join(result) Example Usage: python Copy code ft = FormattedText(‘This is a brave new world’) ft.capitalize(10, 15) print(ft) Output:\ncsharp Copy code This is a BRAVE new world Optimized Approach with Flyweight Pattern BetterFormattedText Class Purpose: Optimizes memory usage by applying formatting only to the specified ranges of text, using the Flyweight pattern. TextRange (Flyweight Class): Defines a range of text positions and tracks whether characters in the range should be capitalized, bold, italicized, etc. Flyweight Management: The get_range() method creates and returns TextRange objects that define formatting operations on specific segments of the text, which are then stored in a formatting list. String Representation: The str() method processes each character and checks if it falls within a TextRange that requires formatting. Code:\npython Copy code class BetterFormattedText: def init(self, plain_text): self.plain_text = plain_text self.formatting = []\nclass TextRange: def __init__(self, start, end, capitalize=False, bold=False, italic=False): self.start = start self.end = end self.capitalize = capitalize def covers(self, position): return self.start \u003c= position \u003c= self.end def get_range(self, start, end): range = self.TextRange(start, end) self.formatting.append(range) return range def __str__(self): result = [] for i in range(len(self.plain_text)): c = self.plain_text[i] for r in self.formatting: if r.covers(i) and r.capitalize: c = c.upper() result.append(c) return ''.join(result) Example Usage: python Copy code bft = BetterFormattedText(‘This is a brave new world’) bft.get_range(16, 19).capitalize = True print(bft) Output:\nvbnet Copy code This is a brave NEW world Key Differences Memory Usage: The naive approach (FormattedText) allocates a boolean array with the same length as the text, which can be inefficient for large texts with sparse formatting. The optimized approach (BetterFormattedText) only stores formatting data for specific ranges, reducing memory consumption. Flyweight Design: By utilizing TextRange objects, the Flyweight pattern ensures that formatting information is shared across text segments and not unnecessarily duplicated.\nProxy Design Pattern Overview The Proxy Design Pattern is a structural design pattern that provides an interface to another object while controlling access to it. Proxies can serve various purposes, such as controlling access, managing resource allocation, or adding additional functionality to an object without altering its interface.\nTypes of Proxies Communication Proxy: Facilitates communication between objects that may be in different processes or environments, abstracting the complexities involved in remote method invocations.\nLogging Proxy: Adds logging capabilities to track method calls and interactions with the underlying object.\nVirtual Proxy: Delays the initialization of an object until it’s actually needed, thereby saving resources and improving performance.\nProtection Proxy: Controls access to the object based on certain criteria or conditions, often used for security and access control.\nExamples\nProtection Proxy Scenario: A Car class with a method drive should only allow drivers above a certain age to drive. Implementation:\nCar: Represents the real object with a method drive. CarProxy: Acts as a proxy to the Car class, adding access control to the drive method based on the driver’s age. Code:\npython Copy code class Car: def init(self, driver): self.driver = driver\ndef drive(self): print(f'Car being driven by {self.driver.name}') class CarProxy: def init(self, driver): self.driver = driver self.car = Car(driver)\ndef drive(self): if self.driver.age \u003e= 16: self.car.drive() else: print('Driver too young') class Driver: def init(self, name, age): self.name = name self.age = age\nif name == ‘main’: car = CarProxy(Driver(‘John’, 12)) car.drive() Explanation: The CarProxy class restricts access to the Car’s drive method based on the driver’s age, ensuring that only eligible drivers can operate the car.\nVirtual Proxy Scenario: A Bitmap class that loads an image from a file but should delay this loading until the image is actually needed. Implementation:\nBitmap: Represents the real object that performs expensive operations like loading an image from disk. LazyBitmap: A proxy that defers the creation of a Bitmap object until its draw method is called. Code:\npython Copy code class Bitmap: def init(self, filename): self.filename = filename print(f’Loading image from {filename}’)\ndef draw(self): print(f'Drawing image {self.filename}') class LazyBitmap: def init(self, filename): self.filename = filename self.bitmap = None\ndef draw(self): if not self.bitmap: self.bitmap = Bitmap(self.filename) self.bitmap.draw() def draw_image(image): print(‘About to draw image’) image.draw() print(‘Done drawing image’)\nif name == ‘main’: bmp = LazyBitmap(‘facepalm.jpg’) draw_image(bmp) Explanation: The LazyBitmap class only initializes the Bitmap object when it is needed (i.e., when draw is called), avoiding the overhead of loading the image until it is actually used.\nProxy vs Decorator Design Patterns Both the Proxy and Decorator Design Patterns are structural patterns that can appear similar but serve different purposes and exhibit distinct behaviors.\nSummary of Differences Interface Handling: A proxy provides the same interface as the object it proxies, while a decorator may provide an enhanced or extended interface. Object Handling: A proxy can manage objects that are not yet constructed, implementing lazy initialization. A decorator, on the other hand, works with an already constructed object and adds new behavior. Functionality: The proxy’s primary role is to control access or manage resource usage, whereas the decorator focuses on adding new functionalities or operations. In essence, while both patterns involve wrapping or acting as intermediaries for objects, the Proxy Pattern is more about controlling access or managing resource use, and the Decorator Pattern is about dynamically extending an object’s capabilities.\nCitations The following notes is curated from\nChatGPT Udemy: Design Patterns in Python - Dmitri Nesteruk Udemy: Design Patterns in Java - Dmitri Nesteruk Udemy: SOLID Principles: Introducing Software Architecture \u0026 Design by George S ","wordCount":"8909","inLanguage":"en","image":"https://raghu-vijaykumar.github.io/blog/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-08-24T05:54:50Z","dateModified":"2024-08-24T05:54:50Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://raghu-vijaykumar.github.io/blog/docs/system-design/design-patterns/readme/"},"publisher":{"@type":"Organization","name":"Raghu Vijaykumar","logo":{"@type":"ImageObject","url":"https://raghu-vijaykumar.github.io/blog/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://raghu-vijaykumar.github.io/blog/ accesskey=h title="Raghu Vijaykumar (Alt + H)"><img src=https://raghu-vijaykumar.github.io/apple-touch-icon.png alt aria-label=logo height=35>Raghu Vijaykumar</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://raghu-vijaykumar.github.io/blog/about/ title=about><span>about</span></a></li><li><a href=https://raghu-vijaykumar.github.io/blog/docs/ title=docs><span>docs</span></a></li><li><a href=https://raghu-vijaykumar.github.io/blog/posts/ title=posts><span>posts</span></a></li><li><a href=https://raghu-vijaykumar.github.io/blog/sponsor/ title=sponsor><span>sponsor</span></a></li><li><a href=https://raghu-vijaykumar.github.io/blog/tags/ title=tags><span>tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://raghu-vijaykumar.github.io/blog/>Home</a>&nbsp;»&nbsp;<a href=https://raghu-vijaykumar.github.io/blog/docs/>Docs</a></div><h1 class="post-title entry-hint-parent">Design Patterns</h1><div class=post-meta><span title='2024-08-24 05:54:50.01107042 +0000 UTC'>August 24, 2024</span>&nbsp;·&nbsp;42 min&nbsp;·&nbsp;8909 words&nbsp;·&nbsp;Me</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#design-patterns>Design Patterns</a><ul><li><a href=#gamma-categorization>Gamma Categorization</a></li></ul></li></ul><ul><li><a href=#factory-method-and-factory-class-implementation>Factory Method and Factory Class Implementation</a><ul><li><a href=#factory-method-pattern>Factory Method Pattern</a></li><li><a href=#factory-class-pattern>Factory Class Pattern</a></li></ul></li><li><a href=#abstract-factory-design-pattern-implementation>Abstract Factory Design Pattern Implementation</a><ul><li><a href=#step-by-step-implementation>Step-by-Step Implementation</a></li><li><a href=#key-concepts>Key Concepts</a></li></ul></li></ul><ul><li><a href=#motivation>Motivation</a></li><li><a href=#key-concepts-1>Key Concepts</a></li><li><a href=#example-implementation-in-python>Example Implementation in Python</a><ul><li><a href=#usage-1>Usage</a></li></ul></li><li><a href=#benefits-of-the-prototype-pattern>Benefits of the Prototype Pattern</a></li></ul><ul><li><a href=#motivation-1>Motivation</a></li><li><a href=#key-concepts-2>Key Concepts</a></li><li><a href=#example-implementation-in-python-1>Example Implementation in Python</a><ul><li><a href=#usage-2>Usage</a></li><li><a href=#potential-issues>Potential Issues</a></li></ul></li><li><a href=#benefits-of-the-singleton-pattern>Benefits of the Singleton Pattern</a></li><li><a href=#singleton-using-a-decorator>Singleton Using a Decorator</a></li><li><a href=#singleton-using-a-metaclass>Singleton Using a Metaclass</a></li><li><a href=#monostate-borg-singleton-pattern>Monostate (Borg) Singleton Pattern</a></li><li><a href=#singleton-testing>Singleton Testing</a></li></ul><ul><li><a href=#problem-statement-2>Problem Statement</a></li><li><a href=#real-world-analogy>Real-World Analogy</a></li><li><a href=#example-implementation>Example Implementation</a></li><li><a href=#implementing-a-cache>Implementing a Cache</a><ul><li><a href=#steps-in-the-cache-implementation>Steps in the Cache Implementation:</a></li></ul></li></ul><ul><li><a href=#code-structure>Code Structure</a></li><li><a href=#code-example>Code Example</a></li><li><a href=#usage-3>Usage</a></li><li><a href=#advantages>Advantages</a></li><li><a href=#limitations>Limitations</a></li></ul><ul><li><a href=#motivation-2>Motivation</a></li><li><a href=#implementation>Implementation</a><ul><li><a href=#base-class>Base Class</a></li><li><a href=#concrete-classes>Concrete Classes</a></li><li><a href=#example-usage>Example Usage</a></li><li><a href=#output>Output</a></li></ul></li><li><a href=#neural-network-example>Neural Network Example</a><ul><li><a href=#key-components>Key Components</a></li><li><a href=#example-usage-1>Example Usage</a></li></ul></li></ul><ul><li><a href=#motivation-3>Motivation</a></li><li><a href=#implementation-1>Implementation</a><ul><li><a href=#python-specific-implementation>Python-Specific Implementation</a></li><li><a href=#key-points>Key Points</a></li></ul></li><li><a href=#classic-implementation-of-decorator-pattern-in-object-oriented-programming>Classic Implementation of Decorator Pattern in Object-Oriented Programming</a><ul><li><a href=#motivation-4>Motivation</a></li><li><a href=#implementation-2>Implementation</a></li><li><a href=#explanation-2>Explanation</a></li><li><a href=#key-points-1>Key Points</a></li><li><a href=#limitations-1>Limitations</a></li></ul></li><li><a href=#file-decorator-implementation-with-logging>File Decorator Implementation with Logging</a><ul><li><a href=#class-filewithlogging>Class: FileWithLogging</a></li><li><a href=#example-usage-2>Example Usage:</a></li></ul></li></ul><ul><li><a href=#proxy-vs-decorator-design-patterns>Proxy vs Decorator Design Patterns</a><ul><li><a href=#summary-of-differences>Summary of Differences</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=design-patterns>Design Patterns<a hidden class=anchor aria-hidden=true href=#design-patterns>#</a></h2><p>Before we get to the design patterns themselves, there is just one more piece of housekeeping that I wanted to mention, and that is to do with the so-called Gamma categorization.</p><p>Typically, in design pattern literature, regardless of which language of design patterns we are talking about, we split all the design patterns into several different categories. These categories are often called Gamma categorization, named after Erich Gamma, one of the authors of the original Gang of Four book that uses C++ and Smalltalk.</p><h3 id=gamma-categorization>Gamma Categorization<a hidden class=anchor aria-hidden=true href=#gamma-categorization>#</a></h3><ol><li><p><strong>Creational Patterns</strong></p><ul><li>These patterns deal with the creation or construction of objects.</li><li>Object construction can be more complicated than simply invoking a constructor.</li><li><strong>Explicit Creation</strong>: Directly calling the constructor with arguments to initialize an object.</li><li><strong>Implicit Creation</strong>: Using mechanisms like dependency injection frameworks or reflection to create objects behind the scenes.</li><li><strong>Wholesale Creation</strong>: A single statement or constructor call is sufficient to initialize the object.</li><li><strong>Piecewise Initialization</strong>: Several steps or statements are needed to fully initialize an object.</li></ul></li><li><p><strong>Structural Patterns</strong></p><ul><li>Concerned with the structure of classes and their members.</li><li>Focus on how classes and objects are composed to form larger structures.</li><li>Examples include wrappers that mimic the underlying interface they wrap.</li><li>Emphasize good API design, making interfaces convenient and usable for others.</li><li>Structural patterns often involve replicating or enhancing interfaces for better usability.</li></ul></li><li><p><strong>Behavioral Patterns</strong></p><ul><li>Unlike creational and structural patterns, behavioral patterns don&rsquo;t follow a central theme.</li><li>They address different problems and solve them in unique ways using various object-oriented mechanisms.</li><li>There may be some overlap (e.g., Strategy and Template Method patterns), but each pattern generally solves a specific problem with its own approach.</li><li>Behavioral patterns focus on the interaction and responsibility of objects.</li></ul></li></ol><h1 id=factory-pattern>Factory Pattern<a hidden class=anchor aria-hidden=true href=#factory-pattern>#</a></h1><h2 id=factory-method-and-factory-class-implementation>Factory Method and Factory Class Implementation<a hidden class=anchor aria-hidden=true href=#factory-method-and-factory-class-implementation>#</a></h2><p>The Factory Method and the Factory Class design patterns, which are essential for creating objects in a way that is both flexible and adheres to object-oriented principles like the Single Responsibility Principle and Open/Closed Principle.</p><p>The discussion begins by introducing a simple Point class and evolves into explaining how to initialize points using both Cartesian and Polar coordinates while maintaining clean and understandable code.</p><h3 id=factory-method-pattern>Factory Method Pattern<a hidden class=anchor aria-hidden=true href=#factory-method-pattern>#</a></h3><p>The Factory Method is a design pattern that provides an alternative to using constructors (initializers) directly for object creation. It allows for the creation of objects without specifying the exact class of the object that will be created.</p><h4 id=problem-statement>Problem Statement:<a hidden class=anchor aria-hidden=true href=#problem-statement>#</a></h4><p>Initially, the Point class is designed to accept Cartesian coordinates (x, y). However, if we want to add support for polar coordinates (rho, theta), we encounter issues:</p><ul><li>Redefining the constructor for different coordinate systems isn’t possible.</li><li>Expanding the constructor to handle multiple coordinate systems can lead to cluttered and complex code, breaking the Single Responsibility Principle.</li></ul><h4 id=solution>Solution:<a hidden class=anchor aria-hidden=true href=#solution>#</a></h4><p>Instead of overloading or expanding the constructor, we can create factory methods:</p><ul><li>Factory methods are static methods that handle the creation of objects with different initialization requirements.</li><li>These methods clearly indicate the type of initialization (Cartesian or Polar) and keep the initialization logic encapsulated.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>enum</span> <span class=kn>import</span> <span class=n>Enum</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>math</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CoordinateSystem</span><span class=p>(</span><span class=n>Enum</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>CARTESIAN</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>POLAR</span> <span class=o>=</span> <span class=mi>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Point</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>a</span><span class=p>,</span> <span class=n>b</span><span class=p>,</span> <span class=n>system</span><span class=o>=</span><span class=n>CoordinateSystem</span><span class=o>.</span><span class=n>CARTESIAN</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>system</span> <span class=o>==</span> <span class=n>CoordinateSystem</span><span class=o>.</span><span class=n>CARTESIAN</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>=</span> <span class=n>a</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>y</span> <span class=o>=</span> <span class=n>b</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>system</span> <span class=o>==</span> <span class=n>CoordinateSystem</span><span class=o>.</span><span class=n>POLAR</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>=</span> <span class=n>a</span> <span class=o>*</span> <span class=n>sin</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>y</span> <span class=o>=</span> <span class=n>a</span> <span class=o>*</span> <span class=n>cos</span><span class=p>(</span><span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;x: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>x</span><span class=si>}</span><span class=s1>, y: </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>y</span><span class=si>}</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>new_cartesian_point</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Point</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>new_polar_point</span><span class=p>(</span><span class=n>rho</span><span class=p>,</span> <span class=n>theta</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Point</span><span class=p>(</span><span class=n>rho</span> <span class=o>*</span> <span class=n>sin</span><span class=p>(</span><span class=n>theta</span><span class=p>),</span> <span class=n>rho</span> <span class=o>*</span> <span class=n>cos</span><span class=p>(</span><span class=n>theta</span><span class=p>))</span>
</span></span></code></pre></div><p>In this implementation: new_cartesian_point(x, y) and new_polar_point(rho, theta) are static factory methods that create a Point object based on the coordinate system.</p><h3 id=factory-class-pattern>Factory Class Pattern<a hidden class=anchor aria-hidden=true href=#factory-class-pattern>#</a></h3><p>A Factory Class centralizes the creation logic of related objects. When a class starts accumulating too many factory methods, it&rsquo;s often a good idea to move these methods into a separate class.</p><h4 id=problem-statement-1>Problem Statement<a hidden class=anchor aria-hidden=true href=#problem-statement-1>#</a></h4><p>As the number of factory methods grows, the Point class might become cluttered. This violates the Single Responsibility Principle as the class is handling both the creation and representation of points.</p><h4 id=solution-1>Solution<a hidden class=anchor aria-hidden=true href=#solution-1>#</a></h4><p>Extract the factory methods into a separate PointFactory class:</p><ul><li>This class will be responsible for the creation of Point objects.</li><li>This separation ensures that the Point class only focuses on representing a point, while the factory handles object creation.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>PointFactory</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>new_cartesian_point</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Point</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>new_polar_point</span><span class=p>(</span><span class=n>rho</span><span class=p>,</span> <span class=n>theta</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Point</span><span class=p>(</span><span class=n>rho</span> <span class=o>*</span> <span class=n>sin</span><span class=p>(</span><span class=n>theta</span><span class=p>),</span> <span class=n>rho</span> <span class=o>*</span> <span class=n>cos</span><span class=p>(</span><span class=n>theta</span><span class=p>))</span>
</span></span></code></pre></div><p>In the PointFactory class: new_cartesian_point(x, y) and new_polar_point(rho, theta) methods are moved here, separating concerns.</p><h4 id=usage>Usage<a hidden class=anchor aria-hidden=true href=#usage>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>p1</span> <span class=o>=</span> <span class=n>Point</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>CoordinateSystem</span><span class=o>.</span><span class=n>CARTESIAN</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p2</span> <span class=o>=</span> <span class=n>PointFactory</span><span class=o>.</span><span class=n>new_cartesian_point</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p3</span> <span class=o>=</span> <span class=n>Point</span><span class=o>.</span><span class=n>Factory</span><span class=o>.</span><span class=n>new_cartesian_point</span><span class=p>(</span><span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>  <span class=c1># Using nested factory class</span>
</span></span><span class=line><span class=cl>    <span class=n>p4</span> <span class=o>=</span> <span class=n>Point</span><span class=o>.</span><span class=n>factory</span><span class=o>.</span><span class=n>new_cartesian_point</span><span class=p>(</span><span class=mi>7</span><span class=p>,</span> <span class=mi>8</span><span class=p>)</span>  <span class=c1># Singleton factory instance</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>p1</span><span class=p>,</span> <span class=n>p2</span><span class=p>,</span> <span class=n>p3</span><span class=p>,</span> <span class=n>p4</span><span class=p>)</span>
</span></span></code></pre></div><p>In this example:</p><ul><li>PointFactory.new_cartesian_point(1, 2) creates a Cartesian point using the factory class.</li><li>Point.factory.new_cartesian_point(7, 8) demonstrates using a singleton factory instance.</li></ul><h2 id=abstract-factory-design-pattern-implementation>Abstract Factory Design Pattern Implementation<a hidden class=anchor aria-hidden=true href=#abstract-factory-design-pattern-implementation>#</a></h2><p>The abstract factory design pattern allows for the creation of families of related objects without specifying their concrete classes. This implementation demonstrates how to use abstract factories to create different types of drinks (e.g., tea and coffee) using a vending machine scenario.</p><h3 id=step-by-step-implementation>Step-by-Step Implementation<a hidden class=anchor aria-hidden=true href=#step-by-step-implementation>#</a></h3><ul><li><strong>HotDrink Abstract Base Class</strong>: An abstract base class HotDrink is defined with an abstract method consume. Concrete drink classes (e.g., Tea, Coffee) inherit from this base class and implement the consume method.</li><li><strong>Concrete Drink Classes</strong>: Two concrete classes, Tea and Coffee, inherit from HotDrink and provide specific implementations of the consume method.</li><li><strong>HotDrinkFactory Abstract Base Class</strong>: An abstract base class HotDrinkFactory is defined with a method prepare. This method is meant to be overridden by concrete factory classes to prepare specific types of drinks.</li><li><strong>Concrete Factory Classes</strong>: Two concrete factory classes, TeaFactory and CoffeeFactory, inherit from HotDrinkFactory. These classes implement the prepare method to create instances of Tea and Coffee, respectively.</li><li><strong>HotDrinkMachine Class</strong>: The HotDrinkMachine class simulates a vending machine that can prepare different types of drinks. It uses an enumeration AvailableDrink to list available drink types. The machine maintains a list of factory instances for each drink type.</li><li><strong>Drink Preparation</strong>: The make_drink method in HotDrinkMachine allows the user to select a drink type and specify the amount. The corresponding factory prepares the drink, and the consume method is called to simulate drinking it.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>abc</span> <span class=kn>import</span> <span class=n>ABC</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>enum</span> <span class=kn>import</span> <span class=n>Enum</span><span class=p>,</span> <span class=n>auto</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Abstract base class for drinks</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>HotDrink</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>consume</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Concrete drink classes</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Tea</span><span class=p>(</span><span class=n>HotDrink</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>consume</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;This tea is nice but I</span><span class=se>\&#39;</span><span class=s1>d prefer it with milk&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Coffee</span><span class=p>(</span><span class=n>HotDrink</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>consume</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;This coffee is delicious&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Abstract base class for drink factories</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>HotDrinkFactory</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>prepare</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>amount</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Concrete factory classes</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TeaFactory</span><span class=p>(</span><span class=n>HotDrinkFactory</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>prepare</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>amount</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Put in tea bag, boil water, pour </span><span class=si>{</span><span class=n>amount</span><span class=si>}</span><span class=s1>ml, enjoy!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Tea</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CoffeeFactory</span><span class=p>(</span><span class=n>HotDrinkFactory</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>prepare</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>amount</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Grind some beans, boil water, pour </span><span class=si>{</span><span class=n>amount</span><span class=si>}</span><span class=s1>ml, enjoy!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>Coffee</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Vending machine class for preparing drinks</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>HotDrinkMachine</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>class</span> <span class=nc>AvailableDrink</span><span class=p>(</span><span class=n>Enum</span><span class=p>):</span>  <span class=c1># Lists available drinks</span>
</span></span><span class=line><span class=cl>        <span class=n>COFFEE</span> <span class=o>=</span> <span class=n>auto</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>TEA</span> <span class=o>=</span> <span class=n>auto</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>factories</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>initialized</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>self</span><span class=o>.</span><span class=n>initialized</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>initialized</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>d</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>AvailableDrink</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>name</span> <span class=o>=</span> <span class=n>d</span><span class=o>.</span><span class=n>name</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>+</span> <span class=n>d</span><span class=o>.</span><span class=n>name</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=n>factory_name</span> <span class=o>=</span> <span class=n>name</span> <span class=o>+</span> <span class=s1>&#39;Factory&#39;</span>
</span></span><span class=line><span class=cl>                <span class=n>factory_instance</span> <span class=o>=</span> <span class=nb>eval</span><span class=p>(</span><span class=n>factory_name</span><span class=p>)()</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>factories</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>name</span><span class=p>,</span> <span class=n>factory_instance</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>make_drink</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Available drinks:&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>f</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>factories</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>f</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Please pick drink (0-</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>factories</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=si>}</span><span class=s1>): &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>idx</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Specify amount: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>amount</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>factories</span><span class=p>[</span><span class=n>idx</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>prepare</span><span class=p>(</span><span class=n>amount</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Standalone function to prepare drinks</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>make_drink</span><span class=p>(</span><span class=nb>type</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>type</span> <span class=o>==</span> <span class=s1>&#39;tea&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>TeaFactory</span><span class=p>()</span><span class=o>.</span><span class=n>prepare</span><span class=p>(</span><span class=mi>200</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=nb>type</span> <span class=o>==</span> <span class=s1>&#39;coffee&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>CoffeeFactory</span><span class=p>()</span><span class=o>.</span><span class=n>prepare</span><span class=p>(</span><span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Main function to demonstrate the vending machine</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>hdm</span> <span class=o>=</span> <span class=n>HotDrinkMachine</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>drink</span> <span class=o>=</span> <span class=n>hdm</span><span class=o>.</span><span class=n>make_drink</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>drink</span><span class=o>.</span><span class=n>consume</span><span class=p>()</span>
</span></span></code></pre></div><h3 id=key-concepts>Key Concepts<a hidden class=anchor aria-hidden=true href=#key-concepts>#</a></h3><ul><li>Abstract Base Classes (ABC): Used to define a common interface for a group of related objects.</li><li>Concrete Implementations: Specific classes that implement the abstract methods defined in the base classes.</li><li>Factory Pattern: A design pattern used to create objects without specifying the exact class of the object that will be created.</li><li>Duck Typing: Python&rsquo;s dynamic typing feature where the type of an object is determined by its behavior (methods and properties) rather than its inheritance from a specific class.</li></ul><p>This pattern is particularly useful in scenarios where you need to create families of related objects and want to ensure that the objects are created in a consistent manner.</p><h1 id=prototype-design-pattern>Prototype Design Pattern<a hidden class=anchor aria-hidden=true href=#prototype-design-pattern>#</a></h1><p>The prototype design pattern is a creational design pattern that allows an object to be cloned, creating new instances by copying an existing object, known as the prototype. This pattern is particularly useful when creating a new object from scratch is resource-intensive or when an object should be replicated with slight modifications.</p><h2 id=motivation>Motivation<a hidden class=anchor aria-hidden=true href=#motivation>#</a></h2><p>In many real-world scenarios, objects are not designed from scratch but are built upon existing designs. The prototype pattern follows this approach by allowing an existing object to be duplicated and then customized without affecting the original object. This is especially useful when the construction of objects is complex or resource-heavy.</p><h2 id=key-concepts-1>Key Concepts<a hidden class=anchor aria-hidden=true href=#key-concepts-1>#</a></h2><p>Prototype: The original object that will be copied.</p><ul><li>Cloning: Creating a new instance by copying the prototype.</li><li>Deep Copy: A type of copy where all attributes of the object are recursively copied, ensuring that the new object does not reference the same attributes as the original.</li><li>Shallow Copy: A type of copy where only the object&rsquo;s references are copied, meaning that both the original and the copied object share the same references.</li></ul><h2 id=example-implementation-in-python>Example Implementation in Python<a hidden class=anchor aria-hidden=true href=#example-implementation-in-python>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>copy</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Address</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>street_address</span><span class=p>,</span> <span class=n>city</span><span class=p>,</span> <span class=n>country</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>country</span> <span class=o>=</span> <span class=n>country</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>city</span> <span class=o>=</span> <span class=n>city</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>street_address</span> <span class=o>=</span> <span class=n>street_address</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>street_address</span><span class=si>}</span><span class=s1>, </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>city</span><span class=si>}</span><span class=s1>, </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>country</span><span class=si>}</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Person</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>,</span> <span class=n>address</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>address</span> <span class=o>=</span> <span class=n>address</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1> lives at </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>address</span><span class=si>}</span><span class=s1>&#39;</span>
</span></span></code></pre></div><h3 id=usage-1>Usage<a hidden class=anchor aria-hidden=true href=#usage-1>#</a></h3><p>Creating a Prototype:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>john</span> <span class=o>=</span> <span class=n>Person</span><span class=p>(</span><span class=s2>&#34;John&#34;</span><span class=p>,</span> <span class=n>Address</span><span class=p>(</span><span class=s2>&#34;123 London Road&#34;</span><span class=p>,</span> <span class=s2>&#34;London&#34;</span><span class=p>,</span> <span class=s2>&#34;UK&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>john</span><span class=p>)</span>
</span></span></code></pre></div><p>Cloning with Deep Copy:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>jane</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>deepcopy</span><span class=p>(</span><span class=n>john</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>jane</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s2>&#34;Jane&#34;</span>
</span></span><span class=line><span class=cl><span class=n>jane</span><span class=o>.</span><span class=n>address</span><span class=o>.</span><span class=n>street_address</span> <span class=o>=</span> <span class=s2>&#34;124 London Road&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>john</span><span class=p>,</span> <span class=n>jane</span><span class=p>)</span>
</span></span></code></pre></div><p>Output</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>John lives at <span class=m>123</span> London Road, London, UK
</span></span><span class=line><span class=cl>John lives at <span class=m>123</span> London Road, London, UK Jane lives at <span class=m>124</span> London Road, London, UK
</span></span></code></pre></div><p>In this example, jane is created as a deep copy of john. This means jane has the same initial properties as john, but changes to jane do not affect john.</p><p>Shallow Copy Example (Not Recommended for This Case):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>jane</span> <span class=o>=</span> <span class=n>copy</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=n>john</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>jane</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s2>&#34;Jane&#34;</span>
</span></span><span class=line><span class=cl><span class=n>jane</span><span class=o>.</span><span class=n>address</span><span class=o>.</span><span class=n>street_address</span> <span class=o>=</span> <span class=s2>&#34;124 London Road&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>john</span><span class=p>,</span> <span class=n>jane</span><span class=p>)</span>
</span></span></code></pre></div><p>Output</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>John lives at <span class=m>124</span> London Road, London, UK Jane lives at <span class=m>124</span> London Road, London, UK
</span></span></code></pre></div><h2 id=benefits-of-the-prototype-pattern>Benefits of the Prototype Pattern<a hidden class=anchor aria-hidden=true href=#benefits-of-the-prototype-pattern>#</a></h2><ul><li>Efficiency: Reduces the overhead of creating complex objects from scratch.</li><li>Flexibility: Allows the creation of new objects by varying the state of the existing objects.</li><li>Decoupling: Clients are decoupled from the specific classes they are using, as they interact with the prototype instead of directly with the class.</li></ul><h1 id=singleton-design-pattern>Singleton Design Pattern<a hidden class=anchor aria-hidden=true href=#singleton-design-pattern>#</a></h1><p>The singleton design pattern ensures that a class has only one instance and provides a global point of access to that instance. This pattern is often used when exactly one object is needed to coordinate actions across the system, such as when managing shared resources like databases or configuration settings.</p><h2 id=motivation-1>Motivation<a hidden class=anchor aria-hidden=true href=#motivation-1>#</a></h2><p>The singleton pattern is motivated by scenarios where certain classes should only be instantiated once. Common examples include:</p><ul><li>Database Connections: You typically only want one instance of a database connection throughout the lifecycle of an application to avoid redundant connections and ensure consistent access to the data.</li><li>Object Factories: An object factory is often stateless and doesn&rsquo;t require multiple instances, making a singleton a natural choice.</li></ul><p>The pattern is often criticized because its improper use can lead to design issues, such as hidden dependencies and difficulties in testing. However, when used appropriately, it can be a powerful tool for managing global state.</p><h2 id=key-concepts-2>Key Concepts<a hidden class=anchor aria-hidden=true href=#key-concepts-2>#</a></h2><p>Single Instance: The singleton pattern restricts the instantiation of a class to one &ldquo;single&rdquo; instance.</p><ul><li>Global Access: Provides a global point of access to that instance.</li><li>Lazy Instantiation: The singleton instance is created only when it is actually needed, rather than at the time of application startup.</li></ul><h2 id=example-implementation-in-python-1>Example Implementation in Python<a hidden class=anchor aria-hidden=true href=#example-implementation-in-python-1>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Database</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>initialized</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Initialization logic (e.g., loading a database) would go here.</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>_instance</span> <span class=o>=</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_instance</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>cls</span><span class=o>.</span><span class=n>_instance</span> <span class=o>=</span> <span class=nb>super</span><span class=p>(</span><span class=n>Database</span><span class=p>,</span> <span class=bp>cls</span><span class=p>)</span><span class=o>.</span><span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_instance</span>
</span></span></code></pre></div><h3 id=usage-2>Usage<a hidden class=anchor aria-hidden=true href=#usage-2>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># Creating the Singleton Instance</span>
</span></span><span class=line><span class=cl><span class=n>database</span> <span class=o>=</span> <span class=n>Database</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Verifying Singleton Behavior</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>d1</span> <span class=o>=</span> <span class=n>Database</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>d2</span> <span class=o>=</span> <span class=n>Database</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>d1</span> <span class=o>==</span> <span class=n>d2</span><span class=p>)</span>  <span class=c1># True, as both d1 and d2 refer to the same instance</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>database</span> <span class=o>==</span> <span class=n>d1</span><span class=p>)</span>  <span class=c1># True, database and d1 refer to the same instance</span>
</span></span></code></pre></div><ul><li>Overriding <strong>new</strong>: The <strong>new</strong> method is overridden to control the object allocation. If an instance already exists (_instance is not None), the existing instance is returned. If no instance exists, a new one is created and assigned to _instance.</li><li>Initialization (<strong>init</strong>): The <strong>init</strong> method is called every time an instance is created or accessed. In a singleton, this can cause issues if initialization logic (e.g., loading resources) is placed here. To avoid repeated initialization, consider adding a guard clause to prevent the execution of initialization logic if the instance is already initialized.</li></ul><h3 id=potential-issues>Potential Issues<a hidden class=anchor aria-hidden=true href=#potential-issues>#</a></h3><ul><li>Repeated Initialization: Even though the singleton ensures that only one instance of the class exists, the <strong>init</strong> method might still be called multiple times. This can be problematic if <strong>init</strong> performs expensive operations, like loading a database. One way to handle this is by adding an initialization flag.</li><li>Testing: Singletons can make unit testing challenging, as they introduce hidden dependencies. In testing, you may need to reset or mock the singleton instance to ensure tests are isolated from each other.</li></ul><h2 id=benefits-of-the-singleton-pattern>Benefits of the Singleton Pattern<a hidden class=anchor aria-hidden=true href=#benefits-of-the-singleton-pattern>#</a></h2><ul><li>Controlled Access: Ensures a class has only one instance, which is useful for resources like configuration settings or loggers.</li><li>Global State: Provides a global point of access to the instance, making it easy to share the instance across different parts of the application.</li></ul><h2 id=singleton-using-a-decorator>Singleton Using a Decorator<a hidden class=anchor aria-hidden=true href=#singleton-using-a-decorator>#</a></h2><p>A decorator can be used to implement the Singleton pattern by controlling the instantiation of a class and ensuring that only one instance of the class is ever created.</p><p>Code Example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>singleton</span><span class=p>(</span><span class=n>class_</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>instances</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_instance</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>class_</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>instances</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>instances</span><span class=p>[</span><span class=n>class_</span><span class=p>]</span> <span class=o>=</span> <span class=n>class_</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>instances</span><span class=p>[</span><span class=n>class_</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>get_instance</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@singleton</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Database</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Loading database&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>d1</span> <span class=o>=</span> <span class=n>Database</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>d2</span> <span class=o>=</span> <span class=n>Database</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>d1</span> <span class=o>==</span> <span class=n>d2</span><span class=p>)</span>  <span class=c1># True, indicating that d1 and d2 are the same instance</span>
</span></span></code></pre></div><ul><li>The singleton decorator keeps a dictionary of instances.</li><li>When a class is instantiated, the decorator checks if an instance of the class already exists. If not, it creates one; otherwise, it returns the existing instance.</li><li>The initializer is only called once, preventing multiple initializations.</li></ul><h2 id=singleton-using-a-metaclass>Singleton Using a Metaclass<a hidden class=anchor aria-hidden=true href=#singleton-using-a-metaclass>#</a></h2><p>A metaclass can also be used to create a Singleton. The metaclass ensures that only one instance of the class is created, similar to the decorator approach.</p><p>Code Example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Singleton</span><span class=p>(</span><span class=nb>type</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>_instances</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__call__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>cls</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_instances</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>cls</span><span class=o>.</span><span class=n>_instances</span><span class=p>[</span><span class=bp>cls</span><span class=p>]</span> <span class=o>=</span> <span class=nb>super</span><span class=p>(</span><span class=n>Singleton</span><span class=p>,</span> <span class=bp>cls</span><span class=p>)</span><span class=o>.</span><span class=fm>__call__</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_instances</span><span class=p>[</span><span class=bp>cls</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Database</span><span class=p>(</span><span class=n>metaclass</span><span class=o>=</span><span class=n>Singleton</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Loading database&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>d1</span> <span class=o>=</span> <span class=n>Database</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>d2</span> <span class=o>=</span> <span class=n>Database</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>d1</span> <span class=o>==</span> <span class=n>d2</span><span class=p>)</span>  <span class=c1># True, indicating that d1 and d2 are the same instance</span>
</span></span></code></pre></div><ul><li>The Singleton metaclass overrides the <strong>call</strong> method, which is responsible for object creation.</li><li>It checks if an instance of the class exists; if not, it creates one using the super() function.</li><li>This approach is similar to the decorator but leverages Python&rsquo;s metaclass capabilities.</li></ul><h2 id=monostate-borg-singleton-pattern>Monostate (Borg) Singleton Pattern<a hidden class=anchor aria-hidden=true href=#monostate-borg-singleton-pattern>#</a></h2><p>The Monostate pattern is a variation of the Singleton pattern where all instances of the class share the same state. Unlike the traditional Singleton, it allows multiple instances but with shared state.</p><p>Code Example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>CEO</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>__shared_state</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;name&#39;</span><span class=p>:</span> <span class=s1>&#39;Steve&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;age&#39;</span><span class=p>:</span> <span class=mi>55</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=vm>__dict__</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>__shared_state</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1> is </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>age</span><span class=si>}</span><span class=s1> years old&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Monostate</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>_shared_state</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>obj</span> <span class=o>=</span> <span class=nb>super</span><span class=p>(</span><span class=n>Monostate</span><span class=p>,</span> <span class=bp>cls</span><span class=p>)</span><span class=o>.</span><span class=fm>__new__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>obj</span><span class=o>.</span><span class=vm>__dict__</span> <span class=o>=</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_shared_state</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>obj</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>CFO</span><span class=p>(</span><span class=n>Monostate</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>money_managed</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=s1> manages $</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>money_managed</span><span class=si>}</span><span class=s1>bn&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>ceo1</span> <span class=o>=</span> <span class=n>CEO</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>ceo1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ceo1</span><span class=o>.</span><span class=n>age</span> <span class=o>=</span> <span class=mi>66</span>
</span></span><span class=line><span class=cl>    <span class=n>ceo2</span> <span class=o>=</span> <span class=n>CEO</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>ceo2</span><span class=o>.</span><span class=n>age</span> <span class=o>=</span> <span class=mi>77</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>ceo1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>ceo2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ceo2</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;Tim&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>ceo3</span> <span class=o>=</span> <span class=n>CEO</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>ceo1</span><span class=p>,</span> <span class=n>ceo2</span><span class=p>,</span> <span class=n>ceo3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cfo1</span> <span class=o>=</span> <span class=n>CFO</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>cfo1</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;Sheryl&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>cfo1</span><span class=o>.</span><span class=n>money_managed</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>cfo1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>cfo2</span> <span class=o>=</span> <span class=n>CFO</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>cfo2</span><span class=o>.</span><span class=n>name</span> <span class=o>=</span> <span class=s1>&#39;Ruth&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>cfo2</span><span class=o>.</span><span class=n>money_managed</span> <span class=o>=</span> <span class=mi>10</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>cfo1</span><span class=p>,</span> <span class=n>cfo2</span><span class=p>,</span> <span class=n>sep</span><span class=o>=</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span></code></pre></div><ul><li>In the Monostate pattern, the __shared_state or _shared_state dictionary is used to store the state of the class.</li><li>Each instance shares the same state by setting self.<strong>dict</strong> to reference this shared state.</li><li>Changes made through any instance will affect all other instances since they all reference the same state.</li></ul><h2 id=singleton-testing>Singleton Testing<a hidden class=anchor aria-hidden=true href=#singleton-testing>#</a></h2><p>The Singleton pattern ensures that a class has only one instance and provides a global point of access to that instance. In this example, the Singleton is implemented using a metaclass.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Singleton</span><span class=p>(</span><span class=nb>type</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>_instances</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__call__</span><span class=p>(</span><span class=bp>cls</span><span class=p>,</span> <span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>cls</span> <span class=ow>not</span> <span class=ow>in</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_instances</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=bp>cls</span><span class=o>.</span><span class=n>_instances</span><span class=p>[</span><span class=bp>cls</span><span class=p>]</span> <span class=o>=</span> <span class=nb>super</span><span class=p>(</span><span class=n>Singleton</span><span class=p>,</span> <span class=bp>cls</span><span class=p>)</span><span class=o>.</span><span class=fm>__call__</span><span class=p>(</span><span class=o>*</span><span class=n>args</span><span class=p>,</span> <span class=o>**</span><span class=n>kwargs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>cls</span><span class=o>.</span><span class=n>_instances</span><span class=p>[</span><span class=bp>cls</span><span class=p>]</span>
</span></span></code></pre></div><p>Here, the Singleton metaclass keeps a dictionary of instances, ensuring that only one instance of a class exists. If an instance already exists, it returns the existing instance instead of creating a new one.</p><p><strong>Database Class</strong>: The Database class uses the Singleton pattern to ensure that only one instance of the database is loaded into memory.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Database</span><span class=p>(</span><span class=n>metaclass</span><span class=o>=</span><span class=n>Singleton</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>population</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;capitals.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>lines</span> <span class=o>=</span> <span class=n>f</span><span class=o>.</span><span class=n>readlines</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>lines</span><span class=p>),</span> <span class=mi>2</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>population</span><span class=p>[</span><span class=n>lines</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=n>strip</span><span class=p>()]</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>lines</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>strip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>f</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div><p>The Database class reads from a file named capitals.txt to load population data for various cities.</p><p><strong>Singleton Record Finder</strong>: The SingletonRecordFinder class uses the Database singleton to calculate the total population of a list of cities.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>SingletonRecordFinder</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>total_population</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>cities</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>cities</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>+=</span> <span class=n>Database</span><span class=p>()</span><span class=o>.</span><span class=n>population</span><span class=p>[</span><span class=n>c</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span>
</span></span></code></pre></div><p>This approach tightly couples the record finder to the singleton database, which can make testing difficult.</p><p><strong>Configurable Record Finder</strong>: To improve testability, the ConfigurableRecordFinder allows dependency injection, enabling the use of different databases for testing.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>ConfigurableRecordFinder</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>db</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>db</span> <span class=o>=</span> <span class=n>db</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>total_population</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>cities</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>cities</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>result</span> <span class=o>+=</span> <span class=bp>self</span><span class=o>.</span><span class=n>db</span><span class=o>.</span><span class=n>population</span><span class=p>[</span><span class=n>c</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span>
</span></span></code></pre></div><p>This class takes a database object as an argument, making it possible to inject a dummy database during testing.</p><p><strong>Dummy Database for Testing</strong>: The DummyDatabase class is a mock database used for unit testing.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>DummyDatabase</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>population</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;alpha&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;beta&#39;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;gamma&#39;</span><span class=p>:</span> <span class=mi>3</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_population</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>name</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>population</span><span class=p>[</span><span class=n>name</span><span class=p>]</span>
</span></span></code></pre></div><p>This class provides predictable, hardcoded population data to facilitate reliable testing.</p><p><strong>Unit Tests</strong>: The following unit tests ensure the Singleton behavior and verify the functionality of both the SingletonRecordFinder and ConfigurableRecordFinder.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>unittest</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>SingletonTests</span><span class=p>(</span><span class=n>unittest</span><span class=o>.</span><span class=n>TestCase</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>test_is_singleton</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>db</span> <span class=o>=</span> <span class=n>Database</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>db2</span> <span class=o>=</span> <span class=n>Database</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>assertEqual</span><span class=p>(</span><span class=n>db</span><span class=p>,</span> <span class=n>db2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>test_singleton_total_population</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;&#34;&#34; This tests on a live database :( &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>rf</span> <span class=o>=</span> <span class=n>SingletonRecordFinder</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>names</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Seoul&#39;</span><span class=p>,</span> <span class=s1>&#39;Mexico City&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>tp</span> <span class=o>=</span> <span class=n>rf</span><span class=o>.</span><span class=n>total_population</span><span class=p>(</span><span class=n>names</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>assertEqual</span><span class=p>(</span><span class=n>tp</span><span class=p>,</span> <span class=mi>17500000</span> <span class=o>+</span> <span class=mi>17400000</span><span class=p>)</span>  <span class=c1># what if these change?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ddb</span> <span class=o>=</span> <span class=n>DummyDatabase</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>test_dependent_total_population</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>crf</span> <span class=o>=</span> <span class=n>ConfigurableRecordFinder</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>ddb</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>assertEqual</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>crf</span><span class=o>.</span><span class=n>total_population</span><span class=p>([</span><span class=s1>&#39;alpha&#39;</span><span class=p>,</span> <span class=s1>&#39;beta&#39;</span><span class=p>]),</span>
</span></span><span class=line><span class=cl>            <span class=mi>3</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>unittest</span><span class=o>.</span><span class=n>main</span><span class=p>()</span>
</span></span></code></pre></div><ul><li>test_is_singleton: Verifies that only one instance of the Database class exists.</li><li>test_singleton_total_population: Tests the total population calculation using the SingletonRecordFinder with live data.</li><li>test_dependent_total_population: Tests the total population calculation using the ConfigurableRecordFinder with a dummy database.</li></ul><p>These tests demonstrate the importance of decoupling code from singletons to allow for better testability.</p><h1 id=adapter-design-pattern>Adapter Design Pattern<a hidden class=anchor aria-hidden=true href=#adapter-design-pattern>#</a></h1><p>The Adapter Design Pattern allows objects with incompatible interfaces to work together. It acts as a bridge between two interfaces, adapting one interface to another that the client expects.</p><h2 id=problem-statement-2>Problem Statement<a hidden class=anchor aria-hidden=true href=#problem-statement-2>#</a></h2><p>When building software systems, it is common to encounter situations where an existing class or component has an interface that does not match the interface required by a specific client. Modifying the existing class to meet the new interface could lead to breaking other parts of the system or complicating the code unnecessarily. In such cases, the Adapter Pattern provides a solution by creating a wrapper (adapter) around the existing class to adapt its interface to the expected one.</p><h2 id=real-world-analogy>Real-World Analogy<a hidden class=anchor aria-hidden=true href=#real-world-analogy>#</a></h2><p>A travel adapter is a perfect analogy for the Adapter Pattern. Electrical devices have different plug types and voltage requirements based on the country they are designed for. Instead of modifying each device to fit into different outlets, a travel adapter converts the plug type to fit the outlet and allows the device to function properly.</p><p>Participants</p><ul><li>Target (Client Interface): The interface expected by the client.</li><li>Adaptee: The existing interface that needs to be adapted.</li><li>Adapter: The class that implements the Target interface and adapts the Adaptee to the Target.</li></ul><h2 id=example-implementation>Example Implementation<a hidden class=anchor aria-hidden=true href=#example-implementation>#</a></h2><p>Consider a scenario where you are given a legacy API that includes a Point class and a draw_point function for drawing points. However, you are working with a system where graphical objects are represented by lines and rectangles.</p><p>Given API</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Point</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>x</span> <span class=o>=</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>y</span> <span class=o>=</span> <span class=n>y</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>draw_point</span><span class=p>(</span><span class=n>p</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>Working Classes</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Line</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>end</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>start</span> <span class=o>=</span> <span class=n>start</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>end</span> <span class=o>=</span> <span class=n>end</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Rectangle</span><span class=p>(</span><span class=nb>list</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>width</span><span class=p>,</span> <span class=n>height</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Line</span><span class=p>(</span><span class=n>Point</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=n>Point</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>width</span><span class=p>,</span> <span class=n>y</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Line</span><span class=p>(</span><span class=n>Point</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>width</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=n>Point</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>width</span><span class=p>,</span> <span class=n>y</span> <span class=o>+</span> <span class=n>height</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Line</span><span class=p>(</span><span class=n>Point</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>),</span> <span class=n>Point</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>+</span> <span class=n>height</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Line</span><span class=p>(</span><span class=n>Point</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>+</span> <span class=n>height</span><span class=p>),</span> <span class=n>Point</span><span class=p>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>width</span><span class=p>,</span> <span class=n>y</span> <span class=o>+</span> <span class=n>height</span><span class=p>)))</span>
</span></span></code></pre></div><p><strong>Adapter Implementation</strong>
The <code>LineToPointAdapter</code> adapts the Line class to be compatible with the draw_point function by converting the line into a series of points.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>class</span> <span class=nc>LineToPointAdapter</span><span class=p>(</span><span class=nb>list</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>line</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>count</span><span class=si>}</span><span class=s1>: Generating points for line &#39;</span>
</span></span><span class=line><span class=cl>              <span class=sa>f</span><span class=s1>&#39;[</span><span class=si>{</span><span class=n>line</span><span class=o>.</span><span class=n>start</span><span class=o>.</span><span class=n>x</span><span class=si>}</span><span class=s1>,</span><span class=si>{</span><span class=n>line</span><span class=o>.</span><span class=n>start</span><span class=o>.</span><span class=n>y</span><span class=si>}</span><span class=s1>]→&#39;</span>
</span></span><span class=line><span class=cl>              <span class=sa>f</span><span class=s1>&#39;[</span><span class=si>{</span><span class=n>line</span><span class=o>.</span><span class=n>end</span><span class=o>.</span><span class=n>x</span><span class=si>}</span><span class=s1>,</span><span class=si>{</span><span class=n>line</span><span class=o>.</span><span class=n>end</span><span class=o>.</span><span class=n>y</span><span class=si>}</span><span class=s1>]&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>left</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=n>line</span><span class=o>.</span><span class=n>start</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=n>line</span><span class=o>.</span><span class=n>end</span><span class=o>.</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>right</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>line</span><span class=o>.</span><span class=n>start</span><span class=o>.</span><span class=n>x</span><span class=p>,</span> <span class=n>line</span><span class=o>.</span><span class=n>end</span><span class=o>.</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>top</span> <span class=o>=</span> <span class=nb>min</span><span class=p>(</span><span class=n>line</span><span class=o>.</span><span class=n>start</span><span class=o>.</span><span class=n>y</span><span class=p>,</span> <span class=n>line</span><span class=o>.</span><span class=n>end</span><span class=o>.</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>bottom</span> <span class=o>=</span> <span class=nb>max</span><span class=p>(</span><span class=n>line</span><span class=o>.</span><span class=n>start</span><span class=o>.</span><span class=n>y</span><span class=p>,</span> <span class=n>line</span><span class=o>.</span><span class=n>end</span><span class=o>.</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>right</span> <span class=o>-</span> <span class=n>left</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>y</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>top</span><span class=p>,</span> <span class=n>bottom</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Point</span><span class=p>(</span><span class=n>left</span><span class=p>,</span> <span class=n>y</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>line</span><span class=o>.</span><span class=n>end</span><span class=o>.</span><span class=n>y</span> <span class=o>-</span> <span class=n>line</span><span class=o>.</span><span class=n>start</span><span class=o>.</span><span class=n>y</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>left</span><span class=p>,</span> <span class=n>right</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Point</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>top</span><span class=p>))</span>
</span></span></code></pre></div><p>Usage Example
The <code>draw</code> function can now work with rectangles by using the <code>LineToPointAdapter</code> to convert lines into points.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>def</span> <span class=nf>draw</span><span class=p>(</span><span class=n>rcs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n\n</span><span class=s2>--- Drawing some stuff ---</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>rc</span> <span class=ow>in</span> <span class=n>rcs</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>rc</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>adapter</span> <span class=o>=</span> <span class=n>LineToPointAdapter</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>adapter</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>draw_point</span><span class=p>(</span><span class=n>p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>rs</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=n>Rectangle</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>Rectangle</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>6</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>draw</span><span class=p>(</span><span class=n>rs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>draw</span><span class=p>(</span><span class=n>rs</span><span class=p>)</span>
</span></span></code></pre></div><p>The Adapter Pattern is a useful design pattern when you need to integrate classes with incompatible interfaces. It allows you to reuse existing code without modifying it, thereby promoting flexibility and reusability in software design.</p><h2 id=implementing-a-cache>Implementing a Cache<a hidden class=anchor aria-hidden=true href=#implementing-a-cache>#</a></h2><p>A cache is a data structure that stores the results of expensive function calls and reuses those results when the same inputs occur again. By implementing a cache in the adapter, we can avoid regenerating temporary objects, improving the efficiency of the code.</p><p>Modifying the Adapter to Use a Cache: The LineToPointAdapter class is modified to include a cache, which is a dictionary that maps hash values of Line objects to their corresponding points. This way, if a Line has already been converted to points, the adapter can retrieve the points from the cache instead of regenerating them.</p><h3 id=steps-in-the-cache-implementation>Steps in the Cache Implementation:<a hidden class=anchor aria-hidden=true href=#steps-in-the-cache-implementation>#</a></h3><p><strong>Calculate Hash Value</strong>: The adapter first calculates a unique hash value for the Line object. This hash value is used as the key in the cache dictionary.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>h</span> <span class=o>=</span> <span class=nb>hash</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span></code></pre></div><p><strong>Check Cache</strong>: Before generating points, the adapter checks if the points for the given line are already present in the cache.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>h</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>cache</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span>
</span></span></code></pre></div><p><strong>Generate Points if Not Cached</strong>: If the points are not in the cache, the adapter generates them and stores them in the cache.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>points</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=c1># (Point generation logic)</span>
</span></span><span class=line><span class=cl><span class=bp>self</span><span class=o>.</span><span class=n>cache</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>h</span><span class=p>]</span> <span class=o>=</span> <span class=n>points</span>
</span></span></code></pre></div><p><strong>Iterate Over Cached Points</strong>: The <strong>iter</strong> method is overridden to return an iterator over the cached points.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=fm>__iter__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>iter</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>cache</span><span class=p>[</span><span class=bp>self</span><span class=o>.</span><span class=n>h</span><span class=p>])</span>
</span></span></code></pre></div><p>By incorporating caching into the adapter, we can significantly reduce the number of temporary objects generated, thereby improving the performance and efficiency of the system. This approach is especially beneficial when the adapter is repeatedly invoked with the same data.</p><h1 id=bridge-design-pattern>Bridge Design Pattern<a hidden class=anchor aria-hidden=true href=#bridge-design-pattern>#</a></h1><p>The Bridge design pattern is used to decouple an abstraction from its implementation, allowing both to vary independently. This pattern is particularly useful when dealing with a potential &ldquo;Cartesian product complexity explosion,&rdquo; which occurs when multiple abstractions and implementations multiply the number of classes needed.</p><h2 id=code-structure>Code Structure<a hidden class=anchor aria-hidden=true href=#code-structure>#</a></h2><ul><li><strong>Renderer Interface</strong>:<ul><li><strong>Renderer</strong>: An abstract base class that defines the method render_circle(radius). This method serves as the interface for rendering shapes.</li></ul></li><li>Concrete Implementations of Renderer:<ul><li><strong>VectorRenderer</strong>: A concrete implementation of Renderer. It provides a specific implementation for rendering circles in a vector form.</li><li><strong>RasterRenderer</strong>: Another concrete implementation of Renderer. It renders circles in a raster (pixel-based) form.</li></ul></li><li><strong>Shape Base Class</strong>:<ul><li><strong>Shape</strong>: An abstract base class that requires a Renderer to be passed during initialization. This class defines the methods draw() and resize(factor), which are intended to be overridden by derived classes.</li></ul></li><li><strong>Concrete Shape Implementation</strong>:<ul><li><strong>Circle</strong>: A concrete implementation of the Shape class. It includes a radius attribute and provides specific implementations for the draw() and resize(factor) methods.<ul><li><code>draw()</code>: Uses the associated Renderer to render the circle based on its radius.</li><li><code>resize(factor)</code>: Resizes the circle by multiplying its radius by the given factor.</li></ul></li></ul></li><li><strong>Main Execution</strong>: The script demonstrates the usage of the Bridge pattern by creating instances of VectorRenderer and RasterRenderer, and then using these renderers to draw and resize a Circle.</li></ul><h2 id=code-example>Code Example<a hidden class=anchor aria-hidden=true href=#code-example>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Renderer</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>render_circle</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>radius</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>VectorRenderer</span><span class=p>(</span><span class=n>Renderer</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>render_circle</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>radius</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Drawing a circle of radius </span><span class=si>{</span><span class=n>radius</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>RasterRenderer</span><span class=p>(</span><span class=n>Renderer</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>render_circle</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>radius</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Drawing pixels for circle of radius </span><span class=si>{</span><span class=n>radius</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Shape</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>renderer</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>renderer</span> <span class=o>=</span> <span class=n>renderer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>draw</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span> 
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>resize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>factor</span><span class=p>):</span> 
</span></span><span class=line><span class=cl>        <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Circle</span><span class=p>(</span><span class=n>Shape</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>renderer</span><span class=p>,</span> <span class=n>radius</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=n>renderer</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>radius</span> <span class=o>=</span> <span class=n>radius</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>draw</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>renderer</span><span class=o>.</span><span class=n>render_circle</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>radius</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>resize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>factor</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>radius</span> <span class=o>*=</span> <span class=n>factor</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>raster</span> <span class=o>=</span> <span class=n>RasterRenderer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>vector</span> <span class=o>=</span> <span class=n>VectorRenderer</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>circle</span> <span class=o>=</span> <span class=n>Circle</span><span class=p>(</span><span class=n>vector</span><span class=p>,</span> <span class=mi>5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>circle</span><span class=o>.</span><span class=n>draw</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>circle</span><span class=o>.</span><span class=n>resize</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>circle</span><span class=o>.</span><span class=n>draw</span><span class=p>()</span>
</span></span></code></pre></div><h2 id=usage-3>Usage<a hidden class=anchor aria-hidden=true href=#usage-3>#</a></h2><ul><li><strong>Renderers</strong>: The VectorRenderer and RasterRenderer provide different ways to render the Circle.</li><li><strong>Shapes</strong>: The Circle class can be extended or modified without altering the renderer classes, showcasing the flexibility provided by the Bridge pattern.</li></ul><h2 id=advantages>Advantages<a hidden class=anchor aria-hidden=true href=#advantages>#</a></h2><ul><li><strong>Decoupling</strong>: The Bridge pattern decouples abstraction (Shape) from implementation (Renderer), enabling both to evolve independently.</li><li><strong>Reduced Complexity</strong>: By separating concerns, the pattern avoids a complexity explosion that could result from combining multiple abstractions and implementations.</li></ul><h2 id=limitations>Limitations<a hidden class=anchor aria-hidden=true href=#limitations>#</a></h2><ul><li><strong>Open/Closed Principle</strong>: The pattern requires modifications to existing classes (e.g., adding new methods to Renderer and its subclasses) when new shapes or renderers are introduced, which might violate the open/closed principle.</li></ul><h1 id=composite-design-pattern>Composite Design Pattern<a hidden class=anchor aria-hidden=true href=#composite-design-pattern>#</a></h1><p>The Composite Design Pattern is a structural design pattern that allows you to treat individual objects and compositions of objects uniformly. This pattern provides a way to group objects into tree structures to represent part-whole hierarchies. Composite lets clients treat individual objects and compositions of objects uniformly, thereby simplifying the client code.</p><h2 id=motivation-2>Motivation<a hidden class=anchor aria-hidden=true href=#motivation-2>#</a></h2><p>In software development, there are scenarios where you need to work with both individual objects and collections of objects. For example, in a graphics application, you might have simple shapes like circles and squares, but you might also want to group these shapes together to form complex structures.</p><p>The Composite Design Pattern enables you to treat both individual objects (e.g., a circle or a square) and groups of objects (e.g., a group of shapes) uniformly. This pattern allows you to define a common interface for all objects in the composition, so clients can interact with both individual components and composites through the same interface.</p><h2 id=implementation>Implementation<a hidden class=anchor aria-hidden=true href=#implementation>#</a></h2><h3 id=base-class>Base Class<a hidden class=anchor aria-hidden=true href=#base-class>#</a></h3><p>The base class, GraphicObject, serves as the foundation for both individual components (e.g., Circle and Square) and composite objects (e.g., a group of shapes). It contains a list of children that represent the group of objects and a color property.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>class</span> <span class=nc>GraphicObject</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>color</span> <span class=o>=</span> <span class=n>color</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>children</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_name</span> <span class=o>=</span> <span class=s1>&#39;Group&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@property</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>name</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>_name</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_print</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>items</span><span class=p>,</span> <span class=n>depth</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=s1>&#39;*&#39;</span> <span class=o>*</span> <span class=n>depth</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>color</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>color</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>items</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>name</span><span class=si>}</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>child</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>children</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>child</span><span class=o>.</span><span class=n>_print</span><span class=p>(</span><span class=n>items</span><span class=p>,</span> <span class=n>depth</span> <span class=o>+</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>items</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>_print</span><span class=p>(</span><span class=n>items</span><span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>items</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=concrete-classes>Concrete Classes<a hidden class=anchor aria-hidden=true href=#concrete-classes>#</a></h3><p>Concrete classes like Circle and Square inherit from GraphicObject and override the name property to return their specific type. These classes can be treated as both individual objects and as part of a composite object.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>class</span> <span class=nc>Circle</span><span class=p>(</span><span class=n>GraphicObject</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nd>@property</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>name</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;Circle&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Square</span><span class=p>(</span><span class=n>GraphicObject</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nd>@property</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>name</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;Square&#39;</span>
</span></span></code></pre></div><h3 id=example-usage>Example Usage<a hidden class=anchor aria-hidden=true href=#example-usage>#</a></h3><p>Below is an example of how you can use the Composite Design Pattern to create and manipulate both individual shapes and groups of shapes.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>drawing</span> <span class=o>=</span> <span class=n>GraphicObject</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>drawing</span><span class=o>.</span><span class=n>_name</span> <span class=o>=</span> <span class=s1>&#39;My Drawing&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>drawing</span><span class=o>.</span><span class=n>children</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Square</span><span class=p>(</span><span class=s1>&#39;Red&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>drawing</span><span class=o>.</span><span class=n>children</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Circle</span><span class=p>(</span><span class=s1>&#39;Yellow&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>group</span> <span class=o>=</span> <span class=n>GraphicObject</span><span class=p>()</span>  <span class=c1># no name</span>
</span></span><span class=line><span class=cl>    <span class=n>group</span><span class=o>.</span><span class=n>children</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Circle</span><span class=p>(</span><span class=s1>&#39;Blue&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>group</span><span class=o>.</span><span class=n>children</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>Square</span><span class=p>(</span><span class=s1>&#39;Blue&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>drawing</span><span class=o>.</span><span class=n>children</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>group</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>drawing</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=output>Output<a hidden class=anchor aria-hidden=true href=#output>#</a></h3><p>The output of the above code will display a hierarchy of the shapes and groups within the drawing:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>*My Drawing
</span></span><span class=line><span class=cl>**Red
</span></span><span class=line><span class=cl>**Square
</span></span><span class=line><span class=cl>**Yellow
</span></span><span class=line><span class=cl>**Circle
</span></span><span class=line><span class=cl>**Group
</span></span><span class=line><span class=cl>***Blue
</span></span><span class=line><span class=cl>***Circle
</span></span><span class=line><span class=cl>***Blue
</span></span><span class=line><span class=cl>***Square
</span></span></code></pre></div><h2 id=neural-network-example>Neural Network Example<a hidden class=anchor aria-hidden=true href=#neural-network-example>#</a></h2><p>This documentation describes an implementation of the Composite Design Pattern in the context of modeling a neural network. The pattern is used to treat individual neurons and layers of neurons uniformly, allowing them to be connected seamlessly. This approach simplifies the handling of connections within a neural network by making scalar elements behave like collections.</p><h3 id=key-components>Key Components<a hidden class=anchor aria-hidden=true href=#key-components>#</a></h3><ol><li>Connectable Class</li></ol><ul><li>Purpose: Provides a base class that allows any derived class to connect to other instances of Connectable. Implements the Iterable interface, enabling the uniform treatment of single elements and collections.</li><li>Methods:<ul><li>connect_to(self, other): Connects the current instance (self) to another Connectable instance (other). Iterates over elements of self and other, creating two-way connections between them.</li><li><strong>iter</strong>(self): Defines iteration over instances, yielding self in the case of scalar objects.</li></ul></li></ul><ol start=2><li>Neuron Class</li></ol><ul><li>Purpose: Represents a single neuron within a neural network. Inherits from Connectable to enable connections with other neurons or layers of neurons.</li><li>Attributes:<ul><li>name: The name of the neuron.</li><li>inputs: A list of neurons connected as inputs to this neuron.</li><li>outputs: A list of neurons connected as outputs from this neuron.</li></ul></li><li>Methods:<ul><li><strong>init</strong>(self, name): Initializes a neuron with a name, and empty input/output lists.</li><li><strong>str</strong>(self): Returns a string representation of the neuron, including its name, the number of inputs, and the number of outputs.</li></ul></li></ul><ol start=3><li>NeuronLayer Class</li></ol><ul><li>Purpose: Represents a layer of neurons. Inherits from both list and Connectable, allowing it to behave like a list of neurons while also supporting connections.</li><li>Attributes:<ul><li>name: The name of the neuron layer.</li></ul></li><li>Methods:<ul><li><strong>init</strong>(self, name, count): Initializes a neuron layer with a specified number of neurons. Each neuron in the layer is named according to the layer&rsquo;s name and its index.</li><li><strong>str</strong>(self): Returns a string representation of the neuron layer, including its name and the number of neurons it contains.</li></ul></li></ul><h3 id=example-usage-1>Example Usage<a hidden class=anchor aria-hidden=true href=#example-usage-1>#</a></h3><h4 id=connecting-neurons-and-layers>Connecting Neurons and Layers<a hidden class=anchor aria-hidden=true href=#connecting-neurons-and-layers>#</a></h4><p>The following code demonstrates how to create neurons and layers, and connect them using the connect_to method:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-py data-lang=py><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>neuron1</span> <span class=o>=</span> <span class=n>Neuron</span><span class=p>(</span><span class=s1>&#39;n1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>neuron2</span> <span class=o>=</span> <span class=n>Neuron</span><span class=p>(</span><span class=s1>&#39;n2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>layer1</span> <span class=o>=</span> <span class=n>NeuronLayer</span><span class=p>(</span><span class=s1>&#39;L1&#39;</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>layer2</span> <span class=o>=</span> <span class=n>NeuronLayer</span><span class=p>(</span><span class=s1>&#39;L2&#39;</span><span class=p>,</span> <span class=mi>4</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>neuron1</span><span class=o>.</span><span class=n>connect_to</span><span class=p>(</span><span class=n>neuron2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>neuron1</span><span class=o>.</span><span class=n>connect_to</span><span class=p>(</span><span class=n>layer1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>layer1</span><span class=o>.</span><span class=n>connect_to</span><span class=p>(</span><span class=n>neuron2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>layer1</span><span class=o>.</span><span class=n>connect_to</span><span class=p>(</span><span class=n>layer2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>neuron1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>neuron2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>layer1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>layer2</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=output-1>Output<a hidden class=anchor aria-hidden=true href=#output-1>#</a></h4><p>This example produces the following output:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>n1, <span class=m>0</span> inputs, <span class=m>4</span> outputs
</span></span><span class=line><span class=cl>n2, <span class=m>4</span> inputs, <span class=m>0</span> outputs
</span></span><span class=line><span class=cl>L1 with <span class=m>3</span> neurons
</span></span><span class=line><span class=cl>L2 with <span class=m>4</span> neurons
</span></span></code></pre></div><h4 id=explanation>Explanation<a hidden class=anchor aria-hidden=true href=#explanation>#</a></h4><ul><li>Neuron 1 (n1) is connected to Neuron 2 (n2) and Layer 1 (L1). This results in n1 having 4 outputs (3 to L1 and 1 to n2), while n2 has 4 inputs (3 from L1 and 1 from n1).</li><li>Layer 1 (L1) is connected to Layer 2 (L2), creating connections between all neurons in L1 and L2.</li><li>The connect_to method in Connectable enables this flexibility, allowing neurons and layers to be interconnected regardless of their types.</li></ul><h1 id=decorator-pattern>Decorator Pattern<a hidden class=anchor aria-hidden=true href=#decorator-pattern>#</a></h1><p>The Decorator Pattern is a structural design pattern used to add additional behaviors or responsibilities to objects dynamically. Unlike subclassing, where additional functionality is achieved through inheritance, the decorator pattern allows the augmentation of an object’s behavior without modifying its structure or the need for inheritance. This promotes adherence to the Open/Closed Principle and Single Responsibility Principle in software design.</p><h2 id=motivation-3>Motivation<a hidden class=anchor aria-hidden=true href=#motivation-3>#</a></h2><p>The main motivation for using the decorator pattern is to add features or functionality to existing objects in a flexible and reusable way. Instead of altering the original object or creating numerous subclasses for every possible combination of features, decorators allow you to &ldquo;wrap&rdquo; an object with new functionality dynamically.</p><h2 id=implementation-1>Implementation<a hidden class=anchor aria-hidden=true href=#implementation-1>#</a></h2><p>General Approach</p><ul><li>Inheritance: One way to augment a class is by inheriting from it and adding new features. However, this approach can become cumbersome if multiple combinations of features are needed, leading to an explosion of subclasses.</li><li>Decorators: A more flexible approach is to use decorators, which are objects that wrap the original object and add new behaviors to it. Decorators can be stacked, allowing for dynamic and combinatorial behavior modification.</li></ul><h3 id=python-specific-implementation>Python-Specific Implementation<a hidden class=anchor aria-hidden=true href=#python-specific-implementation>#</a></h3><p>In Python, the decorator pattern can be implemented using higher-order functions, where a function wraps another function to extend its behavior. Python also provides special syntax for applying decorators to functions, using the @decorator_name syntax.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>time_it</span><span class=p>(</span><span class=n>func</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>wrapper</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=n>start</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>  <span class=c1># Measure start time</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>func</span><span class=p>()</span>  <span class=c1># Call the original function</span>
</span></span><span class=line><span class=cl>        <span class=n>end</span> <span class=o>=</span> <span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()</span>  <span class=c1># Measure end time</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>func</span><span class=o>.</span><span class=vm>__name__</span><span class=si>}</span><span class=s1> took </span><span class=si>{</span><span class=nb>int</span><span class=p>((</span><span class=n>end</span><span class=o>-</span><span class=n>start</span><span class=p>)</span><span class=o>*</span><span class=mi>1000</span><span class=p>)</span><span class=si>}</span><span class=s1>ms&#39;</span><span class=p>)</span>  <span class=c1># Print execution time</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>result</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>wrapper</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@time_it</span>  <span class=c1># Applying the time_it decorator</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>some_op</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Starting op&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>  <span class=c1># Simulate a time-consuming operation</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;We are done&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>123</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>some_op</span><span class=p>()</span>
</span></span></code></pre></div><h4 id=explanation-1>Explanation<a hidden class=anchor aria-hidden=true href=#explanation-1>#</a></h4><p><strong>Decorator Function (time_it)</strong>:</p><ul><li>Purpose: Measures the execution time of the function it decorates.</li><li>How It Works:<ul><li>It defines an inner function (wrapper) that wraps the original function.</li><li>The wrapper function records the start time, executes the original function, records the end time, and then prints the time taken to execute the function.</li><li>Finally, it returns the result of the original function.</li></ul></li></ul><p><strong>Decorated Function (some_op)</strong>:</p><ul><li>A simple function that simulates a time-consuming operation using time.sleep(1).</li><li>The @time_it decorator is applied to this function, meaning that every time some_op is called, it will be wrapped in the timing logic defined in time_it.</li></ul><p><strong>Execution</strong>:</p><ul><li>When some_op is called, the execution time is measured and printed due to the decorator, illustrating how the decorator pattern can be used to augment behavior without modifying the original function.</li></ul><h3 id=key-points>Key Points<a hidden class=anchor aria-hidden=true href=#key-points>#</a></h3><ul><li>Flexible Augmentation: Decorators allow the addition of functionality in a flexible manner without altering the original object or function.</li><li>Reusability: Decorators can be reused across different functions or objects, promoting code reusability.</li><li>Adherence to Design Principles: The decorator pattern supports the Open/Closed Principle by allowing the extension of an object&rsquo;s behavior without modifying its code.</li></ul><h2 id=classic-implementation-of-decorator-pattern-in-object-oriented-programming>Classic Implementation of Decorator Pattern in Object-Oriented Programming<a hidden class=anchor aria-hidden=true href=#classic-implementation-of-decorator-pattern-in-object-oriented-programming>#</a></h2><p>The Decorator Pattern is a structural design pattern used to dynamically add behavior to individual objects without affecting the behavior of other objects from the same class. This is achieved by creating decorator classes that wrap the original class, augmenting its functionality. This approach adheres to the Open/Closed Principle by allowing functionality to be extended without modifying existing code.</p><h3 id=motivation-4>Motivation<a hidden class=anchor aria-hidden=true href=#motivation-4>#</a></h3><p>In object-oriented programming, there often arises a need to extend the functionality of a class without modifying its code. Traditional inheritance can lead to an explosion of subclasses for every combination of features, making the system complex and hard to maintain. The decorator pattern offers a more flexible and reusable solution by allowing the dynamic composition of behaviors.</p><h3 id=implementation-2>Implementation<a hidden class=anchor aria-hidden=true href=#implementation-2>#</a></h3><p><strong>Core Components</strong>
Abstract Base Class (Shape):</p><ul><li>The abstract base class provides a common interface for all shapes, ensuring that concrete classes and decorators can be treated uniformly.
Concrete Classes (Circle, Square):</li><li>These classes represent the basic shapes. They implement the core functionality, such as resizing or defining specific properties like radius or side length.
Decorator Classes (ColoredShape, TransparentShape):</li><li>These classes are decorators that add additional functionality, such as color or transparency, to the basic shapes. They wrap a shape object and extend its behavior.</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>abc</span> <span class=kn>import</span> <span class=n>ABC</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Shape</span><span class=p>(</span><span class=n>ABC</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Circle</span><span class=p>(</span><span class=n>Shape</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>radius</span><span class=o>=</span><span class=mf>0.0</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>radius</span> <span class=o>=</span> <span class=n>radius</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>resize</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>factor</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>radius</span> <span class=o>*=</span> <span class=n>factor</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;A circle of radius </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>radius</span><span class=si>}</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Square</span><span class=p>(</span><span class=n>Shape</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>side</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>side</span> <span class=o>=</span> <span class=n>side</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;A square with side </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>side</span><span class=si>}</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>ColoredShape</span><span class=p>(</span><span class=n>Shape</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>shape</span><span class=p>,</span> <span class=n>color</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>shape</span><span class=p>,</span> <span class=n>ColoredShape</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>raise</span> <span class=ne>Exception</span><span class=p>(</span><span class=s1>&#39;Cannot apply ColoredDecorator twice&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>shape</span> <span class=o>=</span> <span class=n>shape</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>color</span> <span class=o>=</span> <span class=n>color</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s1> has the color </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>color</span><span class=si>}</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>TransparentShape</span><span class=p>(</span><span class=n>Shape</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>shape</span><span class=p>,</span> <span class=n>transparency</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>shape</span> <span class=o>=</span> <span class=n>shape</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>transparency</span> <span class=o>=</span> <span class=n>transparency</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__str__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>shape</span><span class=si>}</span><span class=s1> has </span><span class=si>{</span><span class=bp>self</span><span class=o>.</span><span class=n>transparency</span> <span class=o>*</span> <span class=mf>100.0</span><span class=si>}</span><span class=s1>% transparency&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>circle</span> <span class=o>=</span> <span class=n>Circle</span><span class=p>(</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>circle</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>red_circle</span> <span class=o>=</span> <span class=n>ColoredShape</span><span class=p>(</span><span class=n>circle</span><span class=p>,</span> <span class=s2>&#34;red&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>red_circle</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>red_half_transparent_square</span> <span class=o>=</span> <span class=n>TransparentShape</span><span class=p>(</span><span class=n>red_circle</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>red_half_transparent_square</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Example of double decoration</span>
</span></span><span class=line><span class=cl>    <span class=n>mixed</span> <span class=o>=</span> <span class=n>ColoredShape</span><span class=p>(</span><span class=n>ColoredShape</span><span class=p>(</span><span class=n>Circle</span><span class=p>(</span><span class=mi>3</span><span class=p>),</span> <span class=s1>&#39;red&#39;</span><span class=p>),</span> <span class=s1>&#39;blue&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>mixed</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=explanation-2>Explanation<a hidden class=anchor aria-hidden=true href=#explanation-2>#</a></h3><p><strong>Abstract Base Class (Shape)</strong>:</p><ul><li>Provides a base class for all shapes, enforcing a uniform interface. In this case, it only defines a <strong>str</strong> method, which is overridden by concrete shapes and decorators.
<strong>Concrete Shapes (Circle, Square)</strong>:</li></ul><p>These classes inherit from Shape and provide specific implementations for geometric shapes.</p><ul><li><p>Circle: Implements radius-related functionality and includes a resize method.</p></li><li><p>Square: Represents a square and stores the length of its side.
<strong>Decorator Classes (ColoredShape, TransparentShape)</strong>:</p></li><li><p>ColoredShape: Adds color to a shape. It checks if the shape has already been colored to prevent applying the same decorator twice.</p></li><li><p>TransparentShape: Adds transparency to a shape and converts the transparency value into a percentage for display.</p></li></ul><p><strong>Combining Decorators</strong>:</p><p>Decorators can be stacked, allowing for multiple extensions of the original shape&rsquo;s functionality. For example, a circle can be both colored and transparent.
The code demonstrates how to combine these decorators to create complex shapes with multiple features.</p><h3 id=key-points-1>Key Points<a hidden class=anchor aria-hidden=true href=#key-points-1>#</a></h3><ul><li>Dynamic Behavior Extension: The decorator pattern allows you to dynamically add functionality to objects at runtime, promoting flexibility and reusability.</li><li>Adherence to Design Principles: The pattern adheres to the Open/Closed Principle by allowing objects to be extended without modifying their code.</li><li>Preventing Redundant Decoration: The implementation includes checks to prevent the same decorator from being applied multiple times, avoiding redundant or conflicting behaviors.</li></ul><h3 id=limitations-1>Limitations<a hidden class=anchor aria-hidden=true href=#limitations-1>#</a></h3><ul><li>Access to Original Methods: Decorators do not automatically provide access to the original object&rsquo;s methods unless explicitly programmed. For example, the resize method of Circle is not accessible once the shape is decorated.</li><li>Complexity: When multiple decorators are stacked, it can become difficult to manage the interactions between them, particularly if they modify the same aspect of the object.</li></ul><h2 id=file-decorator-implementation-with-logging>File Decorator Implementation with Logging<a hidden class=anchor aria-hidden=true href=#file-decorator-implementation-with-logging>#</a></h2><p>This documentation outlines the implementation of a class decorator that wraps around a file object, allowing additional functionality such as logging while maintaining access to the file’s original methods. The approach leverages dynamic programming to proxy all operations from the decorator to the underlying file, minimizing the need to manually override each file method.</p><h3 id=class-filewithlogging>Class: FileWithLogging<a hidden class=anchor aria-hidden=true href=#class-filewithlogging>#</a></h3><p>The FileWithLogging class is a decorator for file objects, allowing additional operations (like logging) to be performed whenever certain methods (e.g., writelines) are called on the file. It also ensures that all other file operations behave as if they were directly performed on the original file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>FileWithLogging</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>file</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>file</span> <span class=o>=</span> <span class=n>file</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>writelines</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>strings</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=bp>self</span><span class=o>.</span><span class=n>file</span><span class=o>.</span><span class=n>writelines</span><span class=p>(</span><span class=n>strings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;wrote </span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>strings</span><span class=p>)</span><span class=si>}</span><span class=s1> lines&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=fm>__iter__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>file</span><span class=o>.</span><span class=fm>__iter__</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=fm>__next__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=bp>self</span><span class=o>.</span><span class=n>file</span><span class=o>.</span><span class=fm>__next__</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=fm>__getattr__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>item</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nb>getattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>],</span> <span class=n>item</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=fm>__setattr__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>key</span><span class=p>,</span> <span class=n>value</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>key</span> <span class=o>==</span> <span class=s1>&#39;file&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=bp>self</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=n>key</span><span class=p>]</span> <span class=o>=</span> <span class=n>value</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=nb>setattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>],</span> <span class=n>key</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=fm>__delattr__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>item</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>delattr</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=vm>__dict__</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>],</span> <span class=n>item</span><span class=p>)</span>
</span></span></code></pre></div><p><strong>Constructor: <strong>init</strong>(self, file)</strong>: Initialize the decorator with the file to be wrapped.
<strong>Method: writelines(self, strings)</strong>: Write multiple lines to the file and log how many lines were written.
<strong>Method: <strong>iter</strong>(self)</strong>: Allow the decorated file to be used in a loop, forwarding iteration to the original file.
<strong>Method: <strong>next</strong>(self)</strong>: Support fetching the next line in a loop, just like the original
<strong>Method: <strong>getattr</strong>(self, item)</strong>: Forward all method and attribute calls to the original file, ensuring the decorator acts just like the file.
<strong>Method: <strong>setattr</strong>(self, key, value)</strong>: Set attributes either on the decorator or the original file, depending on the key.
<strong>Method: <strong>delattr</strong>(self, item)</strong>: Delete attributes from the original file.</p><h3 id=example-usage-2>Example Usage:<a hidden class=anchor aria-hidden=true href=#example-usage-2>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>file</span> <span class=o>=</span> <span class=n>FileWithLogging</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=s1>&#39;hello.txt&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>file</span><span class=o>.</span><span class=n>writelines</span><span class=p>([</span><span class=s1>&#39;hello&#39;</span><span class=p>,</span> <span class=s1>&#39;world&#39;</span><span class=p>])</span>  <span class=c1># Logs: wrote 2 lines</span>
</span></span><span class=line><span class=cl><span class=n>file</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s1>&#39;testing&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>file</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div><p>The FileWithLogging class decorates a file to add logging and ensure it retains all original file behaviors. It demonstrates how to wrap an object and dynamically forward calls, making it an effective example of enhancing functionality without modifying the original class.</p><h1 id=facade-design-pattern>Facade Design Pattern<a hidden class=anchor aria-hidden=true href=#facade-design-pattern>#</a></h1><p>The Facade Design Pattern provides a simplified interface to a complex subsystem. It offers an easy-to-use API while hiding the complexities of underlying systems. In software systems, this allows clients to perform operations with minimal code, while still enabling power users to access lower-level functionality when needed.</p><p>In this example, a Console class is implemented as a facade to manage Buffer and Viewport components, which handle the complexity of text manipulation in a console-based system.</p><p>Components:
Buffer Class:</p><p>Purpose: Represents a low-level construct that holds characters in a 1D list (simulating a text buffer).
Attributes:
width: Width of the buffer (default: 30).
height: Height of the buffer (default: 20).
buffer: A list of characters initialized to blank spaces (&rsquo; &lsquo;), with a total size of width * height.
Methods:
<strong>getitem</strong>(item): Allows access to elements in the buffer using indexing.
write(text): Appends text to the buffer.
Code:</p><p>python
Copy code
class Buffer:
def <strong>init</strong>(self, width=30, height=20):
self.width = width
self.height = height
self.buffer = [&rsquo; &lsquo;] * (width * height)</p><pre><code>def __getitem__(self, item):
    return self.buffer.__getitem__(item)

def write(self, text):
    self.buffer += text
</code></pre><p>Viewport Class:</p><p>Purpose: Acts as a view into a section of the buffer, allowing partial content to be displayed or manipulated.
Attributes:
buffer: Holds a reference to a Buffer object.
offset: Represents the starting point of the viewport within the buffer (default: 0).
Methods:
get_char_at(index): Retrieves a character from the buffer at a specified index, adjusted by the viewport&rsquo;s offset.
append(text): Appends text to the buffer.
Code:</p><p>python
Copy code
class Viewport:
def <strong>init</strong>(self, buffer=Buffer()):
self.buffer = buffer
self.offset = 0</p><pre><code>def get_char_at(self, index):
    return self.buffer[self.offset + index]

def append(self, text):
    self.buffer += text
</code></pre><p>Console Class (Facade):</p><p>Purpose: Provides a high-level interface for interacting with the system by internally managing a buffer and viewport. It also exposes some lower-level functionality for advanced users.
Attributes:
buffers: A list to manage multiple Buffer objects.
viewports: A list to manage multiple Viewport objects.
current_viewport: The active Viewport being used by the console.
Methods:
write(text): High-level method that writes text to the current buffer via the viewport.
get_char_at(index): Low-level method that allows the user to directly access characters in the buffer.
Code:</p><p>python
Copy code
class Console:
def <strong>init</strong>(self):
b = Buffer()
self.current_viewport = Viewport(b)
self.buffers = [b]
self.viewports = [self.current_viewport]</p><pre><code># High-level method
def write(self, text):
    self.current_viewport.buffer.write(text)

# Low-level method
def get_char_at(self, index):
    return self.current_viewport.get_char_at(index)
</code></pre><p>Usage Example:</p><p>The console can be used for both high-level operations (e.g., writing to the buffer) and low-level operations (e.g., retrieving characters from the buffer).
Code:</p><p>python
Copy code
if <strong>name</strong> == &lsquo;<strong>main</strong>&rsquo;:
c = Console()
c.write(&lsquo;hello&rsquo;) # High-level write
ch = c.get_char_at(0) # Low-level character access
print(ch) # Output: &lsquo;h&rsquo;
Key Concepts:
High-Level API: Provides a simple interface for common tasks, such as writing to the console, without requiring knowledge of the underlying structure (write method in Console).
Low-Level API: Exposes detailed functionality for advanced users, allowing direct manipulation of buffer and viewport objects (get_char_at method in Console).
Buffer and Viewport: Handle the complexity of managing text and presenting it in specific areas of the console.
Multifunctional Facade: The Console class serves as both a simplified and powerful interface, providing flexibility for different user requirements.</p><h1 id=flyweight-pattern>Flyweight Pattern<a hidden class=anchor aria-hidden=true href=#flyweight-pattern>#</a></h1><p>This documentation explains the implementation of the Flyweight Design Pattern, a space optimization technique used to minimize memory consumption in scenarios where multiple objects share similar data. By externalizing and reusing common data, the Flyweight Pattern ensures that only a small number of objects are instantiated, reducing redundancy and optimizing resource usage.</p><p>Problem Statement
The goal is to prevent redundant memory usage when storing common or repetitive data across multiple objects. For example, in a massively multiplayer online game or a text editor, many users may have similar names, and it would be inefficient to store identical or similar strings repeatedly.</p><p>To address this, the Flyweight Pattern externalizes the common data and stores references to it, rather than storing the data directly in each object.</p><p>Example Scenario
Consider a system where 10,000 users are created, and each user has a first and last name. Without optimization, the system would store each full name as a unique string, resulting in significant memory overhead. Even though there are only 200 unique first and last names (100 first names and 100 last names), the traditional approach leads to the storage of 10,000 full names.</p><p>The Flyweight Pattern reduces memory usage by storing only 200 unique strings and referencing them via indices, rather than duplicating the full names for each user.</p><p>Implementation
The following implementation demonstrates the Flyweight Design Pattern using Python:</p><p>User Class (Inefficient Implementation):
This class stores the full name of each user as a single string.
Memory consumption increases with each new user, even if the first and last names are identical.
python
Copy code
class User:
def <strong>init</strong>(self, name):
self.name = name
User2 Class (Flyweight Implementation):
This class optimizes memory usage by storing first and last names externally in a static list (strings) and referencing them via indices.
When a user object is created, the first and last names are split, and their indices are stored instead of the actual strings.
The get_or_add function checks if the name is already stored. If it is, it returns the index; otherwise, it adds the name to the list and returns the new index.
The <strong>str</strong> method reconstructs the full name by concatenating the indexed first and last names from the static list.
python
Copy code
class User2:
strings = []</p><pre><code>def __init__(self, full_name):
    def get_or_add(s):
        if s in self.strings:
            return self.strings.index(s)
        else:
            self.strings.append(s)
            return len(self.strings)-1
    self.names = [get_or_add(x) for x in full_name.split(' ')]

def __str__(self):
    return ' '.join([self.strings[x] for x in self.names])
</code></pre><p>Random Name Generation:
A function random_string is used to generate random first and last names of length 8, simulating user names for the purpose of the experiment.
python
Copy code
def random_string():
chars = string.ascii_lowercase
return &lsquo;&rsquo;.join([random.choice(chars) for x in range(8)])
Main Program:
The program creates 10,000 users using the inefficient User class and then optimizes memory usage by switching to the User2 class, which utilizes the Flyweight Pattern.
python
Copy code
if <strong>name</strong> == &lsquo;<strong>main</strong>&rsquo;:
users = []</p><pre><code>first_names = [random_string() for x in range(100)]
last_names = [random_string() for x in range(100)]

for first in first_names:
    for last in last_names:
        users.append(User(f'{first} {last}'))

u2 = User2('Jim Jones')
u3 = User2('Frank Jones')
print(u2.names)
print(u3.names)
print(User2.strings)

users2 = []

for first in first_names:
    for last in last_names:
        users2.append(User2(f'{first} {last}'))
</code></pre><p>Benefits of Flyweight Pattern
Memory Optimization: Instead of creating new strings for each user, the Flyweight Pattern reuses existing strings by referencing them via indices. This reduces memory consumption significantly.
Efficient Storage: Only 200 unique strings are stored, regardless of the number of users. The full names are reconstructed dynamically when needed, saving memory and reducing overhead.
Example Output
The code first prints the indices corresponding to the first and last names for two users: &lsquo;Jim Jones&rsquo; and &lsquo;Frank Jones&rsquo;.
It also prints the shared static list of unique strings (User2.strings), which stores the first and last names.
This approach demonstrates how the Flyweight Pattern effectively reduces redundant memory usage in scenarios with repetitive data.</p><p>Text Formatting Example
Overview
This document demonstrates the implementation of the Flyweight Design Pattern for text formatting, showcasing memory optimization in cases where only specific portions of text require formatting. The solution compares a naive approach to text formatting with a more efficient implementation using the Flyweight pattern.</p><p>Problem Statement
When formatting large amounts of text, such as capitalizing certain letters or words, allocating resources for each character in the text can become inefficient, especially when only a small subset of the text needs formatting.</p><p>For example, in a naive implementation, formatting operations (e.g., capitalizing letters) are applied using an array of boolean values to track whether each character in the text should be capitalized. This approach consumes unnecessary memory when formatting operations are sparse across large texts.</p><p>The Flyweight pattern offers an optimized solution by sharing the formatting information across text segments, reducing memory usage.</p><p>Naive Approach
FormattedText Class
Purpose: A simple approach to formatting text, where a boolean array tracks which characters need to be capitalized.
Initialization: Takes a string of plain text as input and creates an array of booleans (caps), initialized to False.
Capitalization: Uses the capitalize() method to update the boolean array for characters within the specified range.
String Representation: The <strong>str</strong>() method checks the boolean array when generating the final formatted string.
Code:</p><p>python
Copy code
class FormattedText:
def <strong>init</strong>(self, plain_text):
self.plain_text = plain_text
self.caps = [False] * len(plain_text)</p><pre><code>def capitalize(self, start, end):
    for i in range(start, end):
        self.caps[i] = True

def __str__(self):
    result = []
    for i in range(len(self.plain_text)):
        c = self.plain_text[i]
        result.append(c.upper() if self.caps[i] else c)
    return ''.join(result)
</code></pre><p>Example Usage:
python
Copy code
ft = FormattedText(&lsquo;This is a brave new world&rsquo;)
ft.capitalize(10, 15)
print(ft)
Output:</p><p>csharp
Copy code
This is a BRAVE new world
Optimized Approach with Flyweight Pattern
BetterFormattedText Class
Purpose: Optimizes memory usage by applying formatting only to the specified ranges of text, using the Flyweight pattern.
TextRange (Flyweight Class): Defines a range of text positions and tracks whether characters in the range should be capitalized, bold, italicized, etc.
Flyweight Management: The get_range() method creates and returns TextRange objects that define formatting operations on specific segments of the text, which are then stored in a formatting list.
String Representation: The <strong>str</strong>() method processes each character and checks if it falls within a TextRange that requires formatting.
Code:</p><p>python
Copy code
class BetterFormattedText:
def <strong>init</strong>(self, plain_text):
self.plain_text = plain_text
self.formatting = []</p><pre><code>class TextRange:
    def __init__(self, start, end, capitalize=False, bold=False, italic=False):
        self.start = start
        self.end = end
        self.capitalize = capitalize

    def covers(self, position):
        return self.start &lt;= position &lt;= self.end

def get_range(self, start, end):
    range = self.TextRange(start, end)
    self.formatting.append(range)
    return range

def __str__(self):
    result = []
    for i in range(len(self.plain_text)):
        c = self.plain_text[i]
        for r in self.formatting:
            if r.covers(i) and r.capitalize:
                c = c.upper()
        result.append(c)
    return ''.join(result)
</code></pre><p>Example Usage:
python
Copy code
bft = BetterFormattedText(&lsquo;This is a brave new world&rsquo;)
bft.get_range(16, 19).capitalize = True
print(bft)
Output:</p><p>vbnet
Copy code
This is a brave NEW world
Key Differences
Memory Usage: The naive approach (FormattedText) allocates a boolean array with the same length as the text, which can be inefficient for large texts with sparse formatting. The optimized approach (BetterFormattedText) only stores formatting data for specific ranges, reducing memory consumption.
Flyweight Design: By utilizing TextRange objects, the Flyweight pattern ensures that formatting information is shared across text segments and not unnecessarily duplicated.</p><h1 id=proxy-design-pattern>Proxy Design Pattern<a hidden class=anchor aria-hidden=true href=#proxy-design-pattern>#</a></h1><p>Overview
The Proxy Design Pattern is a structural design pattern that provides an interface to another object while controlling access to it. Proxies can serve various purposes, such as controlling access, managing resource allocation, or adding additional functionality to an object without altering its interface.</p><p>Types of Proxies
Communication Proxy: Facilitates communication between objects that may be in different processes or environments, abstracting the complexities involved in remote method invocations.</p><p>Logging Proxy: Adds logging capabilities to track method calls and interactions with the underlying object.</p><p>Virtual Proxy: Delays the initialization of an object until it&rsquo;s actually needed, thereby saving resources and improving performance.</p><p>Protection Proxy: Controls access to the object based on certain criteria or conditions, often used for security and access control.</p><p>Examples</p><ol><li>Protection Proxy
Scenario: A Car class with a method drive should only allow drivers above a certain age to drive.</li></ol><p>Implementation:</p><p>Car: Represents the real object with a method drive.
CarProxy: Acts as a proxy to the Car class, adding access control to the drive method based on the driver&rsquo;s age.
Code:</p><p>python
Copy code
class Car:
def <strong>init</strong>(self, driver):
self.driver = driver</p><pre><code>def drive(self):
    print(f'Car being driven by {self.driver.name}')
</code></pre><p>class CarProxy:
def <strong>init</strong>(self, driver):
self.driver = driver
self.car = Car(driver)</p><pre><code>def drive(self):
    if self.driver.age &gt;= 16:
        self.car.drive()
    else:
        print('Driver too young')
</code></pre><p>class Driver:
def <strong>init</strong>(self, name, age):
self.name = name
self.age = age</p><p>if <strong>name</strong> == &lsquo;<strong>main</strong>&rsquo;:
car = CarProxy(Driver(&lsquo;John&rsquo;, 12))
car.drive()
Explanation: The CarProxy class restricts access to the Car&rsquo;s drive method based on the driver&rsquo;s age, ensuring that only eligible drivers can operate the car.</p><ol start=2><li>Virtual Proxy
Scenario: A Bitmap class that loads an image from a file but should delay this loading until the image is actually needed.</li></ol><p>Implementation:</p><p>Bitmap: Represents the real object that performs expensive operations like loading an image from disk.
LazyBitmap: A proxy that defers the creation of a Bitmap object until its draw method is called.
Code:</p><p>python
Copy code
class Bitmap:
def <strong>init</strong>(self, filename):
self.filename = filename
print(f&rsquo;Loading image from {filename}&rsquo;)</p><pre><code>def draw(self):
    print(f'Drawing image {self.filename}')
</code></pre><p>class LazyBitmap:
def <strong>init</strong>(self, filename):
self.filename = filename
self.bitmap = None</p><pre><code>def draw(self):
    if not self.bitmap:
        self.bitmap = Bitmap(self.filename)
    self.bitmap.draw()
</code></pre><p>def draw_image(image):
print(&lsquo;About to draw image&rsquo;)
image.draw()
print(&lsquo;Done drawing image&rsquo;)</p><p>if <strong>name</strong> == &lsquo;<strong>main</strong>&rsquo;:
bmp = LazyBitmap(&lsquo;facepalm.jpg&rsquo;)
draw_image(bmp)
Explanation: The LazyBitmap class only initializes the Bitmap object when it is needed (i.e., when draw is called), avoiding the overhead of loading the image until it is actually used.</p><h2 id=proxy-vs-decorator-design-patterns>Proxy vs Decorator Design Patterns<a hidden class=anchor aria-hidden=true href=#proxy-vs-decorator-design-patterns>#</a></h2><p>Both the Proxy and Decorator Design Patterns are structural patterns that can appear similar but serve different purposes and exhibit distinct behaviors.</p><h3 id=summary-of-differences>Summary of Differences<a hidden class=anchor aria-hidden=true href=#summary-of-differences>#</a></h3><ul><li><strong>Interface Handling</strong>: A proxy provides the same interface as the object it proxies, while a decorator may provide an enhanced or extended interface.</li><li><strong>Object Handling</strong>: A proxy can manage objects that are not yet constructed, implementing lazy initialization. A decorator, on the other hand, works with an already constructed object and adds new behavior.</li><li><strong>Functionality</strong>: The proxy&rsquo;s primary role is to control access or manage resource usage, whereas the decorator focuses on adding new functionalities or operations.</li></ul><p>In essence, while both patterns involve wrapping or acting as intermediaries for objects, the Proxy Pattern is more about controlling access or managing resource use, and the Decorator Pattern is about dynamically extending an object&rsquo;s capabilities.</p><h1 id=citations>Citations<a hidden class=anchor aria-hidden=true href=#citations>#</a></h1><p>The following notes is curated from</p><ul><li>ChatGPT</li><li>Udemy: Design Patterns in Python - Dmitri Nesteruk</li><li>Udemy: Design Patterns in Java - Dmitri Nesteruk</li><li>Udemy: SOLID Principles: Introducing Software Architecture & Design by George S</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://raghu-vijaykumar.github.io/blog/tags/system-design/>System-Design</a></li><li><a href=https://raghu-vijaykumar.github.io/blog/tags/software-architecture/>Software-Architecture</a></li><li><a href=https://raghu-vijaykumar.github.io/blog/tags/patterns/>Patterns</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://raghu-vijaykumar.github.io/blog/>Raghu Vijaykumar</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>